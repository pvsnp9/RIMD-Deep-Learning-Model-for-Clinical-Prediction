 Model is  GRUD
{'epochs': 100, 'batch_size': 80, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 5, 'lr': 0.0003379349981039815, 'rnn_cell': 'GRU', 'input_key_size': 32, 'input_value_size': 128, 'input_query_size': 32, 'num_input_heads': 1, 'input_dropout': 0.344277519508953, 'comm_key_size': 64, 'comm_value_size': 104, 'comm_query_size': 64, 'num_comm_heads': 1, 'comm_dropout': 0.12997649286000268, 'active_rims': 3, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': True, 'cb_beta': 0.1}
 Model is  GRUD
{'epochs': 100, 'batch_size': 32, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 6, 'lr': 7.220914393543167e-05, 'rnn_cell': 'GRU', 'input_key_size': 128, 'input_value_size': 128, 'input_query_size': 128, 'num_input_heads': 1, 'input_dropout': 0.37689152134383275, 'comm_key_size': 32, 'comm_value_size': 104, 'comm_query_size': 32, 'num_comm_heads': 1, 'comm_dropout': 0.1350992313260192, 'active_rims': 4, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 39.08493256568909 -----
 time for train set report : 0.0 
eval time for val set : 2.5087623596191406 
epoch loss: 159.609, taining accuracy: 89.16, validation accuracy: 89.64, Val-F1-score: 26.97, Test-F1 : 29.32, 
Val_Geo_Mean : 41.04 , test_geo: 42.80
New Best F1 Score at epoch 0 : 26.97

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 26.97 from EPOCH: 1,   Test-F1 : 29.32
----- time spent for training  : 42.699862241744995 -----
 time for train set report : 0.0 
eval time for val set : 2.442997932434082 
epoch loss: 117.542, taining accuracy: 90.42, validation accuracy: 90.06, Val-F1-score: 37.35, Test-F1 : 38.17, 
Val_Geo_Mean : 50.91 , test_geo: 51.08
New Best F1 Score at epoch 1 : 37.35

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 37.35 from EPOCH: 2,   Test-F1 : 38.17
----- time spent for training  : 43.55415439605713 -----
 time for train set report : 0.0 
eval time for val set : 2.4619619846343994 
epoch loss: 111.593, taining accuracy: 90.86, validation accuracy: 90.06, Val-F1-score: 39.30, Test-F1 : 39.46, 
Val_Geo_Mean : 52.98 , test_geo: 52.57
New Best F1 Score at epoch 2 : 39.30

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 39.30 from EPOCH: 3,   Test-F1 : 39.46
----- time spent for training  : 43.03060293197632 -----
 time for train set report : 0.0 
eval time for val set : 2.4294328689575195 
epoch loss: 108.462, taining accuracy: 91.06, validation accuracy: 90.28, Val-F1-score: 41.01, Test-F1 : 42.37, 
Val_Geo_Mean : 54.29 , test_geo: 54.86
New Best F1 Score at epoch 3 : 41.01

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 41.01 from EPOCH: 4,   Test-F1 : 42.37
----- time spent for training  : 43.467764139175415 -----
 time for train set report : 0.0 
eval time for val set : 2.463235378265381 
epoch loss: 106.509, taining accuracy: 91.13, validation accuracy: 90.38, Val-F1-score: 42.37, Test-F1 : 42.13, 
Val_Geo_Mean : 55.54 , test_geo: 54.83
New Best F1 Score at epoch 4 : 42.37

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 42.37 from EPOCH: 5,   Test-F1 : 42.13
----- time spent for training  : 43.48305368423462 -----
 time for train set report : 0.0 
eval time for val set : 2.460594415664673 
epoch loss: 104.542, taining accuracy: 91.21, validation accuracy: 90.47, Val-F1-score: 42.83, Test-F1 : 43.90, 
Val_Geo_Mean : 55.81 , test_geo: 56.30
New Best F1 Score at epoch 5 : 42.83

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 42.83 from EPOCH: 6,   Test-F1 : 43.90
----- time spent for training  : 42.44617176055908 -----
 time for train set report : 0.0 
eval time for val set : 2.4425389766693115 
epoch loss: 103.227, taining accuracy: 91.42, validation accuracy: 90.69, Val-F1-score: 43.41, Test-F1 : 41.98, 
Val_Geo_Mean : 55.88 , test_geo: 54.61
New Best F1 Score at epoch 6 : 43.41

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 43.41 from EPOCH: 7,   Test-F1 : 41.98
----- time spent for training  : 43.042792558670044 -----
 time for train set report : 0.0 
eval time for val set : 2.452214241027832 
epoch loss: 101.911, taining accuracy: 91.51, validation accuracy: 90.89, Val-F1-score: 43.03, Test-F1 : 41.18, 
Val_Geo_Mean : 54.97 , test_geo: 53.44

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 43.41 from EPOCH: 7,   Test-F1 : 41.98
----- time spent for training  : 42.958003997802734 -----
 time for train set report : 0.0 
eval time for val set : 2.471745491027832 
epoch loss: 100.640, taining accuracy: 91.58, validation accuracy: 90.76, Val-F1-score: 43.14, Test-F1 : 41.73, 
Val_Geo_Mean : 55.42 , test_geo: 53.72

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 43.41 from EPOCH: 7,   Test-F1 : 41.98
----- time spent for training  : 42.39832067489624 -----
 time for train set report : 0.0 
eval time for val set : 2.443451404571533 
epoch loss: 99.559, taining accuracy: 91.58, validation accuracy: 90.98, Val-F1-score: 47.30, Test-F1 : 45.44, 
Val_Geo_Mean : 59.44 , test_geo: 57.50
New Best F1 Score at epoch 9 : 47.30

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 47.30 from EPOCH: 10,   Test-F1 : 45.44
----- time spent for training  : 42.29002022743225 -----
 time for train set report : 0.0 
eval time for val set : 2.4651999473571777 
epoch loss: 98.395, taining accuracy: 91.67, validation accuracy: 90.95, Val-F1-score: 45.80, Test-F1 : 44.74, 
Val_Geo_Mean : 57.84 , test_geo: 56.81

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 47.30 from EPOCH: 10,   Test-F1 : 45.44
----- time spent for training  : 42.16715097427368 -----
 time for train set report : 0.0 
eval time for val set : 2.432420492172241 
epoch loss: 97.172, taining accuracy: 91.84, validation accuracy: 90.82, Val-F1-score: 45.04, Test-F1 : 43.76, 
Val_Geo_Mean : 57.33 , test_geo: 55.66

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 47.30 from EPOCH: 10,   Test-F1 : 45.44
----- time spent for training  : 42.91982817649841 -----
 time for train set report : 0.0 
eval time for val set : 2.4592673778533936 
epoch loss: 96.489, taining accuracy: 91.81, validation accuracy: 91.08, Val-F1-score: 47.57, Test-F1 : 46.24, 
Val_Geo_Mean : 59.47 , test_geo: 57.80
New Best F1 Score at epoch 12 : 47.57

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 47.57 from EPOCH: 13,   Test-F1 : 46.24
----- time spent for training  : 42.77097034454346 -----
 time for train set report : 0.0 
eval time for val set : 2.451076030731201 
epoch loss: 95.385, taining accuracy: 91.91, validation accuracy: 91.17, Val-F1-score: 50.97, Test-F1 : 47.77, 
Val_Geo_Mean : 63.16 , test_geo: 60.12
New Best F1 Score at epoch 13 : 50.97

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 50.97 from EPOCH: 14,   Test-F1 : 47.77
----- time spent for training  : 42.74909496307373 -----
 time for train set report : 0.0 
eval time for val set : 2.451953649520874 
epoch loss: 94.315, taining accuracy: 92.04, validation accuracy: 91.27, Val-F1-score: 49.26, Test-F1 : 46.55, 
Val_Geo_Mean : 60.86 , test_geo: 58.82

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 50.97 from EPOCH: 14,   Test-F1 : 47.77
----- time spent for training  : 43.19563913345337 -----
 time for train set report : 0.0 
eval time for val set : 2.4346048831939697 
epoch loss: 93.388, taining accuracy: 92.11, validation accuracy: 91.30, Val-F1-score: 51.51, Test-F1 : 48.31, 
Val_Geo_Mean : 63.42 , test_geo: 60.57
New Best F1 Score at epoch 15 : 51.51

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 51.51 from EPOCH: 16,   Test-F1 : 48.31
----- time spent for training  : 42.620065212249756 -----
 time for train set report : 0.0 
eval time for val set : 2.4683878421783447 
epoch loss: 92.541, taining accuracy: 92.20, validation accuracy: 91.05, Val-F1-score: 48.25, Test-F1 : 45.59, 
Val_Geo_Mean : 60.34 , test_geo: 57.91

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 51.51 from EPOCH: 16,   Test-F1 : 48.31
----- time spent for training  : 43.417115211486816 -----
 time for train set report : 0.0 
eval time for val set : 2.4306745529174805 
epoch loss: 91.284, taining accuracy: 92.24, validation accuracy: 91.36, Val-F1-score: 53.03, Test-F1 : 49.48, 
Val_Geo_Mean : 65.07 , test_geo: 61.84
New Best F1 Score at epoch 17 : 53.03

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 53.03 from EPOCH: 18,   Test-F1 : 49.48
----- time spent for training  : 43.461082458496094 -----
 time for train set report : 0.0 
eval time for val set : 2.443566083908081 
epoch loss: 90.089, taining accuracy: 92.42, validation accuracy: 91.08, Val-F1-score: 47.17, Test-F1 : 45.08, 
Val_Geo_Mean : 59.02 , test_geo: 56.85

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 53.03 from EPOCH: 18,   Test-F1 : 49.48
----- time spent for training  : 43.08161950111389 -----
 time for train set report : 0.0 
eval time for val set : 2.444943904876709 
epoch loss: 89.433, taining accuracy: 92.42, validation accuracy: 91.20, Val-F1-score: 50.00, Test-F1 : 48.93, 
Val_Geo_Mean : 61.91 , test_geo: 60.84

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 53.03 from EPOCH: 18,   Test-F1 : 49.48
----- time spent for training  : 46.286495208740234 -----
 time for train set report : 0.0 
eval time for val set : 2.4130735397338867 
epoch loss: 88.379, taining accuracy: 92.55, validation accuracy: 91.01, Val-F1-score: 48.35, Test-F1 : 47.08, 
Val_Geo_Mean : 60.55 , test_geo: 59.08

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 53.03 from EPOCH: 18,   Test-F1 : 49.48
----- time spent for training  : 47.849308013916016 -----
 time for train set report : 0.0 
eval time for val set : 2.440415143966675 
epoch loss: 87.102, taining accuracy: 92.65, validation accuracy: 91.36, Val-F1-score: 51.35, Test-F1 : 49.30, 
Val_Geo_Mean : 63.02 , test_geo: 61.63

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 53.03 from EPOCH: 18,   Test-F1 : 49.48
----- time spent for training  : 48.178274154663086 -----
 time for train set report : 0.0 
eval time for val set : 2.4203710556030273 
epoch loss: 86.048, taining accuracy: 92.77, validation accuracy: 91.33, Val-F1-score: 52.28, Test-F1 : 48.78, 
Val_Geo_Mean : 64.25 , test_geo: 61.38

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 53.03 from EPOCH: 18,   Test-F1 : 49.48
----- time spent for training  : 46.92752385139465 -----
 time for train set report : 0.0 
eval time for val set : 2.418346405029297 
epoch loss: 85.436, taining accuracy: 92.98, validation accuracy: 91.17, Val-F1-score: 50.62, Test-F1 : 48.48, 
Val_Geo_Mean : 62.75 , test_geo: 60.59

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 53.03 from EPOCH: 18,   Test-F1 : 49.48
----- time spent for training  : 46.30690550804138 -----
 time for train set report : 0.0 
eval time for val set : 2.424699068069458 
epoch loss: 83.595, taining accuracy: 92.93, validation accuracy: 91.11, Val-F1-score: 53.11, Test-F1 : 51.07, 
Val_Geo_Mean : 65.97 , test_geo: 64.37
New Best F1 Score at epoch 24 : 53.11

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 53.11 from EPOCH: 25,   Test-F1 : 51.07
----- time spent for training  : 46.548972606658936 -----
 time for train set report : 0.0 
eval time for val set : 2.422420024871826 
epoch loss: 82.420, taining accuracy: 93.20, validation accuracy: 90.95, Val-F1-score: 52.98, Test-F1 : 52.94, 
Val_Geo_Mean : 66.30 , test_geo: 65.83

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 53.11 from EPOCH: 25,   Test-F1 : 51.07
----- time spent for training  : 46.72442650794983 -----
 time for train set report : 0.0 
eval time for val set : 2.433917284011841 
epoch loss: 81.444, taining accuracy: 93.14, validation accuracy: 90.95, Val-F1-score: 50.87, Test-F1 : 50.00, 
Val_Geo_Mean : 63.70 , test_geo: 61.90

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 53.11 from EPOCH: 25,   Test-F1 : 51.07
----- time spent for training  : 46.49569010734558 -----
 time for train set report : 0.0 
eval time for val set : 2.424170732498169 
epoch loss: 80.323, taining accuracy: 93.30, validation accuracy: 91.08, Val-F1-score: 50.70, Test-F1 : 50.61, 
Val_Geo_Mean : 63.13 , test_geo: 62.71

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 53.11 from EPOCH: 25,   Test-F1 : 51.07
----- time spent for training  : 46.95779347419739 -----
 time for train set report : 0.0 
eval time for val set : 2.424001455307007 
epoch loss: 78.304, taining accuracy: 93.49, validation accuracy: 90.95, Val-F1-score: 50.69, Test-F1 : 50.00, 
Val_Geo_Mean : 63.49 , test_geo: 62.09

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 53.11 from EPOCH: 25,   Test-F1 : 51.07
----- time spent for training  : 47.14995718002319 -----
 time for train set report : 0.0 
eval time for val set : 2.41872239112854 
epoch loss: 77.343, taining accuracy: 93.57, validation accuracy: 90.63, Val-F1-score: 50.00, Test-F1 : 52.65, 
Val_Geo_Mean : 63.58 , test_geo: 65.28

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 53.11 from EPOCH: 25,   Test-F1 : 51.07
----- time spent for training  : 47.440593242645264 -----
 time for train set report : 0.0 
eval time for val set : 2.4176464080810547 
epoch loss: 76.152, taining accuracy: 93.64, validation accuracy: 90.41, Val-F1-score: 48.90, Test-F1 : 51.10, 
Val_Geo_Mean : 62.88 , test_geo: 63.67

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 53.11 from EPOCH: 25,   Test-F1 : 51.07
----- time spent for training  : 45.255584955215454 -----
 time for train set report : 0.0 
eval time for val set : 2.5185317993164062 
epoch loss: 75.049, taining accuracy: 93.83, validation accuracy: 90.89, Val-F1-score: 49.11, Test-F1 : 48.60, 
Val_Geo_Mean : 61.80 , test_geo: 61.17

******************** GRUD_GRU *************************************
--- EPOCH: 33 --------------------------------- B-F1: 53.11 from EPOCH: 25,   Test-F1 : 51.07
----- time spent for training  : 44.94716930389404 -----
 time for train set report : 0.0 
eval time for val set : 2.473590612411499 
epoch loss: 73.228, taining accuracy: 93.99, validation accuracy: 90.92, Val-F1-score: 53.81, Test-F1 : 52.63, 
Val_Geo_Mean : 67.44 , test_geo: 65.44
New Best F1 Score at epoch 32 : 53.81

******************** GRUD_GRU *************************************
--- EPOCH: 34 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 47.213409662246704 -----
 time for train set report : 0.0 
eval time for val set : 2.434751272201538 
epoch loss: 72.634, taining accuracy: 94.03, validation accuracy: 90.89, Val-F1-score: 50.52, Test-F1 : 50.95, 
Val_Geo_Mean : 63.47 , test_geo: 63.12

******************** GRUD_GRU *************************************
--- EPOCH: 35 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 46.716156244277954 -----
 time for train set report : 0.0 
eval time for val set : 2.472266912460327 
epoch loss: 71.057, taining accuracy: 94.05, validation accuracy: 90.57, Val-F1-score: 52.26, Test-F1 : 53.03, 
Val_Geo_Mean : 66.54 , test_geo: 65.84

******************** GRUD_GRU *************************************
--- EPOCH: 36 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 45.09329605102539 -----
 time for train set report : 0.0 
eval time for val set : 2.4130990505218506 
epoch loss: 69.652, taining accuracy: 94.22, validation accuracy: 90.79, Val-F1-score: 51.43, Test-F1 : 52.35, 
Val_Geo_Mean : 64.86 , test_geo: 64.72

******************** GRUD_GRU *************************************
--- EPOCH: 37 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 46.05522346496582 -----
 time for train set report : 0.0 
eval time for val set : 2.41507887840271 
epoch loss: 68.717, taining accuracy: 94.43, validation accuracy: 90.28, Val-F1-score: 51.04, Test-F1 : 52.01, 
Val_Geo_Mean : 65.84 , test_geo: 66.69

******************** GRUD_GRU *************************************
--- EPOCH: 38 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 46.45021414756775 -----
 time for train set report : 0.0 
eval time for val set : 2.4463603496551514 
epoch loss: 67.215, taining accuracy: 94.48, validation accuracy: 90.38, Val-F1-score: 52.37, Test-F1 : 54.66, 
Val_Geo_Mean : 67.23 , test_geo: 68.86

******************** GRUD_GRU *************************************
--- EPOCH: 39 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 46.665276288986206 -----
 time for train set report : 0.0 
eval time for val set : 2.451385736465454 
epoch loss: 66.019, taining accuracy: 94.72, validation accuracy: 90.18, Val-F1-score: 50.48, Test-F1 : 53.40, 
Val_Geo_Mean : 65.42 , test_geo: 67.06

******************** GRUD_GRU *************************************
--- EPOCH: 40 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 46.50649428367615 -----
 time for train set report : 0.0 
eval time for val set : 2.412684202194214 
epoch loss: 64.738, taining accuracy: 94.78, validation accuracy: 90.66, Val-F1-score: 52.97, Test-F1 : 54.69, 
Val_Geo_Mean : 67.15 , test_geo: 67.74

******************** GRUD_GRU *************************************
--- EPOCH: 41 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 46.88138556480408 -----
 time for train set report : 0.0 
eval time for val set : 2.4102697372436523 
epoch loss: 63.527, taining accuracy: 94.86, validation accuracy: 91.11, Val-F1-score: 53.42, Test-F1 : 53.88, 
Val_Geo_Mean : 66.36 , test_geo: 66.13

******************** GRUD_GRU *************************************
--- EPOCH: 42 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 46.3536114692688 -----
 time for train set report : 0.0 
eval time for val set : 2.4615886211395264 
epoch loss: 61.415, taining accuracy: 95.04, validation accuracy: 90.73, Val-F1-score: 49.74, Test-F1 : 52.26, 
Val_Geo_Mean : 63.00 , test_geo: 64.71

******************** GRUD_GRU *************************************
--- EPOCH: 43 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 46.47150993347168 -----
 time for train set report : 0.0 
eval time for val set : 2.4224350452423096 
epoch loss: 60.795, taining accuracy: 95.11, validation accuracy: 89.83, Val-F1-score: 53.02, Test-F1 : 55.62, 
Val_Geo_Mean : 69.60 , test_geo: 71.17

******************** GRUD_GRU *************************************
--- EPOCH: 44 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 12440.015843153 -----
 time for train set report : 0.0 
eval time for val set : 2.6972649097442627 
epoch loss: 59.919, taining accuracy: 95.31, validation accuracy: 90.38, Val-F1-score: 50.97, Test-F1 : 51.28, 
Val_Geo_Mean : 65.49 , test_geo: 65.25

******************** GRUD_GRU *************************************
--- EPOCH: 45 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 41.91547608375549 -----
 time for train set report : 0.0 
eval time for val set : 2.4610166549682617 
epoch loss: 58.238, taining accuracy: 95.39, validation accuracy: 90.31, Val-F1-score: 52.20, Test-F1 : 52.65, 
Val_Geo_Mean : 67.20 , test_geo: 67.75

******************** GRUD_GRU *************************************
--- EPOCH: 46 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 38.987157106399536 -----
 time for train set report : 0.0 
eval time for val set : 2.5879178047180176 
epoch loss: 57.183, taining accuracy: 95.45, validation accuracy: 90.50, Val-F1-score: 53.73, Test-F1 : 53.79, 
Val_Geo_Mean : 68.59 , test_geo: 67.93

******************** GRUD_GRU *************************************
--- EPOCH: 47 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 39.29806995391846 -----
 time for train set report : 0.0 
eval time for val set : 2.5729458332061768 
epoch loss: 55.200, taining accuracy: 95.69, validation accuracy: 90.57, Val-F1-score: 51.79, Test-F1 : 51.37, 
Val_Geo_Mean : 65.95 , test_geo: 65.09

******************** GRUD_GRU *************************************
--- EPOCH: 48 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 38.984886169433594 -----
 time for train set report : 0.0 
eval time for val set : 2.572787046432495 
epoch loss: 54.911, taining accuracy: 95.64, validation accuracy: 89.96, Val-F1-score: 50.08, Test-F1 : 52.89, 
Val_Geo_Mean : 65.53 , test_geo: 67.79

******************** GRUD_GRU *************************************
--- EPOCH: 49 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 38.622925758361816 -----
 time for train set report : 0.0 
eval time for val set : 2.57600998878479 
epoch loss: 52.897, taining accuracy: 95.92, validation accuracy: 90.60, Val-F1-score: 51.08, Test-F1 : 52.05, 
Val_Geo_Mean : 64.98 , test_geo: 65.19

******************** GRUD_GRU *************************************
--- EPOCH: 50 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 40.20734930038452 -----
 time for train set report : 0.0 
eval time for val set : 2.627469539642334 
epoch loss: 51.470, taining accuracy: 95.99, validation accuracy: 90.38, Val-F1-score: 52.22, Test-F1 : 49.76, 
Val_Geo_Mean : 67.04 , test_geo: 64.17

******************** GRUD_GRU *************************************
--- EPOCH: 51 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 37.3759069442749 -----
 time for train set report : 0.0 
eval time for val set : 2.484571933746338 
epoch loss: 50.973, taining accuracy: 96.16, validation accuracy: 89.17, Val-F1-score: 51.29, Test-F1 : 52.82, 
Val_Geo_Mean : 69.14 , test_geo: 69.78

******************** GRUD_GRU *************************************
--- EPOCH: 52 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 36.44364333152771 -----
 time for train set report : 0.0 
eval time for val set : 2.469017505645752 
epoch loss: 49.621, taining accuracy: 96.28, validation accuracy: 90.18, Val-F1-score: 51.57, Test-F1 : 52.23, 
Val_Geo_Mean : 66.77 , test_geo: 67.04

******************** GRUD_GRU *************************************
--- EPOCH: 53 --------------------------------- B-F1: 53.81 from EPOCH: 33,   Test-F1 : 52.63
----- time spent for training  : 36.650721073150635 -----
 time for train set report : 0.0 
eval time for val set : 2.472587823867798 
epoch loss: 47.778, taining accuracy: 96.29, validation accuracy: 89.17, Val-F1-score: 54.05, Test-F1 : 51.34, 
Val_Geo_Mean : 72.79 , test_geo: 70.09
New Best F1 Score at epoch 52 : 54.05

******************** GRUD_GRU *************************************
--- EPOCH: 54 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.421741008758545 -----
 time for train set report : 0.0 
eval time for val set : 2.5024943351745605 
epoch loss: 46.380, taining accuracy: 96.40, validation accuracy: 89.90, Val-F1-score: 51.60, Test-F1 : 52.49, 
Val_Geo_Mean : 67.60 , test_geo: 67.73

******************** GRUD_GRU *************************************
--- EPOCH: 55 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.646358489990234 -----
 time for train set report : 0.0 
eval time for val set : 2.48345685005188 
epoch loss: 45.517, taining accuracy: 96.50, validation accuracy: 89.61, Val-F1-score: 50.76, Test-F1 : 51.73, 
Val_Geo_Mean : 67.30 , test_geo: 67.28

******************** GRUD_GRU *************************************
--- EPOCH: 56 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.84558463096619 -----
 time for train set report : 0.0 
eval time for val set : 2.4915285110473633 
epoch loss: 44.723, taining accuracy: 96.60, validation accuracy: 90.22, Val-F1-score: 53.13, Test-F1 : 52.29, 
Val_Geo_Mean : 68.66 , test_geo: 67.22

******************** GRUD_GRU *************************************
--- EPOCH: 57 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.65049600601196 -----
 time for train set report : 0.0 
eval time for val set : 2.479667901992798 
epoch loss: 42.400, taining accuracy: 96.92, validation accuracy: 90.41, Val-F1-score: 50.90, Test-F1 : 51.11, 
Val_Geo_Mean : 65.31 , test_geo: 65.39

******************** GRUD_GRU *************************************
--- EPOCH: 58 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.624651193618774 -----
 time for train set report : 0.0 
eval time for val set : 2.4890503883361816 
epoch loss: 42.066, taining accuracy: 96.87, validation accuracy: 89.64, Val-F1-score: 51.85, Test-F1 : 49.78, 
Val_Geo_Mean : 68.61 , test_geo: 66.48

******************** GRUD_GRU *************************************
--- EPOCH: 59 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.86930012702942 -----
 time for train set report : 0.0 
eval time for val set : 2.5101916790008545 
epoch loss: 41.559, taining accuracy: 97.00, validation accuracy: 89.07, Val-F1-score: 52.43, Test-F1 : 51.77, 
Val_Geo_Mean : 70.87 , test_geo: 70.03

******************** GRUD_GRU *************************************
--- EPOCH: 60 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.15877413749695 -----
 time for train set report : 0.0 
eval time for val set : 2.4714558124542236 
epoch loss: 40.317, taining accuracy: 96.98, validation accuracy: 90.06, Val-F1-score: 51.85, Test-F1 : 48.14, 
Val_Geo_Mean : 67.48 , test_geo: 63.92

******************** GRUD_GRU *************************************
--- EPOCH: 61 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.96225666999817 -----
 time for train set report : 0.0 
eval time for val set : 2.4765093326568604 
epoch loss: 36.862, taining accuracy: 97.43, validation accuracy: 90.34, Val-F1-score: 49.58, Test-F1 : 49.00, 
Val_Geo_Mean : 63.88 , test_geo: 62.67

******************** GRUD_GRU *************************************
--- EPOCH: 62 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.47437572479248 -----
 time for train set report : 0.0 
eval time for val set : 2.5093936920166016 
epoch loss: 37.763, taining accuracy: 97.30, validation accuracy: 89.77, Val-F1-score: 51.87, Test-F1 : 51.04, 
Val_Geo_Mean : 68.30 , test_geo: 67.01

******************** GRUD_GRU *************************************
--- EPOCH: 63 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.95706295967102 -----
 time for train set report : 0.0 
eval time for val set : 2.498703718185425 
epoch loss: 36.041, taining accuracy: 97.37, validation accuracy: 90.47, Val-F1-score: 51.38, Test-F1 : 51.11, 
Val_Geo_Mean : 65.72 , test_geo: 65.39

******************** GRUD_GRU *************************************
--- EPOCH: 64 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.38661313056946 -----
 time for train set report : 0.0 
eval time for val set : 2.526928186416626 
epoch loss: 35.352, taining accuracy: 97.60, validation accuracy: 90.06, Val-F1-score: 51.25, Test-F1 : 49.15, 
Val_Geo_Mean : 66.72 , test_geo: 64.75

******************** GRUD_GRU *************************************
--- EPOCH: 65 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 38.2898850440979 -----
 time for train set report : 0.0 
eval time for val set : 2.479100465774536 
epoch loss: 33.116, taining accuracy: 97.69, validation accuracy: 89.77, Val-F1-score: 49.45, Test-F1 : 49.92, 
Val_Geo_Mean : 65.26 , test_geo: 64.54

******************** GRUD_GRU *************************************
--- EPOCH: 66 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.04305839538574 -----
 time for train set report : 0.0 
eval time for val set : 2.4804985523223877 
epoch loss: 32.580, taining accuracy: 97.88, validation accuracy: 89.55, Val-F1-score: 49.85, Test-F1 : 48.17, 
Val_Geo_Mean : 66.33 , test_geo: 64.43

******************** GRUD_GRU *************************************
--- EPOCH: 67 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.19082045555115 -----
 time for train set report : 0.0 
eval time for val set : 2.488318681716919 
epoch loss: 31.496, taining accuracy: 97.84, validation accuracy: 89.17, Val-F1-score: 51.98, Test-F1 : 49.20, 
Val_Geo_Mean : 70.03 , test_geo: 66.54

******************** GRUD_GRU *************************************
--- EPOCH: 68 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.57193207740784 -----
 time for train set report : 0.0 
eval time for val set : 2.4909276962280273 
epoch loss: 30.197, taining accuracy: 97.90, validation accuracy: 89.77, Val-F1-score: 50.54, Test-F1 : 50.00, 
Val_Geo_Mean : 66.61 , test_geo: 65.55

******************** GRUD_GRU *************************************
--- EPOCH: 69 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.21963834762573 -----
 time for train set report : 0.0 
eval time for val set : 2.5119240283966064 
epoch loss: 29.266, taining accuracy: 97.99, validation accuracy: 88.75, Val-F1-score: 50.21, Test-F1 : 46.83, 
Val_Geo_Mean : 68.79 , test_geo: 66.09

******************** GRUD_GRU *************************************
--- EPOCH: 70 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.48629856109619 -----
 time for train set report : 0.0 
eval time for val set : 2.4664206504821777 
epoch loss: 28.789, taining accuracy: 98.08, validation accuracy: 89.29, Val-F1-score: 51.16, Test-F1 : 50.57, 
Val_Geo_Mean : 68.65 , test_geo: 67.71

******************** GRUD_GRU *************************************
--- EPOCH: 71 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.73355269432068 -----
 time for train set report : 0.0 
eval time for val set : 2.4672389030456543 
epoch loss: 27.436, taining accuracy: 98.14, validation accuracy: 89.71, Val-F1-score: 50.84, Test-F1 : 48.80, 
Val_Geo_Mean : 67.15 , test_geo: 65.19

******************** GRUD_GRU *************************************
--- EPOCH: 72 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.06332278251648 -----
 time for train set report : 0.0 
eval time for val set : 2.4799091815948486 
epoch loss: 28.351, taining accuracy: 98.04, validation accuracy: 88.05, Val-F1-score: 48.98, Test-F1 : 49.27, 
Val_Geo_Mean : 68.86 , test_geo: 68.81

******************** GRUD_GRU *************************************
--- EPOCH: 73 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.92268514633179 -----
 time for train set report : 0.0 
eval time for val set : 2.4693281650543213 
epoch loss: 24.756, taining accuracy: 98.42, validation accuracy: 88.53, Val-F1-score: 50.28, Test-F1 : 47.74, 
Val_Geo_Mean : 69.41 , test_geo: 66.11

******************** GRUD_GRU *************************************
--- EPOCH: 74 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.08846855163574 -----
 time for train set report : 0.0 
eval time for val set : 2.499629259109497 
epoch loss: 25.909, taining accuracy: 98.29, validation accuracy: 89.61, Val-F1-score: 48.42, Test-F1 : 48.52, 
Val_Geo_Mean : 64.41 , test_geo: 64.15

******************** GRUD_GRU *************************************
--- EPOCH: 75 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.032007932662964 -----
 time for train set report : 0.0 
eval time for val set : 2.4705100059509277 
epoch loss: 23.678, taining accuracy: 98.38, validation accuracy: 88.75, Val-F1-score: 49.79, Test-F1 : 49.35, 
Val_Geo_Mean : 68.25 , test_geo: 66.88

******************** GRUD_GRU *************************************
--- EPOCH: 76 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.22718334197998 -----
 time for train set report : 0.0 
eval time for val set : 2.458667039871216 
epoch loss: 23.005, taining accuracy: 98.60, validation accuracy: 88.88, Val-F1-score: 51.60, Test-F1 : 46.81, 
Val_Geo_Mean : 70.26 , test_geo: 65.93

******************** GRUD_GRU *************************************
--- EPOCH: 77 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 36.995442628860474 -----
 time for train set report : 0.0 
eval time for val set : 2.457679271697998 
epoch loss: 22.821, taining accuracy: 98.55, validation accuracy: 88.97, Val-F1-score: 49.86, Test-F1 : 48.33, 
Val_Geo_Mean : 67.79 , test_geo: 65.75

******************** GRUD_GRU *************************************
--- EPOCH: 78 --------------------------------- B-F1: 54.05 from EPOCH: 53,   Test-F1 : 51.34
----- time spent for training  : 37.40043044090271 -----
 time for train set report : 0.0 
eval time for val set : 2.4706480503082275 
epoch loss: 21.343, taining accuracy: 98.56, validation accuracy: 87.41, Val-F1-score: 49.42, Test-F1 : 48.97, 
Val_Geo_Mean : 70.84 , test_geo: 69.60
Early Stopping @ EPOCH:[77]
saving the models state...
Loaded model arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
 Model is  GRUD
{'epochs': 100, 'batch_size': 80, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 6, 'lr': 0.0008523905220697172, 'rnn_cell': 'GRU', 'input_key_size': 128, 'input_value_size': 128, 'input_query_size': 128, 'num_input_heads': 2, 'input_dropout': 0.2646069354229395, 'comm_key_size': 32, 'comm_value_size': 104, 'comm_query_size': 32, 'num_comm_heads': 2, 'comm_dropout': 0.1424485190933118, 'active_rims': 4, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 15.80766224861145 -----
 time for train set report : 0.0 
eval time for val set : 1.1682209968566895 
epoch loss: 53.618, taining accuracy: 89.20, validation accuracy: 91.08, Val-F1-score: 33.33, Test-F1 : 35.01, 
Val_Geo_Mean : 46.27 , test_geo: 47.96
New Best F1 Score at epoch 0 : 33.33

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 33.33 from EPOCH: 1,   Test-F1 : 35.01
----- time spent for training  : 15.623339414596558 -----
 time for train set report : 0.0 
eval time for val set : 1.1617445945739746 
epoch loss: 44.237, taining accuracy: 90.81, validation accuracy: 91.49, Val-F1-score: 43.31, Test-F1 : 43.14, 
Val_Geo_Mean : 55.66 , test_geo: 55.69
New Best F1 Score at epoch 1 : 43.31

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 43.31 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 15.333318948745728 -----
 time for train set report : 0.0 
eval time for val set : 1.161996841430664 
epoch loss: 42.314, taining accuracy: 91.17, validation accuracy: 91.87, Val-F1-score: 49.10, Test-F1 : 45.47, 
Val_Geo_Mean : 61.02 , test_geo: 58.09
New Best F1 Score at epoch 2 : 49.10

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 49.10 from EPOCH: 3,   Test-F1 : 45.47
----- time spent for training  : 15.45473575592041 -----
 time for train set report : 0.0 
eval time for val set : 1.164179801940918 
epoch loss: 40.318, taining accuracy: 91.60, validation accuracy: 92.10, Val-F1-score: 50.20, Test-F1 : 48.26, 
Val_Geo_Mean : 61.57 , test_geo: 60.68
New Best F1 Score at epoch 3 : 50.20

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 50.20 from EPOCH: 4,   Test-F1 : 48.26
----- time spent for training  : 15.643184185028076 -----
 time for train set report : 0.0 
eval time for val set : 1.175555944442749 
epoch loss: 38.871, taining accuracy: 91.84, validation accuracy: 92.22, Val-F1-score: 49.79, Test-F1 : 44.69, 
Val_Geo_Mean : 60.66 , test_geo: 56.83

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 50.20 from EPOCH: 4,   Test-F1 : 48.26
----- time spent for training  : 15.373954772949219 -----
 time for train set report : 0.0 
eval time for val set : 1.166722059249878 
epoch loss: 37.671, taining accuracy: 92.22, validation accuracy: 91.78, Val-F1-score: 50.76, Test-F1 : 50.00, 
Val_Geo_Mean : 63.30 , test_geo: 62.62
New Best F1 Score at epoch 5 : 50.76

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 50.76 from EPOCH: 6,   Test-F1 : 50.00
----- time spent for training  : 15.651513576507568 -----
 time for train set report : 0.0 
eval time for val set : 1.174793004989624 
epoch loss: 36.014, taining accuracy: 92.53, validation accuracy: 91.59, Val-F1-score: 52.00, Test-F1 : 46.92, 
Val_Geo_Mean : 65.45 , test_geo: 61.40
New Best F1 Score at epoch 6 : 52.00

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.571102142333984 -----
 time for train set report : 0.0 
eval time for val set : 1.1661152839660645 
epoch loss: 34.344, taining accuracy: 92.72, validation accuracy: 91.56, Val-F1-score: 51.38, Test-F1 : 47.27, 
Val_Geo_Mean : 64.78 , test_geo: 61.22

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.459261894226074 -----
 time for train set report : 0.0 
eval time for val set : 1.1654598712921143 
epoch loss: 32.184, taining accuracy: 93.26, validation accuracy: 91.20, Val-F1-score: 51.24, Test-F1 : 50.00, 
Val_Geo_Mean : 65.73 , test_geo: 64.71

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.908315896987915 -----
 time for train set report : 0.0 
eval time for val set : 1.2084784507751465 
epoch loss: 30.159, taining accuracy: 93.82, validation accuracy: 90.85, Val-F1-score: 51.93, Test-F1 : 48.61, 
Val_Geo_Mean : 67.70 , test_geo: 65.31

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.377736806869507 -----
 time for train set report : 0.0 
eval time for val set : 1.1750364303588867 
epoch loss: 28.001, taining accuracy: 94.28, validation accuracy: 90.98, Val-F1-score: 50.09, Test-F1 : 47.94, 
Val_Geo_Mean : 65.00 , test_geo: 62.80

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.603686332702637 -----
 time for train set report : 0.0 
eval time for val set : 1.1688168048858643 
epoch loss: 25.482, taining accuracy: 94.86, validation accuracy: 90.98, Val-F1-score: 47.50, Test-F1 : 44.01, 
Val_Geo_Mean : 61.87 , test_geo: 58.84

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.543426275253296 -----
 time for train set report : 0.0 
eval time for val set : 1.1661491394042969 
epoch loss: 22.800, taining accuracy: 95.56, validation accuracy: 90.50, Val-F1-score: 50.99, Test-F1 : 48.77, 
Val_Geo_Mean : 67.56 , test_geo: 65.14

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.444928169250488 -----
 time for train set report : 0.0 
eval time for val set : 1.1703808307647705 
epoch loss: 21.228, taining accuracy: 95.83, validation accuracy: 90.79, Val-F1-score: 51.59, Test-F1 : 47.18, 
Val_Geo_Mean : 67.47 , test_geo: 63.92

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.42887568473816 -----
 time for train set report : 0.0 
eval time for val set : 1.1694238185882568 
epoch loss: 18.370, taining accuracy: 96.37, validation accuracy: 90.28, Val-F1-score: 51.04, Test-F1 : 48.73, 
Val_Geo_Mean : 68.29 , test_geo: 66.11

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.610087156295776 -----
 time for train set report : 0.0 
eval time for val set : 1.1621065139770508 
epoch loss: 15.495, taining accuracy: 96.96, validation accuracy: 90.34, Val-F1-score: 48.90, Test-F1 : 47.48, 
Val_Geo_Mean : 65.41 , test_geo: 63.56

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.44893741607666 -----
 time for train set report : 0.0 
eval time for val set : 1.1613376140594482 
epoch loss: 13.973, taining accuracy: 97.42, validation accuracy: 90.41, Val-F1-score: 48.19, Test-F1 : 44.80, 
Val_Geo_Mean : 64.35 , test_geo: 61.75

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.445326328277588 -----
 time for train set report : 0.0 
eval time for val set : 1.185675859451294 
epoch loss: 11.899, taining accuracy: 97.73, validation accuracy: 89.87, Val-F1-score: 47.70, Test-F1 : 46.08, 
Val_Geo_Mean : 65.22 , test_geo: 63.96

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.598772048950195 -----
 time for train set report : 0.0 
eval time for val set : 1.1624393463134766 
epoch loss: 10.706, taining accuracy: 97.96, validation accuracy: 90.09, Val-F1-score: 48.60, Test-F1 : 45.08, 
Val_Geo_Mean : 65.73 , test_geo: 62.00

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.553842782974243 -----
 time for train set report : 0.0 
eval time for val set : 1.163172960281372 
epoch loss: 8.310, taining accuracy: 98.46, validation accuracy: 90.47, Val-F1-score: 50.74, Test-F1 : 46.47, 
Val_Geo_Mean : 67.34 , test_geo: 64.02

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.56967544555664 -----
 time for train set report : 0.0 
eval time for val set : 1.1664094924926758 
epoch loss: 6.687, taining accuracy: 98.75, validation accuracy: 89.67, Val-F1-score: 46.71, Test-F1 : 43.62, 
Val_Geo_Mean : 64.51 , test_geo: 61.16

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.676827192306519 -----
 time for train set report : 0.0 
eval time for val set : 1.1626453399658203 
epoch loss: 6.187, taining accuracy: 98.82, validation accuracy: 89.87, Val-F1-score: 47.35, Test-F1 : 46.18, 
Val_Geo_Mean : 64.80 , test_geo: 62.97

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.765148878097534 -----
 time for train set report : 0.0 
eval time for val set : 1.171947956085205 
epoch loss: 4.473, taining accuracy: 99.25, validation accuracy: 90.15, Val-F1-score: 47.89, Test-F1 : 45.20, 
Val_Geo_Mean : 64.69 , test_geo: 62.22

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.734976530075073 -----
 time for train set report : 0.0 
eval time for val set : 1.1621143817901611 
epoch loss: 4.395, taining accuracy: 99.31, validation accuracy: 89.61, Val-F1-score: 47.08, Test-F1 : 45.50, 
Val_Geo_Mean : 65.13 , test_geo: 63.67

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.88935923576355 -----
 time for train set report : 0.0 
eval time for val set : 1.1819989681243896 
epoch loss: 3.918, taining accuracy: 99.41, validation accuracy: 89.93, Val-F1-score: 48.37, Test-F1 : 47.06, 
Val_Geo_Mean : 65.88 , test_geo: 64.30

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.664926052093506 -----
 time for train set report : 0.0 
eval time for val set : 1.1716055870056152 
epoch loss: 4.174, taining accuracy: 99.22, validation accuracy: 89.36, Val-F1-score: 48.62, Test-F1 : 46.79, 
Val_Geo_Mean : 67.72 , test_geo: 66.18

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.473666667938232 -----
 time for train set report : 0.0 
eval time for val set : 1.1675829887390137 
epoch loss: 3.233, taining accuracy: 99.48, validation accuracy: 89.48, Val-F1-score: 46.08, Test-F1 : 46.39, 
Val_Geo_Mean : 64.22 , test_geo: 64.59

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.882710933685303 -----
 time for train set report : 0.0 
eval time for val set : 1.173661470413208 
epoch loss: 2.332, taining accuracy: 99.67, validation accuracy: 89.39, Val-F1-score: 47.89, Test-F1 : 48.30, 
Val_Geo_Mean : 66.71 , test_geo: 66.98

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.570599794387817 -----
 time for train set report : 0.0 
eval time for val set : 1.1646692752838135 
epoch loss: 1.302, taining accuracy: 99.84, validation accuracy: 89.13, Val-F1-score: 47.62, Test-F1 : 45.39, 
Val_Geo_Mean : 67.02 , test_geo: 64.44

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.436041593551636 -----
 time for train set report : 0.0 
eval time for val set : 1.1733343601226807 
epoch loss: 1.895, taining accuracy: 99.73, validation accuracy: 89.36, Val-F1-score: 47.15, Test-F1 : 45.53, 
Val_Geo_Mean : 65.87 , test_geo: 64.84

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.545821905136108 -----
 time for train set report : 0.0 
eval time for val set : 1.1669921875 
epoch loss: 2.127, taining accuracy: 99.66, validation accuracy: 89.10, Val-F1-score: 46.56, Test-F1 : 47.88, 
Val_Geo_Mean : 65.77 , test_geo: 65.40

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 52.00 from EPOCH: 7,   Test-F1 : 46.92
----- time spent for training  : 15.783079385757446 -----
 time for train set report : 0.0 
eval time for val set : 1.1682817935943604 
epoch loss: 0.906, taining accuracy: 99.93, validation accuracy: 88.43, Val-F1-score: 47.92, Test-F1 : 45.62, 
Val_Geo_Mean : 69.12 , test_geo: 66.88
Early Stopping @ EPOCH:[31]
saving the models state...
Loaded model arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
 Model is  GRUD
{'epochs': 100, 'batch_size': 48, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 2, 'lr': 4.3314774935142666e-05, 'rnn_cell': 'GRU', 'input_key_size': 32, 'input_value_size': 64, 'input_query_size': 32, 'num_input_heads': 2, 'input_dropout': 0.2183988114345861, 'comm_key_size': 64, 'comm_value_size': 104, 'comm_query_size': 64, 'num_comm_heads': 2, 'comm_dropout': 0.1226555560040696, 'active_rims': 2, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 30.154436826705933 -----
 time for train set report : 0.0 
eval time for val set : 1.7416751384735107 
epoch loss: 135.666, taining accuracy: 87.85, validation accuracy: 89.32, Val-F1-score: 17.28, Test-F1 : 20.71, 
Val_Geo_Mean : 31.43 , test_geo: 34.74
New Best F1 Score at epoch 0 : 17.28

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 17.28 from EPOCH: 1,   Test-F1 : 20.71
----- time spent for training  : 31.490721702575684 -----
 time for train set report : 0.0 
eval time for val set : 1.7392981052398682 
epoch loss: 86.159, taining accuracy: 90.20, validation accuracy: 89.83, Val-F1-score: 27.33, Test-F1 : 27.03, 
Val_Geo_Mean : 41.09 , test_geo: 40.55
New Best F1 Score at epoch 1 : 27.33

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 27.33 from EPOCH: 2,   Test-F1 : 27.03
----- time spent for training  : 31.155940055847168 -----
 time for train set report : 0.0 
eval time for val set : 1.7384953498840332 
epoch loss: 80.319, taining accuracy: 90.40, validation accuracy: 90.03, Val-F1-score: 34.66, Test-F1 : 34.02, 
Val_Geo_Mean : 48.17 , test_geo: 47.27
New Best F1 Score at epoch 2 : 34.66

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 34.66 from EPOCH: 3,   Test-F1 : 34.02
----- time spent for training  : 31.271190404891968 -----
 time for train set report : 0.0 
eval time for val set : 1.7179114818572998 
epoch loss: 76.829, taining accuracy: 90.65, validation accuracy: 90.09, Val-F1-score: 37.68, Test-F1 : 37.75, 
Val_Geo_Mean : 51.18 , test_geo: 50.57
New Best F1 Score at epoch 3 : 37.68

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 37.68 from EPOCH: 4,   Test-F1 : 37.75
----- time spent for training  : 31.047167539596558 -----
 time for train set report : 0.0 
eval time for val set : 1.7092764377593994 
epoch loss: 74.860, taining accuracy: 90.76, validation accuracy: 89.96, Val-F1-score: 39.07, Test-F1 : 39.69, 
Val_Geo_Mean : 52.95 , test_geo: 52.82
New Best F1 Score at epoch 4 : 39.07

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 39.07 from EPOCH: 5,   Test-F1 : 39.69
----- time spent for training  : 31.720611810684204 -----
 time for train set report : 0.0 
eval time for val set : 1.7334458827972412 
epoch loss: 73.403, taining accuracy: 90.92, validation accuracy: 90.06, Val-F1-score: 39.30, Test-F1 : 40.23, 
Val_Geo_Mean : 52.98 , test_geo: 53.11
New Best F1 Score at epoch 5 : 39.30

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 39.30 from EPOCH: 6,   Test-F1 : 40.23
----- time spent for training  : 31.7307186126709 -----
 time for train set report : 0.0 
eval time for val set : 1.7315738201141357 
epoch loss: 72.494, taining accuracy: 91.00, validation accuracy: 90.09, Val-F1-score: 39.14, Test-F1 : 39.92, 
Val_Geo_Mean : 52.73 , test_geo: 52.85

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 39.30 from EPOCH: 6,   Test-F1 : 40.23
----- time spent for training  : 31.254130125045776 -----
 time for train set report : 0.0 
eval time for val set : 1.7204816341400146 
epoch loss: 71.841, taining accuracy: 91.05, validation accuracy: 90.31, Val-F1-score: 38.96, Test-F1 : 38.43, 
Val_Geo_Mean : 52.03 , test_geo: 51.56

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 39.30 from EPOCH: 6,   Test-F1 : 40.23
----- time spent for training  : 31.728766441345215 -----
 time for train set report : 0.0 
eval time for val set : 1.7469227313995361 
epoch loss: 70.946, taining accuracy: 91.10, validation accuracy: 90.44, Val-F1-score: 40.24, Test-F1 : 39.38, 
Val_Geo_Mean : 53.09 , test_geo: 52.34
New Best F1 Score at epoch 8 : 40.24

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 40.24 from EPOCH: 9,   Test-F1 : 39.38
----- time spent for training  : 31.64989423751831 -----
 time for train set report : 0.0 
eval time for val set : 1.7150638103485107 
epoch loss: 70.255, taining accuracy: 91.15, validation accuracy: 90.44, Val-F1-score: 42.31, Test-F1 : 42.21, 
Val_Geo_Mean : 55.32 , test_geo: 54.84
New Best F1 Score at epoch 9 : 42.31

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 42.31 from EPOCH: 10,   Test-F1 : 42.21
----- time spent for training  : 31.419140100479126 -----
 time for train set report : 0.0 
eval time for val set : 1.7302494049072266 
epoch loss: 69.577, taining accuracy: 91.25, validation accuracy: 90.44, Val-F1-score: 42.53, Test-F1 : 41.59, 
Val_Geo_Mean : 55.56 , test_geo: 54.56
New Best F1 Score at epoch 10 : 42.53

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 42.53 from EPOCH: 11,   Test-F1 : 41.59
----- time spent for training  : 31.35911464691162 -----
 time for train set report : 0.0 
eval time for val set : 1.7160155773162842 
epoch loss: 69.126, taining accuracy: 91.33, validation accuracy: 90.57, Val-F1-score: 43.08, Test-F1 : 43.23, 
Val_Geo_Mean : 55.84 , test_geo: 55.80
New Best F1 Score at epoch 11 : 43.08

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 43.08 from EPOCH: 12,   Test-F1 : 43.23
----- time spent for training  : 30.632561922073364 -----
 time for train set report : 0.0 
eval time for val set : 1.7410130500793457 
epoch loss: 68.973, taining accuracy: 91.32, validation accuracy: 90.50, Val-F1-score: 42.47, Test-F1 : 42.59, 
Val_Geo_Mean : 55.34 , test_geo: 55.10

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 43.08 from EPOCH: 12,   Test-F1 : 43.23
----- time spent for training  : 30.351702451705933 -----
 time for train set report : 0.0 
eval time for val set : 1.7145013809204102 
epoch loss: 68.083, taining accuracy: 91.38, validation accuracy: 90.66, Val-F1-score: 44.19, Test-F1 : 44.28, 
Val_Geo_Mean : 56.82 , test_geo: 56.55
New Best F1 Score at epoch 13 : 44.19

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 44.19 from EPOCH: 14,   Test-F1 : 44.28
----- time spent for training  : 31.182350873947144 -----
 time for train set report : 0.0 
eval time for val set : 1.7159621715545654 
epoch loss: 67.761, taining accuracy: 91.49, validation accuracy: 90.82, Val-F1-score: 43.75, Test-F1 : 41.78, 
Val_Geo_Mean : 55.92 , test_geo: 54.16

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 44.19 from EPOCH: 14,   Test-F1 : 44.28
----- time spent for training  : 31.12229871749878 -----
 time for train set report : 0.0 
eval time for val set : 1.7306933403015137 
epoch loss: 67.235, taining accuracy: 91.47, validation accuracy: 90.79, Val-F1-score: 44.74, Test-F1 : 44.07, 
Val_Geo_Mean : 57.09 , test_geo: 56.32
New Best F1 Score at epoch 15 : 44.74

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 44.74 from EPOCH: 16,   Test-F1 : 44.07
----- time spent for training  : 31.03499960899353 -----
 time for train set report : 0.0 
eval time for val set : 1.7308778762817383 
epoch loss: 66.866, taining accuracy: 91.54, validation accuracy: 90.85, Val-F1-score: 44.49, Test-F1 : 43.81, 
Val_Geo_Mean : 56.64 , test_geo: 55.87

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 44.74 from EPOCH: 16,   Test-F1 : 44.07
----- time spent for training  : 31.918681383132935 -----
 time for train set report : 0.0 
eval time for val set : 1.7295165061950684 
epoch loss: 66.348, taining accuracy: 91.49, validation accuracy: 91.01, Val-F1-score: 46.39, Test-F1 : 44.28, 
Val_Geo_Mean : 58.32 , test_geo: 56.55
New Best F1 Score at epoch 17 : 46.39

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 46.39 from EPOCH: 18,   Test-F1 : 44.28
----- time spent for training  : 31.999287605285645 -----
 time for train set report : 0.0 
eval time for val set : 1.7533586025238037 
epoch loss: 66.061, taining accuracy: 91.68, validation accuracy: 90.85, Val-F1-score: 44.27, Test-F1 : 43.63, 
Val_Geo_Mean : 56.41 , test_geo: 55.44

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 46.39 from EPOCH: 18,   Test-F1 : 44.28
----- time spent for training  : 30.934395790100098 -----
 time for train set report : 0.0 
eval time for val set : 1.713573932647705 
epoch loss: 65.574, taining accuracy: 91.70, validation accuracy: 91.01, Val-F1-score: 47.19, Test-F1 : 44.94, 
Val_Geo_Mean : 59.22 , test_geo: 57.03
New Best F1 Score at epoch 19 : 47.19

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 47.19 from EPOCH: 20,   Test-F1 : 44.94
----- time spent for training  : 31.065478324890137 -----
 time for train set report : 0.0 
eval time for val set : 1.7080423831939697 
epoch loss: 65.486, taining accuracy: 91.72, validation accuracy: 90.82, Val-F1-score: 44.19, Test-F1 : 44.44, 
Val_Geo_Mean : 56.40 , test_geo: 56.16

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 47.19 from EPOCH: 20,   Test-F1 : 44.94
----- time spent for training  : 30.883094310760498 -----
 time for train set report : 0.0 
eval time for val set : 1.7050867080688477 
epoch loss: 64.968, taining accuracy: 91.82, validation accuracy: 90.85, Val-F1-score: 46.75, Test-F1 : 44.94, 
Val_Geo_Mean : 59.17 , test_geo: 57.03

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 47.19 from EPOCH: 20,   Test-F1 : 44.94
----- time spent for training  : 31.176792860031128 -----
 time for train set report : 0.0 
eval time for val set : 1.7154176235198975 
epoch loss: 64.416, taining accuracy: 91.86, validation accuracy: 90.82, Val-F1-score: 46.27, Test-F1 : 44.94, 
Val_Geo_Mean : 58.71 , test_geo: 57.03

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 47.19 from EPOCH: 20,   Test-F1 : 44.94
----- time spent for training  : 31.571484088897705 -----
 time for train set report : 0.0 
eval time for val set : 1.716388463973999 
epoch loss: 64.232, taining accuracy: 91.82, validation accuracy: 91.01, Val-F1-score: 48.16, Test-F1 : 44.57, 
Val_Geo_Mean : 60.33 , test_geo: 56.78
New Best F1 Score at epoch 23 : 48.16

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 48.16 from EPOCH: 24,   Test-F1 : 44.57
----- time spent for training  : 31.23913836479187 -----
 time for train set report : 0.0 
eval time for val set : 1.733776330947876 
epoch loss: 63.639, taining accuracy: 91.85, validation accuracy: 91.11, Val-F1-score: 49.18, Test-F1 : 45.10, 
Val_Geo_Mean : 61.24 , test_geo: 57.45
New Best F1 Score at epoch 24 : 49.18

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 49.18 from EPOCH: 25,   Test-F1 : 45.10
----- time spent for training  : 31.14103102684021 -----
 time for train set report : 0.0 
eval time for val set : 1.7570691108703613 
epoch loss: 63.488, taining accuracy: 91.91, validation accuracy: 91.30, Val-F1-score: 52.36, Test-F1 : 49.39, 
Val_Geo_Mean : 64.44 , test_geo: 61.64
New Best F1 Score at epoch 25 : 52.36

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 52.36 from EPOCH: 26,   Test-F1 : 49.39
----- time spent for training  : 31.168224096298218 -----
 time for train set report : 0.0 
eval time for val set : 1.747107982635498 
epoch loss: 63.356, taining accuracy: 92.06, validation accuracy: 91.20, Val-F1-score: 49.64, Test-F1 : 46.69, 
Val_Geo_Mean : 61.49 , test_geo: 58.64

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 52.36 from EPOCH: 26,   Test-F1 : 49.39
----- time spent for training  : 31.185364723205566 -----
 time for train set report : 0.0 
eval time for val set : 1.7326102256774902 
epoch loss: 62.770, taining accuracy: 92.09, validation accuracy: 91.36, Val-F1-score: 51.69, Test-F1 : 47.50, 
Val_Geo_Mean : 63.44 , test_geo: 59.90

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 52.36 from EPOCH: 26,   Test-F1 : 49.39
----- time spent for training  : 31.25711178779602 -----
 time for train set report : 0.0 
eval time for val set : 1.7120766639709473 
epoch loss: 62.268, taining accuracy: 92.03, validation accuracy: 91.08, Val-F1-score: 48.34, Test-F1 : 45.15, 
Val_Geo_Mean : 60.36 , test_geo: 57.26

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 52.36 from EPOCH: 26,   Test-F1 : 49.39
----- time spent for training  : 31.544052600860596 -----
 time for train set report : 0.0 
eval time for val set : 1.7333307266235352 
epoch loss: 61.780, taining accuracy: 92.19, validation accuracy: 91.27, Val-F1-score: 50.90, Test-F1 : 48.30, 
Val_Geo_Mean : 62.78 , test_geo: 60.38

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 52.36 from EPOCH: 26,   Test-F1 : 49.39
----- time spent for training  : 31.58777141571045 -----
 time for train set report : 0.0 
eval time for val set : 1.7048237323760986 
epoch loss: 61.657, taining accuracy: 92.18, validation accuracy: 91.43, Val-F1-score: 52.72, Test-F1 : 47.94, 
Val_Geo_Mean : 64.49 , test_geo: 60.15
New Best F1 Score at epoch 30 : 52.72

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 52.72 from EPOCH: 31,   Test-F1 : 47.94
----- time spent for training  : 31.68399405479431 -----
 time for train set report : 0.0 
eval time for val set : 1.7424492835998535 
epoch loss: 61.129, taining accuracy: 92.24, validation accuracy: 91.30, Val-F1-score: 50.63, Test-F1 : 46.89, 
Val_Geo_Mean : 62.37 , test_geo: 58.86

******************** GRUD_GRU *************************************
--- EPOCH: 33 --------------------------------- B-F1: 52.72 from EPOCH: 31,   Test-F1 : 47.94
----- time spent for training  : 31.468143224716187 -----
 time for train set report : 0.0 
eval time for val set : 1.736194133758545 
epoch loss: 60.933, taining accuracy: 92.15, validation accuracy: 91.49, Val-F1-score: 53.89, Test-F1 : 48.96, 
Val_Geo_Mean : 65.72 , test_geo: 61.58
New Best F1 Score at epoch 32 : 53.89

******************** GRUD_GRU *************************************
--- EPOCH: 34 --------------------------------- B-F1: 53.89 from EPOCH: 33,   Test-F1 : 48.96
----- time spent for training  : 30.582317352294922 -----
 time for train set report : 0.0 
eval time for val set : 1.7461426258087158 
epoch loss: 60.859, taining accuracy: 92.27, validation accuracy: 91.27, Val-F1-score: 50.18, Test-F1 : 46.24, 
Val_Geo_Mean : 61.94 , test_geo: 58.39

******************** GRUD_GRU *************************************
--- EPOCH: 35 --------------------------------- B-F1: 53.89 from EPOCH: 33,   Test-F1 : 48.96
----- time spent for training  : 31.208221673965454 -----
 time for train set report : 0.0 
eval time for val set : 1.7547426223754883 
epoch loss: 60.359, taining accuracy: 92.33, validation accuracy: 91.14, Val-F1-score: 51.06, Test-F1 : 50.18, 
Val_Geo_Mean : 63.36 , test_geo: 62.11

******************** GRUD_GRU *************************************
--- EPOCH: 36 --------------------------------- B-F1: 53.89 from EPOCH: 33,   Test-F1 : 48.96
----- time spent for training  : 31.15940523147583 -----
 time for train set report : 0.0 
eval time for val set : 1.7047486305236816 
epoch loss: 59.692, taining accuracy: 92.42, validation accuracy: 91.40, Val-F1-score: 52.13, Test-F1 : 48.76, 
Val_Geo_Mean : 63.86 , test_geo: 61.00

******************** GRUD_GRU *************************************
--- EPOCH: 37 --------------------------------- B-F1: 53.89 from EPOCH: 33,   Test-F1 : 48.96
----- time spent for training  : 31.376956701278687 -----
 time for train set report : 0.0 
eval time for val set : 1.7290399074554443 
epoch loss: 60.017, taining accuracy: 92.46, validation accuracy: 91.30, Val-F1-score: 51.51, Test-F1 : 47.87, 
Val_Geo_Mean : 63.42 , test_geo: 60.33

******************** GRUD_GRU *************************************
--- EPOCH: 38 --------------------------------- B-F1: 53.89 from EPOCH: 33,   Test-F1 : 48.96
----- time spent for training  : 31.59384298324585 -----
 time for train set report : 0.0 
eval time for val set : 1.7610385417938232 
epoch loss: 59.112, taining accuracy: 92.55, validation accuracy: 91.36, Val-F1-score: 52.71, Test-F1 : 48.87, 
Val_Geo_Mean : 64.67 , test_geo: 61.39

******************** GRUD_GRU *************************************
--- EPOCH: 39 --------------------------------- B-F1: 53.89 from EPOCH: 33,   Test-F1 : 48.96
----- time spent for training  : 31.050915479660034 -----
 time for train set report : 0.0 
eval time for val set : 1.7185282707214355 
epoch loss: 58.420, taining accuracy: 92.57, validation accuracy: 91.30, Val-F1-score: 52.02, Test-F1 : 47.97, 
Val_Geo_Mean : 64.03 , test_geo: 60.53

******************** GRUD_GRU *************************************
--- EPOCH: 40 --------------------------------- B-F1: 53.89 from EPOCH: 33,   Test-F1 : 48.96
----- time spent for training  : 32.155710220336914 -----
 time for train set report : 0.0 
eval time for val set : 1.7352845668792725 
epoch loss: 58.218, taining accuracy: 92.56, validation accuracy: 91.56, Val-F1-score: 54.86, Test-F1 : 51.43, 
Val_Geo_Mean : 66.73 , test_geo: 64.07
New Best F1 Score at epoch 39 : 54.86

******************** GRUD_GRU *************************************
--- EPOCH: 41 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.753262042999268 -----
 time for train set report : 0.0 
eval time for val set : 1.7153146266937256 
epoch loss: 57.868, taining accuracy: 92.73, validation accuracy: 91.33, Val-F1-score: 51.94, Test-F1 : 48.06, 
Val_Geo_Mean : 63.84 , test_geo: 60.54

******************** GRUD_GRU *************************************
--- EPOCH: 42 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.346242427825928 -----
 time for train set report : 0.0 
eval time for val set : 1.7260432243347168 
epoch loss: 57.338, taining accuracy: 92.77, validation accuracy: 91.20, Val-F1-score: 49.64, Test-F1 : 47.72, 
Val_Geo_Mean : 61.49 , test_geo: 59.55

******************** GRUD_GRU *************************************
--- EPOCH: 43 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.50542950630188 -----
 time for train set report : 0.0 
eval time for val set : 1.7172558307647705 
epoch loss: 56.854, taining accuracy: 92.75, validation accuracy: 91.01, Val-F1-score: 50.87, Test-F1 : 51.19, 
Val_Geo_Mean : 63.52 , test_geo: 63.51

******************** GRUD_GRU *************************************
--- EPOCH: 44 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 32.126556634902954 -----
 time for train set report : 0.0 
eval time for val set : 1.721623182296753 
epoch loss: 56.397, taining accuracy: 92.89, validation accuracy: 91.11, Val-F1-score: 51.48, Test-F1 : 50.52, 
Val_Geo_Mean : 63.96 , test_geo: 62.88

******************** GRUD_GRU *************************************
--- EPOCH: 45 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.87420630455017 -----
 time for train set report : 0.0 
eval time for val set : 1.7306904792785645 
epoch loss: 56.061, taining accuracy: 93.03, validation accuracy: 91.36, Val-F1-score: 53.03, Test-F1 : 50.43, 
Val_Geo_Mean : 65.07 , test_geo: 62.51

******************** GRUD_GRU *************************************
--- EPOCH: 46 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 32.04049348831177 -----
 time for train set report : 0.0 
eval time for val set : 1.7430012226104736 
epoch loss: 55.624, taining accuracy: 93.02, validation accuracy: 91.24, Val-F1-score: 53.31, Test-F1 : 49.58, 
Val_Geo_Mean : 65.82 , test_geo: 62.57

******************** GRUD_GRU *************************************
--- EPOCH: 47 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.40914297103882 -----
 time for train set report : 0.0 
eval time for val set : 1.7280902862548828 
epoch loss: 55.198, taining accuracy: 92.95, validation accuracy: 91.36, Val-F1-score: 53.52, Test-F1 : 50.85, 
Val_Geo_Mean : 65.67 , test_geo: 63.28

******************** GRUD_GRU *************************************
--- EPOCH: 48 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 30.73443841934204 -----
 time for train set report : 0.0 
eval time for val set : 1.7434790134429932 
epoch loss: 54.877, taining accuracy: 93.13, validation accuracy: 91.08, Val-F1-score: 51.89, Test-F1 : 52.61, 
Val_Geo_Mean : 64.56 , test_geo: 64.75

******************** GRUD_GRU *************************************
--- EPOCH: 49 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.007716417312622 -----
 time for train set report : 0.0 
eval time for val set : 1.732898235321045 
epoch loss: 54.309, taining accuracy: 93.17, validation accuracy: 91.05, Val-F1-score: 49.37, Test-F1 : 49.64, 
Val_Geo_Mean : 61.64 , test_geo: 60.93

******************** GRUD_GRU *************************************
--- EPOCH: 50 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.894039154052734 -----
 time for train set report : 0.0 
eval time for val set : 1.736015796661377 
epoch loss: 53.819, taining accuracy: 93.28, validation accuracy: 91.11, Val-F1-score: 53.42, Test-F1 : 52.65, 
Val_Geo_Mean : 66.36 , test_geo: 65.28

******************** GRUD_GRU *************************************
--- EPOCH: 51 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.136521100997925 -----
 time for train set report : 0.0 
eval time for val set : 1.7317428588867188 
epoch loss: 53.566, taining accuracy: 93.20, validation accuracy: 90.89, Val-F1-score: 52.96, Test-F1 : 50.98, 
Val_Geo_Mean : 66.47 , test_geo: 64.52

******************** GRUD_GRU *************************************
--- EPOCH: 52 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.266160011291504 -----
 time for train set report : 0.0 
eval time for val set : 1.742004632949829 
epoch loss: 53.193, taining accuracy: 93.32, validation accuracy: 91.05, Val-F1-score: 50.96, Test-F1 : 50.78, 
Val_Geo_Mean : 63.53 , test_geo: 62.74

******************** GRUD_GRU *************************************
--- EPOCH: 53 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.687562227249146 -----
 time for train set report : 0.0 
eval time for val set : 1.7233481407165527 
epoch loss: 52.610, taining accuracy: 93.42, validation accuracy: 91.08, Val-F1-score: 53.49, Test-F1 : 53.11, 
Val_Geo_Mean : 66.54 , test_geo: 65.85

******************** GRUD_GRU *************************************
--- EPOCH: 54 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.138141632080078 -----
 time for train set report : 0.0 
eval time for val set : 1.7179138660430908 
epoch loss: 51.954, taining accuracy: 93.55, validation accuracy: 90.95, Val-F1-score: 53.29, Test-F1 : 54.19, 
Val_Geo_Mean : 66.69 , test_geo: 67.01

******************** GRUD_GRU *************************************
--- EPOCH: 55 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.2564594745636 -----
 time for train set report : 0.0 
eval time for val set : 1.7145156860351562 
epoch loss: 51.492, taining accuracy: 93.54, validation accuracy: 90.73, Val-F1-score: 51.74, Test-F1 : 53.44, 
Val_Geo_Mean : 65.43 , test_geo: 66.07

******************** GRUD_GRU *************************************
--- EPOCH: 56 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 30.653863668441772 -----
 time for train set report : 0.0 
eval time for val set : 1.7246088981628418 
epoch loss: 51.506, taining accuracy: 93.62, validation accuracy: 91.08, Val-F1-score: 51.72, Test-F1 : 51.53, 
Val_Geo_Mean : 64.36 , test_geo: 63.91

******************** GRUD_GRU *************************************
--- EPOCH: 57 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 30.964950561523438 -----
 time for train set report : 0.0 
eval time for val set : 1.7308714389801025 
epoch loss: 50.877, taining accuracy: 93.64, validation accuracy: 90.92, Val-F1-score: 49.38, Test-F1 : 51.29, 
Val_Geo_Mean : 62.02 , test_geo: 63.34

******************** GRUD_GRU *************************************
--- EPOCH: 58 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 30.93547487258911 -----
 time for train set report : 0.0 
eval time for val set : 1.7141482830047607 
epoch loss: 50.296, taining accuracy: 93.83, validation accuracy: 90.54, Val-F1-score: 49.75, Test-F1 : 52.29, 
Val_Geo_Mean : 63.55 , test_geo: 64.36

******************** GRUD_GRU *************************************
--- EPOCH: 59 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.605112314224243 -----
 time for train set report : 0.0 
eval time for val set : 1.7116661071777344 
epoch loss: 50.207, taining accuracy: 93.81, validation accuracy: 91.05, Val-F1-score: 53.09, Test-F1 : 53.16, 
Val_Geo_Mean : 66.14 , test_geo: 66.20

******************** GRUD_GRU *************************************
--- EPOCH: 60 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.583166122436523 -----
 time for train set report : 0.0 
eval time for val set : 1.727867603302002 
epoch loss: 49.413, taining accuracy: 93.88, validation accuracy: 90.85, Val-F1-score: 51.60, Test-F1 : 51.16, 
Val_Geo_Mean : 64.88 , test_geo: 64.21

******************** GRUD_GRU *************************************
--- EPOCH: 61 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 31.19795870780945 -----
 time for train set report : 0.0 
eval time for val set : 1.7117185592651367 
epoch loss: 48.711, taining accuracy: 94.05, validation accuracy: 90.82, Val-F1-score: 51.52, Test-F1 : 52.82, 
Val_Geo_Mean : 64.87 , test_geo: 65.30

******************** GRUD_GRU *************************************
--- EPOCH: 62 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 27966.039574623108 -----
 time for train set report : 0.0 
eval time for val set : 2.3163137435913086 
epoch loss: 48.575, taining accuracy: 94.01, validation accuracy: 90.82, Val-F1-score: 52.94, Test-F1 : 52.67, 
Val_Geo_Mean : 66.64 , test_geo: 65.96

******************** GRUD_GRU *************************************
--- EPOCH: 63 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 29.17187809944153 -----
 time for train set report : 0.0 
eval time for val set : 1.8569128513336182 
epoch loss: 47.511, taining accuracy: 94.08, validation accuracy: 90.73, Val-F1-score: 50.76, Test-F1 : 53.44, 
Val_Geo_Mean : 64.23 , test_geo: 66.07

******************** GRUD_GRU *************************************
--- EPOCH: 64 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 30.204965353012085 -----
 time for train set report : 0.0 
eval time for val set : 1.72054123878479 
epoch loss: 47.711, taining accuracy: 94.14, validation accuracy: 90.76, Val-F1-score: 51.83, Test-F1 : 54.11, 
Val_Geo_Mean : 65.44 , test_geo: 67.00

******************** GRUD_GRU *************************************
--- EPOCH: 65 --------------------------------- B-F1: 54.86 from EPOCH: 40,   Test-F1 : 51.43
----- time spent for training  : 30.963326930999756 -----
 time for train set report : 0.0 
eval time for val set : 1.7288389205932617 
epoch loss: 46.733, taining accuracy: 94.18, validation accuracy: 90.34, Val-F1-score: 51.98, Test-F1 : 54.29, 
Val_Geo_Mean : 66.83 , test_geo: 68.01
Early Stopping @ EPOCH:[64]
saving the models state...
Loaded model arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
 Model is  GRUD
{'epochs': 100, 'batch_size': 48, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 2, 'lr': 0.0005102199038446042, 'rnn_cell': 'GRU', 'input_key_size': 64, 'input_value_size': 64, 'input_query_size': 64, 'num_input_heads': 1, 'input_dropout': 0.39074162123959577, 'comm_key_size': 64, 'comm_value_size': 104, 'comm_query_size': 64, 'num_comm_heads': 1, 'comm_dropout': 0.11815104048514115, 'active_rims': 2, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 30.601834058761597 -----
 time for train set report : 0.0 
eval time for val set : 1.7295663356781006 
epoch loss: 84.285, taining accuracy: 89.94, validation accuracy: 91.01, Val-F1-score: 43.15, Test-F1 : 43.76, 
Val_Geo_Mean : 56.80 , test_geo: 57.67
New Best F1 Score at epoch 0 : 43.15

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 43.15 from EPOCH: 1,   Test-F1 : 43.76
----- time spent for training  : 30.47906184196472 -----
 time for train set report : 0.0 
eval time for val set : 1.7111215591430664 
epoch loss: 73.351, taining accuracy: 90.72, validation accuracy: 91.71, Val-F1-score: 46.94, Test-F1 : 45.36, 
Val_Geo_Mean : 59.03 , test_geo: 58.54
New Best F1 Score at epoch 1 : 46.94

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 46.94 from EPOCH: 2,   Test-F1 : 45.36
----- time spent for training  : 31.198427438735962 -----
 time for train set report : 0.0 
eval time for val set : 1.7316219806671143 
epoch loss: 69.866, taining accuracy: 91.36, validation accuracy: 91.87, Val-F1-score: 44.92, Test-F1 : 44.78, 
Val_Geo_Mean : 56.30 , test_geo: 56.84

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 46.94 from EPOCH: 2,   Test-F1 : 45.36
----- time spent for training  : 30.106218338012695 -----
 time for train set report : 0.0 
eval time for val set : 1.7427430152893066 
epoch loss: 67.908, taining accuracy: 91.28, validation accuracy: 91.05, Val-F1-score: 46.48, Test-F1 : 48.14, 
Val_Geo_Mean : 60.50 , test_geo: 61.76

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 46.94 from EPOCH: 2,   Test-F1 : 45.36
----- time spent for training  : 30.937621593475342 -----
 time for train set report : 0.0 
eval time for val set : 1.7465252876281738 
epoch loss: 65.488, taining accuracy: 91.54, validation accuracy: 91.33, Val-F1-score: 48.09, Test-F1 : 47.01, 
Val_Geo_Mean : 61.54 , test_geo: 60.54
New Best F1 Score at epoch 4 : 48.09

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 48.09 from EPOCH: 5,   Test-F1 : 47.01
----- time spent for training  : 30.22687268257141 -----
 time for train set report : 0.0 
eval time for val set : 1.7409031391143799 
epoch loss: 63.394, taining accuracy: 91.76, validation accuracy: 91.52, Val-F1-score: 50.56, Test-F1 : 47.36, 
Val_Geo_Mean : 63.88 , test_geo: 61.24
New Best F1 Score at epoch 5 : 50.56

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 50.56 from EPOCH: 6,   Test-F1 : 47.36
----- time spent for training  : 30.655381202697754 -----
 time for train set report : 0.0 
eval time for val set : 2.035944938659668 
epoch loss: 61.409, taining accuracy: 92.12, validation accuracy: 91.36, Val-F1-score: 48.96, Test-F1 : 47.64, 
Val_Geo_Mean : 62.47 , test_geo: 61.27

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 50.56 from EPOCH: 6,   Test-F1 : 47.36
----- time spent for training  : 31.07304310798645 -----
 time for train set report : 0.0 
eval time for val set : 1.8033177852630615 
epoch loss: 58.305, taining accuracy: 92.78, validation accuracy: 91.68, Val-F1-score: 47.06, Test-F1 : 44.16, 
Val_Geo_Mean : 59.27 , test_geo: 56.53

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 50.56 from EPOCH: 6,   Test-F1 : 47.36
----- time spent for training  : 30.513500213623047 -----
 time for train set report : 0.0 
eval time for val set : 1.7411532402038574 
epoch loss: 56.166, taining accuracy: 92.90, validation accuracy: 91.52, Val-F1-score: 49.81, Test-F1 : 45.94, 
Val_Geo_Mean : 62.98 , test_geo: 59.97

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 50.56 from EPOCH: 6,   Test-F1 : 47.36
----- time spent for training  : 31.114306688308716 -----
 time for train set report : 0.0 
eval time for val set : 1.7239978313446045 
epoch loss: 52.343, taining accuracy: 93.53, validation accuracy: 91.49, Val-F1-score: 48.75, Test-F1 : 46.00, 
Val_Geo_Mean : 61.82 , test_geo: 59.75

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 50.56 from EPOCH: 6,   Test-F1 : 47.36
----- time spent for training  : 32.107696294784546 -----
 time for train set report : 0.0 
eval time for val set : 1.7295899391174316 
epoch loss: 49.599, taining accuracy: 93.86, validation accuracy: 90.79, Val-F1-score: 51.10, Test-F1 : 47.93, 
Val_Geo_Mean : 66.85 , test_geo: 63.83
New Best F1 Score at epoch 10 : 51.10

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.38820481300354 -----
 time for train set report : 0.0 
eval time for val set : 1.74562668800354 
epoch loss: 44.949, taining accuracy: 94.62, validation accuracy: 91.43, Val-F1-score: 50.09, Test-F1 : 43.53, 
Val_Geo_Mean : 63.63 , test_geo: 58.55

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.23284387588501 -----
 time for train set report : 0.0 
eval time for val set : 1.7255480289459229 
epoch loss: 41.319, taining accuracy: 94.96, validation accuracy: 90.89, Val-F1-score: 47.04, Test-F1 : 43.36, 
Val_Geo_Mean : 61.61 , test_geo: 58.53

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 29.727261304855347 -----
 time for train set report : 0.0 
eval time for val set : 1.8937902450561523 
epoch loss: 37.814, taining accuracy: 95.45, validation accuracy: 90.03, Val-F1-score: 49.43, Test-F1 : 44.17, 
Val_Geo_Mean : 66.96 , test_geo: 62.07

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 28.772263765335083 -----
 time for train set report : 0.0 
eval time for val set : 1.7301723957061768 
epoch loss: 33.835, taining accuracy: 96.06, validation accuracy: 89.90, Val-F1-score: 48.95, Test-F1 : 46.18, 
Val_Geo_Mean : 66.71 , test_geo: 63.58

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 30.967294692993164 -----
 time for train set report : 0.0 
eval time for val set : 1.7096707820892334 
epoch loss: 30.934, taining accuracy: 96.61, validation accuracy: 89.48, Val-F1-score: 46.25, Test-F1 : 44.17, 
Val_Geo_Mean : 64.44 , test_geo: 62.07

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.201695919036865 -----
 time for train set report : 0.0 
eval time for val set : 1.749422550201416 
epoch loss: 27.244, taining accuracy: 97.07, validation accuracy: 90.15, Val-F1-score: 46.63, Test-F1 : 45.30, 
Val_Geo_Mean : 63.16 , test_geo: 61.40

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.77540612220764 -----
 time for train set report : 0.0 
eval time for val set : 1.7538468837738037 
epoch loss: 23.997, taining accuracy: 97.24, validation accuracy: 89.77, Val-F1-score: 49.13, Test-F1 : 47.14, 
Val_Geo_Mean : 67.27 , test_geo: 65.10

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.962125539779663 -----
 time for train set report : 0.0 
eval time for val set : 1.7361974716186523 
epoch loss: 20.657, taining accuracy: 97.69, validation accuracy: 89.55, Val-F1-score: 47.10, Test-F1 : 44.72, 
Val_Geo_Mean : 65.31 , test_geo: 62.15

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.401935577392578 -----
 time for train set report : 0.0 
eval time for val set : 1.80220627784729 
epoch loss: 17.674, taining accuracy: 98.11, validation accuracy: 89.20, Val-F1-score: 46.61, Test-F1 : 43.37, 
Val_Geo_Mean : 65.60 , test_geo: 61.74

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 30.58275294303894 -----
 time for train set report : 0.0 
eval time for val set : 1.7369155883789062 
epoch loss: 15.302, taining accuracy: 98.44, validation accuracy: 89.67, Val-F1-score: 46.71, Test-F1 : 43.80, 
Val_Geo_Mean : 64.51 , test_geo: 60.56

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.087174654006958 -----
 time for train set report : 0.0 
eval time for val set : 1.7346410751342773 
epoch loss: 14.256, taining accuracy: 98.40, validation accuracy: 89.29, Val-F1-score: 45.45, Test-F1 : 43.08, 
Val_Geo_Mean : 63.93 , test_geo: 61.08

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 30.19903802871704 -----
 time for train set report : 0.0 
eval time for val set : 1.7265019416809082 
epoch loss: 11.515, taining accuracy: 98.68, validation accuracy: 88.43, Val-F1-score: 46.38, Test-F1 : 44.62, 
Val_Geo_Mean : 67.14 , test_geo: 64.88

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 30.98052716255188 -----
 time for train set report : 0.0 
eval time for val set : 1.765528678894043 
epoch loss: 9.812, taining accuracy: 99.00, validation accuracy: 88.50, Val-F1-score: 46.04, Test-F1 : 43.34, 
Val_Geo_Mean : 66.56 , test_geo: 63.52

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 30.099400281906128 -----
 time for train set report : 0.0 
eval time for val set : 1.718606948852539 
epoch loss: 7.857, taining accuracy: 99.19, validation accuracy: 88.27, Val-F1-score: 43.90, Test-F1 : 41.11, 
Val_Geo_Mean : 64.40 , test_geo: 61.38

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.042672395706177 -----
 time for train set report : 0.0 
eval time for val set : 1.7325468063354492 
epoch loss: 7.268, taining accuracy: 99.30, validation accuracy: 89.61, Val-F1-score: 45.85, Test-F1 : 41.39, 
Val_Geo_Mean : 63.62 , test_geo: 58.71

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.692370891571045 -----
 time for train set report : 0.0 
eval time for val set : 1.7435786724090576 
epoch loss: 5.624, taining accuracy: 99.47, validation accuracy: 88.88, Val-F1-score: 45.21, Test-F1 : 41.52, 
Val_Geo_Mean : 64.63 , test_geo: 60.22

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 32.098597049713135 -----
 time for train set report : 0.0 
eval time for val set : 1.7294647693634033 
epoch loss: 5.344, taining accuracy: 99.50, validation accuracy: 88.85, Val-F1-score: 44.09, Test-F1 : 43.74, 
Val_Geo_Mean : 63.33 , test_geo: 61.39

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.696192979812622 -----
 time for train set report : 0.0 
eval time for val set : 1.703991174697876 
epoch loss: 3.387, taining accuracy: 99.69, validation accuracy: 87.48, Val-F1-score: 43.29, Test-F1 : 42.19, 
Val_Geo_Mean : 65.34 , test_geo: 64.06

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 32.255377769470215 -----
 time for train set report : 0.0 
eval time for val set : 1.7337770462036133 
epoch loss: 6.212, taining accuracy: 99.36, validation accuracy: 89.01, Val-F1-score: 45.32, Test-F1 : 41.59, 
Val_Geo_Mean : 64.47 , test_geo: 60.23

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.705740451812744 -----
 time for train set report : 0.0 
eval time for val set : 1.7309436798095703 
epoch loss: 3.535, taining accuracy: 99.66, validation accuracy: 88.40, Val-F1-score: 41.85, Test-F1 : 41.62, 
Val_Geo_Mean : 61.62 , test_geo: 60.86

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.368613481521606 -----
 time for train set report : 0.0 
eval time for val set : 1.7344624996185303 
epoch loss: 3.843, taining accuracy: 99.58, validation accuracy: 88.72, Val-F1-score: 46.36, Test-F1 : 43.64, 
Val_Geo_Mean : 66.45 , test_geo: 62.99

******************** GRUD_GRU *************************************
--- EPOCH: 33 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 31.541386365890503 -----
 time for train set report : 0.0 
eval time for val set : 1.7557775974273682 
epoch loss: 4.160, taining accuracy: 99.58, validation accuracy: 87.76, Val-F1-score: 44.35, Test-F1 : 43.49, 
Val_Geo_Mean : 66.07 , test_geo: 63.93

******************** GRUD_GRU *************************************
--- EPOCH: 34 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 32.18013644218445 -----
 time for train set report : 0.0 
eval time for val set : 1.732804536819458 
epoch loss: 2.442, taining accuracy: 99.79, validation accuracy: 88.46, Val-F1-score: 43.44, Test-F1 : 39.38, 
Val_Geo_Mean : 63.41 , test_geo: 58.62

******************** GRUD_GRU *************************************
--- EPOCH: 35 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 30.02204418182373 -----
 time for train set report : 0.0 
eval time for val set : 1.7414638996124268 
epoch loss: 1.491, taining accuracy: 99.89, validation accuracy: 88.24, Val-F1-score: 44.84, Test-F1 : 43.79, 
Val_Geo_Mean : 65.64 , test_geo: 63.40

******************** GRUD_GRU *************************************
--- EPOCH: 36 --------------------------------- B-F1: 51.10 from EPOCH: 11,   Test-F1 : 47.93
----- time spent for training  : 32.06816291809082 -----
 time for train set report : 0.0 
eval time for val set : 1.7147178649902344 
epoch loss: 3.624, taining accuracy: 99.68, validation accuracy: 88.59, Val-F1-score: 44.24, Test-F1 : 38.11, 
Val_Geo_Mean : 64.10 , test_geo: 57.34
Early Stopping @ EPOCH:[35]
saving the models state...
Loaded model arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
 Model is  GRUD
{'epochs': 100, 'batch_size': 64, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 6, 'lr': 0.00040988788956434173, 'rnn_cell': 'GRU', 'input_key_size': 128, 'input_value_size': 32, 'input_query_size': 128, 'num_input_heads': 1, 'input_dropout': 0.29195140750233467, 'comm_key_size': 128, 'comm_value_size': 104, 'comm_query_size': 128, 'num_comm_heads': 1, 'comm_dropout': 0.1110968730530028, 'active_rims': 4, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 21.99521017074585 -----
 time for train set report : 0.0 
eval time for val set : 1.7366375923156738 
epoch loss: 66.971, taining accuracy: 89.95, validation accuracy: 90.22, Val-F1-score: 39.45, Test-F1 : 37.85, 
Val_Geo_Mean : 52.77 , test_geo: 50.81
New Best F1 Score at epoch 0 : 39.45

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 39.45 from EPOCH: 1,   Test-F1 : 37.85
----- time spent for training  : 21.2073814868927 -----
 time for train set report : 0.0 
eval time for val set : 1.6238296031951904 
epoch loss: 54.589, taining accuracy: 90.84, validation accuracy: 90.57, Val-F1-score: 42.41, Test-F1 : 42.53, 
Val_Geo_Mean : 55.12 , test_geo: 54.88
New Best F1 Score at epoch 1 : 42.41

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 42.41 from EPOCH: 2,   Test-F1 : 42.53
----- time spent for training  : 21.446153163909912 -----
 time for train set report : 0.0 
eval time for val set : 1.6588456630706787 
epoch loss: 52.557, taining accuracy: 91.20, validation accuracy: 90.89, Val-F1-score: 47.23, Test-F1 : 46.55, 
Val_Geo_Mean : 59.63 , test_geo: 58.82
New Best F1 Score at epoch 2 : 47.23

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 47.23 from EPOCH: 3,   Test-F1 : 46.55
----- time spent for training  : 21.568901777267456 -----
 time for train set report : 0.0 
eval time for val set : 1.65525484085083 
epoch loss: 50.517, taining accuracy: 91.50, validation accuracy: 91.08, Val-F1-score: 48.15, Test-F1 : 46.53, 
Val_Geo_Mean : 60.14 , test_geo: 58.03
New Best F1 Score at epoch 3 : 48.15

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 48.15 from EPOCH: 4,   Test-F1 : 46.53
----- time spent for training  : 21.709091186523438 -----
 time for train set report : 0.0 
eval time for val set : 1.6450779438018799 
epoch loss: 49.271, taining accuracy: 91.77, validation accuracy: 91.17, Val-F1-score: 50.27, Test-F1 : 48.14, 
Val_Geo_Mean : 62.33 , test_geo: 60.55
New Best F1 Score at epoch 4 : 50.27

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 50.27 from EPOCH: 5,   Test-F1 : 48.14
----- time spent for training  : 21.220978260040283 -----
 time for train set report : 0.0 
eval time for val set : 1.625748634338379 
epoch loss: 47.883, taining accuracy: 91.81, validation accuracy: 91.24, Val-F1-score: 52.50, Test-F1 : 48.42, 
Val_Geo_Mean : 64.82 , test_geo: 60.96
New Best F1 Score at epoch 5 : 52.50

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 52.50 from EPOCH: 6,   Test-F1 : 48.42
----- time spent for training  : 21.8652024269104 -----
 time for train set report : 0.0 
eval time for val set : 1.6672155857086182 
epoch loss: 46.413, taining accuracy: 92.17, validation accuracy: 90.89, Val-F1-score: 51.53, Test-F1 : 49.57, 
Val_Geo_Mean : 64.69 , test_geo: 62.03

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 52.50 from EPOCH: 6,   Test-F1 : 48.42
----- time spent for training  : 21.703341007232666 -----
 time for train set report : 0.0 
eval time for val set : 1.6947438716888428 
epoch loss: 45.450, taining accuracy: 92.30, validation accuracy: 91.20, Val-F1-score: 46.72, Test-F1 : 44.15, 
Val_Geo_Mean : 58.15 , test_geo: 55.91

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 52.50 from EPOCH: 6,   Test-F1 : 48.42
----- time spent for training  : 22.029284715652466 -----
 time for train set report : 0.0 
eval time for val set : 1.8298859596252441 
epoch loss: 43.802, taining accuracy: 92.66, validation accuracy: 91.20, Val-F1-score: 51.41, Test-F1 : 49.91, 
Val_Geo_Mean : 63.59 , test_geo: 62.08

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 52.50 from EPOCH: 6,   Test-F1 : 48.42
----- time spent for training  : 21.64787459373474 -----
 time for train set report : 0.0 
eval time for val set : 1.652144432067871 
epoch loss: 42.529, taining accuracy: 92.91, validation accuracy: 90.98, Val-F1-score: 53.53, Test-F1 : 53.07, 
Val_Geo_Mean : 66.89 , test_geo: 65.51
New Best F1 Score at epoch 9 : 53.53

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 53.53 from EPOCH: 10,   Test-F1 : 53.07
----- time spent for training  : 20.896570205688477 -----
 time for train set report : 0.0 
eval time for val set : 1.6560122966766357 
epoch loss: 40.817, taining accuracy: 93.08, validation accuracy: 90.89, Val-F1-score: 48.93, Test-F1 : 47.31, 
Val_Geo_Mean : 61.59 , test_geo: 59.69

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 53.53 from EPOCH: 10,   Test-F1 : 53.07
----- time spent for training  : 21.461695909500122 -----
 time for train set report : 0.0 
eval time for val set : 1.6632351875305176 
epoch loss: 38.625, taining accuracy: 93.60, validation accuracy: 91.24, Val-F1-score: 48.60, Test-F1 : 45.49, 
Val_Geo_Mean : 60.19 , test_geo: 57.30

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 53.53 from EPOCH: 10,   Test-F1 : 53.07
----- time spent for training  : 21.721537590026855 -----
 time for train set report : 0.0 
eval time for val set : 1.649986982345581 
epoch loss: 37.193, taining accuracy: 93.85, validation accuracy: 91.01, Val-F1-score: 52.68, Test-F1 : 49.18, 
Val_Geo_Mean : 65.73 , test_geo: 63.22

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 53.53 from EPOCH: 10,   Test-F1 : 53.07
----- time spent for training  : 21.15727186203003 -----
 time for train set report : 0.0 
eval time for val set : 1.6600525379180908 
epoch loss: 35.094, taining accuracy: 94.31, validation accuracy: 90.69, Val-F1-score: 53.80, Test-F1 : 53.12, 
Val_Geo_Mean : 68.11 , test_geo: 67.18
New Best F1 Score at epoch 13 : 53.80

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 53.80 from EPOCH: 14,   Test-F1 : 53.12
----- time spent for training  : 22.20430588722229 -----
 time for train set report : 0.0 
eval time for val set : 1.6709299087524414 
epoch loss: 33.281, taining accuracy: 94.56, validation accuracy: 90.73, Val-F1-score: 52.68, Test-F1 : 49.76, 
Val_Geo_Mean : 66.60 , test_geo: 64.34

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 53.80 from EPOCH: 14,   Test-F1 : 53.12
----- time spent for training  : 22.388389348983765 -----
 time for train set report : 0.0 
eval time for val set : 1.7047014236450195 
epoch loss: 30.951, taining accuracy: 94.98, validation accuracy: 89.90, Val-F1-score: 54.26, Test-F1 : 49.57, 
Val_Geo_Mean : 71.05 , test_geo: 67.23
New Best F1 Score at epoch 15 : 54.26

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 54.26 from EPOCH: 16,   Test-F1 : 49.57
----- time spent for training  : 22.30545449256897 -----
 time for train set report : 0.0 
eval time for val set : 1.7655541896820068 
epoch loss: 29.276, taining accuracy: 95.39, validation accuracy: 90.44, Val-F1-score: 48.98, Test-F1 : 47.49, 
Val_Geo_Mean : 62.90 , test_geo: 60.65

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 54.26 from EPOCH: 16,   Test-F1 : 49.57
----- time spent for training  : 21.01561212539673 -----
 time for train set report : 0.0 
eval time for val set : 1.5871517658233643 
epoch loss: 26.829, taining accuracy: 95.84, validation accuracy: 89.55, Val-F1-score: 52.19, Test-F1 : 51.01, 
Val_Geo_Mean : 69.30 , test_geo: 67.79

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 54.26 from EPOCH: 16,   Test-F1 : 49.57
----- time spent for training  : 20.299611806869507 -----
 time for train set report : 0.0 
eval time for val set : 1.6456117630004883 
epoch loss: 24.640, taining accuracy: 96.18, validation accuracy: 90.25, Val-F1-score: 52.48, Test-F1 : 50.78, 
Val_Geo_Mean : 67.74 , test_geo: 65.51

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 54.26 from EPOCH: 16,   Test-F1 : 49.57
----- time spent for training  : 20.539586067199707 -----
 time for train set report : 0.0 
eval time for val set : 1.613194227218628 
epoch loss: 23.056, taining accuracy: 96.48, validation accuracy: 90.79, Val-F1-score: 52.07, Test-F1 : 48.52, 
Val_Geo_Mean : 65.65 , test_geo: 62.78

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 54.26 from EPOCH: 16,   Test-F1 : 49.57
----- time spent for training  : 20.10265302658081 -----
 time for train set report : 0.0 
eval time for val set : 1.6946706771850586 
epoch loss: 20.952, taining accuracy: 96.69, validation accuracy: 89.52, Val-F1-score: 49.46, Test-F1 : 49.54, 
Val_Geo_Mean : 65.93 , test_geo: 65.31

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 54.26 from EPOCH: 16,   Test-F1 : 49.57
----- time spent for training  : 21.2895085811615 -----
 time for train set report : 0.0 
eval time for val set : 1.641092300415039 
epoch loss: 18.588, taining accuracy: 97.19, validation accuracy: 90.03, Val-F1-score: 52.07, Test-F1 : 47.71, 
Val_Geo_Mean : 67.84 , test_geo: 64.02

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 54.26 from EPOCH: 16,   Test-F1 : 49.57
----- time spent for training  : 23.176826000213623 -----
 time for train set report : 0.0 
eval time for val set : 1.5901257991790771 
epoch loss: 17.085, taining accuracy: 97.52, validation accuracy: 89.99, Val-F1-score: 54.62, Test-F1 : 50.67, 
Val_Geo_Mean : 71.26 , test_geo: 66.95
New Best F1 Score at epoch 22 : 54.62

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 23.443439960479736 -----
 time for train set report : 0.0 
eval time for val set : 1.7785189151763916 
epoch loss: 16.373, taining accuracy: 97.52, validation accuracy: 89.17, Val-F1-score: 51.70, Test-F1 : 47.86, 
Val_Geo_Mean : 69.68 , test_geo: 65.03

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 22.191224813461304 -----
 time for train set report : 0.0 
eval time for val set : 1.7233741283416748 
epoch loss: 14.197, taining accuracy: 97.94, validation accuracy: 89.90, Val-F1-score: 50.55, Test-F1 : 50.00, 
Val_Geo_Mean : 66.28 , test_geo: 65.05

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 22.709085702896118 -----
 time for train set report : 0.0 
eval time for val set : 1.738645076751709 
epoch loss: 12.019, taining accuracy: 98.29, validation accuracy: 89.39, Val-F1-score: 51.53, Test-F1 : 51.13, 
Val_Geo_Mean : 68.87 , test_geo: 66.87

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 22.673913717269897 -----
 time for train set report : 0.0 
eval time for val set : 1.7034130096435547 
epoch loss: 11.133, taining accuracy: 98.44, validation accuracy: 89.26, Val-F1-score: 51.09, Test-F1 : 52.25, 
Val_Geo_Mean : 68.64 , test_geo: 68.62

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 22.236605882644653 -----
 time for train set report : 0.0 
eval time for val set : 1.7324657440185547 
epoch loss: 9.920, taining accuracy: 98.70, validation accuracy: 88.85, Val-F1-score: 47.60, Test-F1 : 49.16, 
Val_Geo_Mean : 65.29 , test_geo: 65.08

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.828916549682617 -----
 time for train set report : 0.0 
eval time for val set : 1.7703773975372314 
epoch loss: 9.271, taining accuracy: 98.79, validation accuracy: 89.96, Val-F1-score: 49.11, Test-F1 : 47.78, 
Val_Geo_Mean : 64.34 , test_geo: 62.14

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.61308264732361 -----
 time for train set report : 0.0 
eval time for val set : 1.6994998455047607 
epoch loss: 7.602, taining accuracy: 98.97, validation accuracy: 88.56, Val-F1-score: 50.75, Test-F1 : 52.92, 
Val_Geo_Mean : 69.95 , test_geo: 70.25

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.470094680786133 -----
 time for train set report : 0.0 
eval time for val set : 1.7453739643096924 
epoch loss: 6.121, taining accuracy: 99.25, validation accuracy: 88.66, Val-F1-score: 49.14, Test-F1 : 49.19, 
Val_Geo_Mean : 67.66 , test_geo: 66.06

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.343973398208618 -----
 time for train set report : 0.0 
eval time for val set : 1.8882055282592773 
epoch loss: 6.122, taining accuracy: 99.27, validation accuracy: 88.72, Val-F1-score: 49.43, Test-F1 : 47.53, 
Val_Geo_Mean : 67.87 , test_geo: 64.48

******************** GRUD_GRU *************************************
--- EPOCH: 33 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.375768899917603 -----
 time for train set report : 0.0 
eval time for val set : 1.8404452800750732 
epoch loss: 6.050, taining accuracy: 99.30, validation accuracy: 88.46, Val-F1-score: 51.47, Test-F1 : 53.06, 
Val_Geo_Mean : 71.13 , test_geo: 70.42

******************** GRUD_GRU *************************************
--- EPOCH: 34 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.78296136856079 -----
 time for train set report : 0.0 
eval time for val set : 1.7130441665649414 
epoch loss: 5.689, taining accuracy: 99.30, validation accuracy: 89.13, Val-F1-score: 49.78, Test-F1 : 49.07, 
Val_Geo_Mean : 67.30 , test_geo: 64.57

******************** GRUD_GRU *************************************
--- EPOCH: 35 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.37762188911438 -----
 time for train set report : 0.0 
eval time for val set : 1.6875605583190918 
epoch loss: 3.814, taining accuracy: 99.57, validation accuracy: 89.20, Val-F1-score: 48.56, Test-F1 : 48.34, 
Val_Geo_Mean : 65.62 , test_geo: 63.61

******************** GRUD_GRU *************************************
--- EPOCH: 36 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.723235368728638 -----
 time for train set report : 0.0 
eval time for val set : 1.7017614841461182 
epoch loss: 3.407, taining accuracy: 99.60, validation accuracy: 88.91, Val-F1-score: 49.27, Test-F1 : 47.94, 
Val_Geo_Mean : 67.21 , test_geo: 64.22

******************** GRUD_GRU *************************************
--- EPOCH: 37 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.794363498687744 -----
 time for train set report : 0.0 
eval time for val set : 1.9259600639343262 
epoch loss: 3.814, taining accuracy: 99.46, validation accuracy: 88.27, Val-F1-score: 49.73, Test-F1 : 46.84, 
Val_Geo_Mean : 69.30 , test_geo: 65.63

******************** GRUD_GRU *************************************
--- EPOCH: 38 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 22.178849458694458 -----
 time for train set report : 0.0 
eval time for val set : 1.6841120719909668 
epoch loss: 3.425, taining accuracy: 99.55, validation accuracy: 89.32, Val-F1-score: 48.38, Test-F1 : 46.15, 
Val_Geo_Mean : 65.09 , test_geo: 62.75

******************** GRUD_GRU *************************************
--- EPOCH: 39 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.75003147125244 -----
 time for train set report : 0.0 
eval time for val set : 1.6815664768218994 
epoch loss: 2.631, taining accuracy: 99.68, validation accuracy: 89.29, Val-F1-score: 52.00, Test-F1 : 47.02, 
Val_Geo_Mean : 69.73 , test_geo: 64.88

******************** GRUD_GRU *************************************
--- EPOCH: 40 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.89186429977417 -----
 time for train set report : 0.0 
eval time for val set : 1.6481094360351562 
epoch loss: 3.885, taining accuracy: 99.41, validation accuracy: 87.83, Val-F1-score: 48.93, Test-F1 : 47.91, 
Val_Geo_Mean : 69.29 , test_geo: 67.51

******************** GRUD_GRU *************************************
--- EPOCH: 41 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.579108715057373 -----
 time for train set report : 0.0 
eval time for val set : 1.678023099899292 
epoch loss: 3.360, taining accuracy: 99.49, validation accuracy: 89.29, Val-F1-score: 49.24, Test-F1 : 49.02, 
Val_Geo_Mean : 66.23 , test_geo: 65.22

******************** GRUD_GRU *************************************
--- EPOCH: 42 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.90041947364807 -----
 time for train set report : 0.0 
eval time for val set : 1.6931312084197998 
epoch loss: 2.738, taining accuracy: 99.63, validation accuracy: 88.97, Val-F1-score: 48.66, Test-F1 : 50.53, 
Val_Geo_Mean : 66.29 , test_geo: 66.45

******************** GRUD_GRU *************************************
--- EPOCH: 43 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.907576084136963 -----
 time for train set report : 0.0 
eval time for val set : 1.7539381980895996 
epoch loss: 2.653, taining accuracy: 99.71, validation accuracy: 89.07, Val-F1-score: 48.88, Test-F1 : 51.96, 
Val_Geo_Mean : 66.33 , test_geo: 67.32

******************** GRUD_GRU *************************************
--- EPOCH: 44 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 22.515563249588013 -----
 time for train set report : 0.0 
eval time for val set : 1.7464189529418945 
epoch loss: 1.191, taining accuracy: 99.86, validation accuracy: 89.26, Val-F1-score: 49.78, Test-F1 : 50.00, 
Val_Geo_Mean : 66.97 , test_geo: 65.22

******************** GRUD_GRU *************************************
--- EPOCH: 45 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.221282720565796 -----
 time for train set report : 0.0 
eval time for val set : 1.6404314041137695 
epoch loss: 1.778, taining accuracy: 99.76, validation accuracy: 88.94, Val-F1-score: 49.05, Test-F1 : 49.40, 
Val_Geo_Mean : 66.85 , test_geo: 65.94

******************** GRUD_GRU *************************************
--- EPOCH: 46 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 20.29950189590454 -----
 time for train set report : 0.0 
eval time for val set : 1.6255834102630615 
epoch loss: 2.439, taining accuracy: 99.68, validation accuracy: 89.26, Val-F1-score: 49.63, Test-F1 : 48.30, 
Val_Geo_Mean : 66.79 , test_geo: 64.11

******************** GRUD_GRU *************************************
--- EPOCH: 47 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 21.276342153549194 -----
 time for train set report : 0.0 
eval time for val set : 1.633758544921875 
epoch loss: 1.767, taining accuracy: 99.80, validation accuracy: 88.85, Val-F1-score: 48.38, Test-F1 : 48.11, 
Val_Geo_Mean : 66.24 , test_geo: 64.58

******************** GRUD_GRU *************************************
--- EPOCH: 48 --------------------------------- B-F1: 54.62 from EPOCH: 23,   Test-F1 : 50.67
----- time spent for training  : 22.67352604866028 -----
 time for train set report : 0.0 
eval time for val set : 1.8192620277404785 
epoch loss: 2.156, taining accuracy: 99.67, validation accuracy: 89.26, Val-F1-score: 47.26, Test-F1 : 48.20, 
Val_Geo_Mean : 63.88 , test_geo: 62.55
Early Stopping @ EPOCH:[47]
saving the models state...
Loaded model arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
 Model is  GRUD
{'epochs': 100, 'batch_size': 48, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 2, 'lr': 0.0005150150079869629, 'rnn_cell': 'GRU', 'input_key_size': 32, 'input_value_size': 64, 'input_query_size': 32, 'num_input_heads': 1, 'input_dropout': 0.3132617223673041, 'comm_key_size': 64, 'comm_value_size': 104, 'comm_query_size': 64, 'num_comm_heads': 1, 'comm_dropout': 0.11522998409142918, 'active_rims': 2, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 28.926647901535034 -----
 time for train set report : 0.0 
eval time for val set : 2.1049861907958984 
epoch loss: 87.351, taining accuracy: 89.70, validation accuracy: 91.05, Val-F1-score: 36.57, Test-F1 : 37.12, 
Val_Geo_Mean : 49.66 , test_geo: 50.14
New Best F1 Score at epoch 0 : 36.57

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 36.57 from EPOCH: 1,   Test-F1 : 37.12
----- time spent for training  : 28.31461763381958 -----
 time for train set report : 0.0 
eval time for val set : 2.160651206970215 
epoch loss: 73.669, taining accuracy: 90.84, validation accuracy: 91.20, Val-F1-score: 47.33, Test-F1 : 45.36, 
Val_Geo_Mean : 61.02 , test_geo: 59.68
New Best F1 Score at epoch 1 : 47.33

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 47.33 from EPOCH: 2,   Test-F1 : 45.36
----- time spent for training  : 28.70328974723816 -----
 time for train set report : 0.0 
eval time for val set : 2.2217915058135986 
epoch loss: 70.434, taining accuracy: 91.15, validation accuracy: 91.87, Val-F1-score: 46.99, Test-F1 : 44.64, 
Val_Geo_Mean : 58.59 , test_geo: 57.06

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 47.33 from EPOCH: 2,   Test-F1 : 45.36
----- time spent for training  : 28.927016496658325 -----
 time for train set report : 0.0 
eval time for val set : 2.145037889480591 
epoch loss: 67.480, taining accuracy: 91.47, validation accuracy: 91.94, Val-F1-score: 49.09, Test-F1 : 47.01, 
Val_Geo_Mean : 60.80 , test_geo: 59.64
New Best F1 Score at epoch 3 : 49.09

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 49.09 from EPOCH: 4,   Test-F1 : 47.01
----- time spent for training  : 29.231900930404663 -----
 time for train set report : 0.0 
eval time for val set : 2.1693756580352783 
epoch loss: 65.153, taining accuracy: 91.60, validation accuracy: 91.71, Val-F1-score: 50.94, Test-F1 : 49.00, 
Val_Geo_Mean : 63.73 , test_geo: 61.64
New Best F1 Score at epoch 4 : 50.94

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 50.94 from EPOCH: 5,   Test-F1 : 49.00
----- time spent for training  : 28.703418254852295 -----
 time for train set report : 0.0 
eval time for val set : 2.1703383922576904 
epoch loss: 63.234, taining accuracy: 91.88, validation accuracy: 91.68, Val-F1-score: 49.12, Test-F1 : 46.34, 
Val_Geo_Mean : 61.66 , test_geo: 59.57

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 50.94 from EPOCH: 5,   Test-F1 : 49.00
----- time spent for training  : 28.45693039894104 -----
 time for train set report : 0.0 
eval time for val set : 2.1447091102600098 
epoch loss: 61.108, taining accuracy: 92.18, validation accuracy: 91.49, Val-F1-score: 52.06, Test-F1 : 51.04, 
Val_Geo_Mean : 65.84 , test_geo: 64.63
New Best F1 Score at epoch 6 : 52.06

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 52.06 from EPOCH: 7,   Test-F1 : 51.04
----- time spent for training  : 28.285502672195435 -----
 time for train set report : 0.0 
eval time for val set : 2.4194085597991943 
epoch loss: 58.662, taining accuracy: 92.70, validation accuracy: 91.71, Val-F1-score: 52.21, Test-F1 : 48.37, 
Val_Geo_Mean : 65.28 , test_geo: 62.43
New Best F1 Score at epoch 7 : 52.21

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 52.21 from EPOCH: 8,   Test-F1 : 48.37
----- time spent for training  : 28.345360040664673 -----
 time for train set report : 0.0 
eval time for val set : 2.3562605381011963 
epoch loss: 55.884, taining accuracy: 92.98, validation accuracy: 91.65, Val-F1-score: 53.55, Test-F1 : 48.97, 
Val_Geo_Mean : 67.18 , test_geo: 63.55
New Best F1 Score at epoch 8 : 53.55

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 53.55 from EPOCH: 9,   Test-F1 : 48.97
----- time spent for training  : 28.302425146102905 -----
 time for train set report : 0.0 
eval time for val set : 2.1759095191955566 
epoch loss: 52.864, taining accuracy: 93.30, validation accuracy: 91.78, Val-F1-score: 52.40, Test-F1 : 47.73, 
Val_Geo_Mean : 65.30 , test_geo: 61.28

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 53.55 from EPOCH: 9,   Test-F1 : 48.97
----- time spent for training  : 29.078699588775635 -----
 time for train set report : 0.0 
eval time for val set : 2.095630645751953 
epoch loss: 49.669, taining accuracy: 93.95, validation accuracy: 91.87, Val-F1-score: 54.05, Test-F1 : 44.66, 
Val_Geo_Mean : 67.05 , test_geo: 59.14
New Best F1 Score at epoch 10 : 54.05

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 29.172426462173462 -----
 time for train set report : 0.0 
eval time for val set : 2.2180280685424805 
epoch loss: 46.159, taining accuracy: 94.24, validation accuracy: 91.62, Val-F1-score: 52.61, Test-F1 : 48.39, 
Val_Geo_Mean : 66.11 , test_geo: 62.86

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 29.295417308807373 -----
 time for train set report : 0.0 
eval time for val set : 2.086421251296997 
epoch loss: 42.462, taining accuracy: 94.72, validation accuracy: 90.47, Val-F1-score: 53.21, Test-F1 : 48.42, 
Val_Geo_Mean : 70.54 , test_geo: 66.44

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 30.047931432724 -----
 time for train set report : 0.0 
eval time for val set : 2.1619203090667725 
epoch loss: 39.089, taining accuracy: 95.30, validation accuracy: 90.57, Val-F1-score: 53.31, Test-F1 : 47.41, 
Val_Geo_Mean : 70.39 , test_geo: 65.52

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 28.576056957244873 -----
 time for train set report : 0.0 
eval time for val set : 2.1183271408081055 
epoch loss: 35.564, taining accuracy: 95.86, validation accuracy: 91.11, Val-F1-score: 51.65, Test-F1 : 42.94, 
Val_Geo_Mean : 66.55 , test_geo: 59.15

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 29.00482702255249 -----
 time for train set report : 0.0 
eval time for val set : 2.2892682552337646 
epoch loss: 31.295, taining accuracy: 96.38, validation accuracy: 90.57, Val-F1-score: 50.67, Test-F1 : 46.01, 
Val_Geo_Mean : 66.97 , test_geo: 62.33

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 28.542667388916016 -----
 time for train set report : 0.0 
eval time for val set : 2.18877911567688 
epoch loss: 29.111, taining accuracy: 96.72, validation accuracy: 89.80, Val-F1-score: 50.00, Test-F1 : 45.69, 
Val_Geo_Mean : 68.30 , test_geo: 63.90

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 29.631437301635742 -----
 time for train set report : 0.0 
eval time for val set : 2.153630256652832 
epoch loss: 25.254, taining accuracy: 97.28, validation accuracy: 90.18, Val-F1-score: 52.32, Test-F1 : 48.30, 
Val_Geo_Mean : 70.23 , test_geo: 65.66

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 28.644034147262573 -----
 time for train set report : 0.0 
eval time for val set : 2.154155731201172 
epoch loss: 21.487, taining accuracy: 97.76, validation accuracy: 90.73, Val-F1-score: 49.21, Test-F1 : 43.45, 
Val_Geo_Mean : 64.69 , test_geo: 59.65

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 28.595112085342407 -----
 time for train set report : 0.0 
eval time for val set : 2.107398509979248 
epoch loss: 18.929, taining accuracy: 97.97, validation accuracy: 90.82, Val-F1-score: 52.48, Test-F1 : 47.97, 
Val_Geo_Mean : 68.50 , test_geo: 64.43

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 28.888519287109375 -----
 time for train set report : 0.0 
eval time for val set : 2.047549247741699 
epoch loss: 16.878, taining accuracy: 98.23, validation accuracy: 87.67, Val-F1-score: 48.47, Test-F1 : 46.58, 
Val_Geo_Mean : 71.61 , test_geo: 69.81

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 30.60162854194641 -----
 time for train set report : 0.0 
eval time for val set : 2.117976188659668 
epoch loss: 15.031, taining accuracy: 98.38, validation accuracy: 89.67, Val-F1-score: 49.06, Test-F1 : 46.29, 
Val_Geo_Mean : 67.44 , test_geo: 63.19

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 30.49835753440857 -----
 time for train set report : 0.0 
eval time for val set : 2.084782600402832 
epoch loss: 13.525, taining accuracy: 98.63, validation accuracy: 89.55, Val-F1-score: 51.04, Test-F1 : 46.61, 
Val_Geo_Mean : 70.35 , test_geo: 66.52

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 30.463497161865234 -----
 time for train set report : 0.0 
eval time for val set : 1.9495809078216553 
epoch loss: 10.032, taining accuracy: 99.08, validation accuracy: 90.31, Val-F1-score: 52.65, Test-F1 : 45.19, 
Val_Geo_Mean : 70.28 , test_geo: 63.63

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 28.366391897201538 -----
 time for train set report : 0.0 
eval time for val set : 2.0939555168151855 
epoch loss: 8.189, taining accuracy: 99.20, validation accuracy: 88.94, Val-F1-score: 48.44, Test-F1 : 43.71, 
Val_Geo_Mean : 68.54 , test_geo: 64.34

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 31.39082670211792 -----
 time for train set report : 0.0 
eval time for val set : 1.954714059829712 
epoch loss: 7.853, taining accuracy: 99.18, validation accuracy: 90.28, Val-F1-score: 51.66, Test-F1 : 47.02, 
Val_Geo_Mean : 69.09 , test_geo: 65.46

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 34.1990749835968 -----
 time for train set report : 0.0 
eval time for val set : 1.9653525352478027 
epoch loss: 7.207, taining accuracy: 99.24, validation accuracy: 89.67, Val-F1-score: 47.57, Test-F1 : 41.81, 
Val_Geo_Mean : 65.57 , test_geo: 60.27

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 34.12721562385559 -----
 time for train set report : 0.0 
eval time for val set : 2.0319371223449707 
epoch loss: 4.981, taining accuracy: 99.46, validation accuracy: 89.07, Val-F1-score: 48.88, Test-F1 : 45.22, 
Val_Geo_Mean : 68.79 , test_geo: 65.17

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 34.5152268409729 -----
 time for train set report : 0.0 
eval time for val set : 1.9679739475250244 
epoch loss: 5.056, taining accuracy: 99.47, validation accuracy: 89.10, Val-F1-score: 50.86, Test-F1 : 44.01, 
Val_Geo_Mean : 71.30 , test_geo: 65.87

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 34.23362612724304 -----
 time for train set report : 0.0 
eval time for val set : 1.9720661640167236 
epoch loss: 6.278, taining accuracy: 99.35, validation accuracy: 90.18, Val-F1-score: 51.57, Test-F1 : 46.90, 
Val_Geo_Mean : 69.25 , test_geo: 65.06

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 34.20920658111572 -----
 time for train set report : 0.0 
eval time for val set : 1.9219081401824951 
epoch loss: 4.016, taining accuracy: 99.60, validation accuracy: 89.55, Val-F1-score: 50.30, Test-F1 : 41.56, 
Val_Geo_Mean : 69.38 , test_geo: 61.85

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 33.75277805328369 -----
 time for train set report : 0.0 
eval time for val set : 1.9538934230804443 
epoch loss: 5.173, taining accuracy: 99.43, validation accuracy: 90.15, Val-F1-score: 50.24, Test-F1 : 43.64, 
Val_Geo_Mean : 67.63 , test_geo: 61.99

******************** GRUD_GRU *************************************
--- EPOCH: 33 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 33.762229204177856 -----
 time for train set report : 0.0 
eval time for val set : 1.9526293277740479 
epoch loss: 2.059, taining accuracy: 99.88, validation accuracy: 89.74, Val-F1-score: 50.31, Test-F1 : 43.32, 
Val_Geo_Mean : 68.87 , test_geo: 63.13

******************** GRUD_GRU *************************************
--- EPOCH: 34 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 33.42539715766907 -----
 time for train set report : 0.0 
eval time for val set : 1.9572391510009766 
epoch loss: 2.954, taining accuracy: 99.71, validation accuracy: 91.11, Val-F1-score: 50.09, Test-F1 : 44.74, 
Val_Geo_Mean : 64.62 , test_geo: 60.04

******************** GRUD_GRU *************************************
--- EPOCH: 35 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 33.95254445075989 -----
 time for train set report : 0.0 
eval time for val set : 1.9498724937438965 
epoch loss: 5.140, taining accuracy: 99.43, validation accuracy: 90.15, Val-F1-score: 50.24, Test-F1 : 45.39, 
Val_Geo_Mean : 67.63 , test_geo: 63.46

******************** GRUD_GRU *************************************
--- EPOCH: 36 --------------------------------- B-F1: 54.05 from EPOCH: 11,   Test-F1 : 44.66
----- time spent for training  : 34.30702996253967 -----
 time for train set report : 0.0 
eval time for val set : 1.9968583583831787 
epoch loss: 2.429, taining accuracy: 99.77, validation accuracy: 90.34, Val-F1-score: 50.41, Test-F1 : 45.36, 
Val_Geo_Mean : 67.29 , test_geo: 62.24
Early Stopping @ EPOCH:[35]
saving the models state...
Loaded model arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
 Model is  GRUD
{'epochs': 100, 'batch_size': 32, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 3, 'lr': 0.0001954372067710742, 'rnn_cell': 'GRU', 'input_key_size': 32, 'input_value_size': 32, 'input_query_size': 32, 'num_input_heads': 1, 'input_dropout': 0.3335308294840652, 'comm_key_size': 64, 'comm_value_size': 104, 'comm_query_size': 64, 'num_comm_heads': 1, 'comm_dropout': 0.12389704851438069, 'active_rims': 2, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 49.90447115898132 -----
 time for train set report : 0.0 
eval time for val set : 2.795189619064331 
epoch loss: 141.700, taining accuracy: 88.41, validation accuracy: 90.34, Val-F1-score: 43.58, Test-F1 : 37.66, 
Val_Geo_Mean : 56.73 , test_geo: 52.39
New Best F1 Score at epoch 0 : 43.58

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 43.58 from EPOCH: 1,   Test-F1 : 37.66
----- time spent for training  : 50.06999325752258 -----
 time for train set report : 0.0 
eval time for val set : 2.7561585903167725 
epoch loss: 109.732, taining accuracy: 90.83, validation accuracy: 91.05, Val-F1-score: 45.86, Test-F1 : 38.28, 
Val_Geo_Mean : 57.43 , test_geo: 52.21
New Best F1 Score at epoch 1 : 45.86

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 45.86 from EPOCH: 2,   Test-F1 : 38.28
----- time spent for training  : 50.85378122329712 -----
 time for train set report : 0.0 
eval time for val set : 2.799463987350464 
epoch loss: 105.063, taining accuracy: 91.10, validation accuracy: 91.08, Val-F1-score: 46.15, Test-F1 : 40.84, 
Val_Geo_Mean : 57.67 , test_geo: 54.49
New Best F1 Score at epoch 2 : 46.15

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 46.15 from EPOCH: 3,   Test-F1 : 40.84
----- time spent for training  : 49.93673014640808 -----
 time for train set report : 0.0 
eval time for val set : 2.7846405506134033 
epoch loss: 101.764, taining accuracy: 91.30, validation accuracy: 91.05, Val-F1-score: 45.44, Test-F1 : 41.48, 
Val_Geo_Mean : 56.96 , test_geo: 54.07

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 46.15 from EPOCH: 3,   Test-F1 : 40.84
----- time spent for training  : 50.49011945724487 -----
 time for train set report : 0.0 
eval time for val set : 2.792038679122925 
epoch loss: 99.305, taining accuracy: 91.58, validation accuracy: 90.95, Val-F1-score: 50.00, Test-F1 : 45.26, 
Val_Geo_Mean : 62.43 , test_geo: 59.60
New Best F1 Score at epoch 4 : 50.00

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 50.00 from EPOCH: 5,   Test-F1 : 45.26
----- time spent for training  : 49.66839003562927 -----
 time for train set report : 0.0 
eval time for val set : 2.7555973529815674 
epoch loss: 96.861, taining accuracy: 91.66, validation accuracy: 91.11, Val-F1-score: 48.99, Test-F1 : 46.06, 
Val_Geo_Mean : 60.79 , test_geo: 59.70

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 50.00 from EPOCH: 5,   Test-F1 : 45.26
----- time spent for training  : 49.544981956481934 -----
 time for train set report : 0.0 
eval time for val set : 2.798109531402588 
epoch loss: 94.330, taining accuracy: 92.12, validation accuracy: 90.66, Val-F1-score: 49.91, Test-F1 : 46.15, 
Val_Geo_Mean : 63.15 , test_geo: 61.63

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 50.00 from EPOCH: 5,   Test-F1 : 45.26
----- time spent for training  : 50.423176765441895 -----
 time for train set report : 0.0 
eval time for val set : 2.748891830444336 
epoch loss: 92.348, taining accuracy: 92.24, validation accuracy: 91.01, Val-F1-score: 51.55, Test-F1 : 46.73, 
Val_Geo_Mean : 64.10 , test_geo: 61.49
New Best F1 Score at epoch 7 : 51.55

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 51.55 from EPOCH: 8,   Test-F1 : 46.73
----- time spent for training  : 49.492755651474 -----
 time for train set report : 0.0 
eval time for val set : 2.788780927658081 
epoch loss: 89.339, taining accuracy: 92.46, validation accuracy: 90.69, Val-F1-score: 51.97, Test-F1 : 47.65, 
Val_Geo_Mean : 65.57 , test_geo: 63.05
New Best F1 Score at epoch 8 : 51.97

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 51.97 from EPOCH: 9,   Test-F1 : 47.65
----- time spent for training  : 49.40276646614075 -----
 time for train set report : 0.0 
eval time for val set : 2.7638001441955566 
epoch loss: 86.723, taining accuracy: 92.77, validation accuracy: 90.95, Val-F1-score: 52.82, Test-F1 : 46.97, 
Val_Geo_Mean : 65.86 , test_geo: 62.15
New Best F1 Score at epoch 9 : 52.82

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 52.82 from EPOCH: 10,   Test-F1 : 46.97
----- time spent for training  : 49.95856046676636 -----
 time for train set report : 0.0 
eval time for val set : 2.797675371170044 
epoch loss: 84.359, taining accuracy: 92.87, validation accuracy: 91.30, Val-F1-score: 49.16, Test-F1 : 43.94, 
Val_Geo_Mean : 60.43 , test_geo: 57.21

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 52.82 from EPOCH: 10,   Test-F1 : 46.97
----- time spent for training  : 49.68955445289612 -----
 time for train set report : 0.0 
eval time for val set : 2.758409261703491 
epoch loss: 81.495, taining accuracy: 93.23, validation accuracy: 91.46, Val-F1-score: 52.31, Test-F1 : 45.74, 
Val_Geo_Mean : 63.65 , test_geo: 59.88

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 52.82 from EPOCH: 10,   Test-F1 : 46.97
----- time spent for training  : 49.59268593788147 -----
 time for train set report : 0.0 
eval time for val set : 2.8254966735839844 
epoch loss: 78.791, taining accuracy: 93.39, validation accuracy: 90.92, Val-F1-score: 51.94, Test-F1 : 45.71, 
Val_Geo_Mean : 64.86 , test_geo: 60.31

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 52.82 from EPOCH: 10,   Test-F1 : 46.97
----- time spent for training  : 49.16025757789612 -----
 time for train set report : 0.0 
eval time for val set : 2.7875173091888428 
epoch loss: 75.352, taining accuracy: 93.73, validation accuracy: 90.85, Val-F1-score: 54.37, Test-F1 : 46.42, 
Val_Geo_Mean : 68.11 , test_geo: 63.67
New Best F1 Score at epoch 13 : 54.37

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 48.48391246795654 -----
 time for train set report : 0.0 
eval time for val set : 2.820791721343994 
epoch loss: 72.590, taining accuracy: 93.99, validation accuracy: 90.41, Val-F1-score: 51.06, Test-F1 : 46.07, 
Val_Geo_Mean : 65.26 , test_geo: 61.61

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 49.70950198173523 -----
 time for train set report : 0.0 
eval time for val set : 2.782683849334717 
epoch loss: 69.279, taining accuracy: 94.22, validation accuracy: 89.87, Val-F1-score: 52.96, Test-F1 : 46.20, 
Val_Geo_Mean : 69.17 , test_geo: 64.41

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 50.43955421447754 -----
 time for train set report : 0.0 
eval time for val set : 2.7754242420196533 
epoch loss: 66.570, taining accuracy: 94.50, validation accuracy: 91.20, Val-F1-score: 51.24, Test-F1 : 44.36, 
Val_Geo_Mean : 63.15 , test_geo: 58.83

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 46.424771547317505 -----
 time for train set report : 0.0 
eval time for val set : 2.790592670440674 
epoch loss: 62.885, taining accuracy: 94.78, validation accuracy: 90.95, Val-F1-score: 47.79, Test-F1 : 43.23, 
Val_Geo_Mean : 59.87 , test_geo: 57.12

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 49.83630013465881 -----
 time for train set report : 0.0 
eval time for val set : 2.7882492542266846 
epoch loss: 60.920, taining accuracy: 95.00, validation accuracy: 90.31, Val-F1-score: 54.08, Test-F1 : 44.00, 
Val_Geo_Mean : 69.36 , test_geo: 62.52

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 50.4645459651947 -----
 time for train set report : 0.0 
eval time for val set : 2.772937059402466 
epoch loss: 57.240, taining accuracy: 95.39, validation accuracy: 89.96, Val-F1-score: 54.28, Test-F1 : 45.40, 
Val_Geo_Mean : 70.64 , test_geo: 64.84

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 50.144463539123535 -----
 time for train set report : 0.0 
eval time for val set : 2.79538893699646 
epoch loss: 53.994, taining accuracy: 95.74, validation accuracy: 90.57, Val-F1-score: 50.99, Test-F1 : 43.80, 
Val_Geo_Mean : 64.73 , test_geo: 60.05

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 49.461085081100464 -----
 time for train set report : 0.0 
eval time for val set : 2.8012454509735107 
epoch loss: 51.924, taining accuracy: 95.79, validation accuracy: 90.25, Val-F1-score: 50.16, Test-F1 : 42.45, 
Val_Geo_Mean : 64.61 , test_geo: 59.44

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 50.10280394554138 -----
 time for train set report : 0.0 
eval time for val set : 2.877089500427246 
epoch loss: 47.977, taining accuracy: 96.14, validation accuracy: 90.34, Val-F1-score: 53.02, Test-F1 : 43.27, 
Val_Geo_Mean : 67.90 , test_geo: 61.41

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 50.22670292854309 -----
 time for train set report : 0.0 
eval time for val set : 2.7765114307403564 
epoch loss: 45.497, taining accuracy: 96.27, validation accuracy: 89.55, Val-F1-score: 50.75, Test-F1 : 41.13, 
Val_Geo_Mean : 67.21 , test_geo: 60.47

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 48.93208909034729 -----
 time for train set report : 0.0 
eval time for val set : 2.7957420349121094 
epoch loss: 42.558, taining accuracy: 96.74, validation accuracy: 89.55, Val-F1-score: 47.27, Test-F1 : 41.58, 
Val_Geo_Mean : 62.95 , test_geo: 59.93

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 48.90373516082764 -----
 time for train set report : 0.0 
eval time for val set : 2.780898094177246 
epoch loss: 39.441, taining accuracy: 96.96, validation accuracy: 89.77, Val-F1-score: 51.44, Test-F1 : 42.50, 
Val_Geo_Mean : 67.49 , test_geo: 61.09

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 49.03217601776123 -----
 time for train set report : 0.0 
eval time for val set : 2.7944936752319336 
epoch loss: 37.809, taining accuracy: 97.07, validation accuracy: 89.58, Val-F1-score: 52.81, Test-F1 : 42.74, 
Val_Geo_Mean : 69.77 , test_geo: 62.69

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 49.61521816253662 -----
 time for train set report : 0.0 
eval time for val set : 2.841089963912964 
epoch loss: 34.109, taining accuracy: 97.34, validation accuracy: 90.38, Val-F1-score: 50.65, Test-F1 : 41.08, 
Val_Geo_Mean : 64.86 , test_geo: 58.39

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 49.038285970687866 -----
 time for train set report : 0.0 
eval time for val set : 2.829190969467163 
epoch loss: 31.770, taining accuracy: 97.58, validation accuracy: 89.45, Val-F1-score: 48.04, Test-F1 : 40.07, 
Val_Geo_Mean : 64.11 , test_geo: 58.03

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 50.29371500015259 -----
 time for train set report : 0.0 
eval time for val set : 2.774808406829834 
epoch loss: 30.350, taining accuracy: 97.67, validation accuracy: 89.23, Val-F1-score: 50.58, Test-F1 : 40.20, 
Val_Geo_Mean : 67.82 , test_geo: 59.91

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 240.5453052520752 -----
 time for train set report : 0.0 
eval time for val set : 4.27292537689209 
epoch loss: 26.194, taining accuracy: 98.12, validation accuracy: 89.80, Val-F1-score: 52.52, Test-F1 : 44.34, 
Val_Geo_Mean : 68.79 , test_geo: 63.53

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 45.76351857185364 -----
 time for train set report : 0.0 
eval time for val set : 2.765810012817383 
epoch loss: 25.288, taining accuracy: 98.07, validation accuracy: 89.45, Val-F1-score: 49.47, Test-F1 : 44.78, 
Val_Geo_Mean : 65.86 , test_geo: 63.22

******************** GRUD_GRU *************************************
--- EPOCH: 33 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 47.46849989891052 -----
 time for train set report : 0.0 
eval time for val set : 2.813213348388672 
epoch loss: 21.486, taining accuracy: 98.54, validation accuracy: 89.17, Val-F1-score: 49.10, Test-F1 : 43.79, 
Val_Geo_Mean : 66.12 , test_geo: 62.87

******************** GRUD_GRU *************************************
--- EPOCH: 34 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 47.577308893203735 -----
 time for train set report : 0.0 
eval time for val set : 2.7857959270477295 
epoch loss: 22.350, taining accuracy: 98.33, validation accuracy: 88.53, Val-F1-score: 47.67, Test-F1 : 41.21, 
Val_Geo_Mean : 65.87 , test_geo: 61.47

******************** GRUD_GRU *************************************
--- EPOCH: 35 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 47.18441700935364 -----
 time for train set report : 0.0 
eval time for val set : 2.8259520530700684 
epoch loss: 17.822, taining accuracy: 98.80, validation accuracy: 89.29, Val-F1-score: 49.09, Test-F1 : 43.77, 
Val_Geo_Mean : 65.79 , test_geo: 62.09

******************** GRUD_GRU *************************************
--- EPOCH: 36 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 46.9265673160553 -----
 time for train set report : 0.0 
eval time for val set : 2.817014694213867 
epoch loss: 18.629, taining accuracy: 98.65, validation accuracy: 87.51, Val-F1-score: 49.61, Test-F1 : 42.78, 
Val_Geo_Mean : 70.62 , test_geo: 66.28

******************** GRUD_GRU *************************************
--- EPOCH: 37 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 47.60982012748718 -----
 time for train set report : 0.0 
eval time for val set : 2.780895233154297 
epoch loss: 17.808, taining accuracy: 98.69, validation accuracy: 88.59, Val-F1-score: 48.56, Test-F1 : 38.89, 
Val_Geo_Mean : 66.83 , test_geo: 59.08

******************** GRUD_GRU *************************************
--- EPOCH: 38 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 47.61716365814209 -----
 time for train set report : 0.0 
eval time for val set : 2.802431106567383 
epoch loss: 14.400, taining accuracy: 98.99, validation accuracy: 88.75, Val-F1-score: 48.32, Test-F1 : 41.95, 
Val_Geo_Mean : 66.15 , test_geo: 61.59

******************** GRUD_GRU *************************************
--- EPOCH: 39 --------------------------------- B-F1: 54.37 from EPOCH: 14,   Test-F1 : 46.42
----- time spent for training  : 47.952898263931274 -----
 time for train set report : 0.0 
eval time for val set : 2.8339548110961914 
epoch loss: 12.676, taining accuracy: 99.26, validation accuracy: 88.69, Val-F1-score: 48.33, Test-F1 : 42.48, 
Val_Geo_Mean : 66.31 , test_geo: 61.88
Early Stopping @ EPOCH:[38]
saving the models state...
Loaded model arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
 Model is  GRUD
{'epochs': 100, 'batch_size': 80, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 2, 'lr': 0.000990440027499615, 'rnn_cell': 'GRU', 'input_key_size': 64, 'input_value_size': 128, 'input_query_size': 64, 'num_input_heads': 2, 'input_dropout': 0.38540806772408037, 'comm_key_size': 128, 'comm_value_size': 104, 'comm_query_size': 128, 'num_comm_heads': 2, 'comm_dropout': 0.13534626507081635, 'active_rims': 2, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 19.71527338027954 -----
 time for train set report : 0.0 
eval time for val set : 1.311203956604004 
epoch loss: 51.712, taining accuracy: 89.74, validation accuracy: 90.66, Val-F1-score: 40.33, Test-F1 : 35.07, 
Val_Geo_Mean : 52.65 , test_geo: 48.53
New Best F1 Score at epoch 0 : 40.33

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 40.33 from EPOCH: 1,   Test-F1 : 35.07
----- time spent for training  : 19.96230721473694 -----
 time for train set report : 0.0 
eval time for val set : 1.2819838523864746 
epoch loss: 43.186, taining accuracy: 91.07, validation accuracy: 90.89, Val-F1-score: 46.44, Test-F1 : 43.14, 
Val_Geo_Mean : 58.73 , test_geo: 56.01
New Best F1 Score at epoch 1 : 46.44

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 46.44 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 19.94852566719055 -----
 time for train set report : 0.0 
eval time for val set : 1.3551864624023438 
epoch loss: 40.945, taining accuracy: 91.48, validation accuracy: 90.95, Val-F1-score: 43.87, Test-F1 : 41.16, 
Val_Geo_Mean : 55.72 , test_geo: 54.04

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 46.44 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 19.698477506637573 -----
 time for train set report : 0.0 
eval time for val set : 1.2934508323669434 
epoch loss: 39.316, taining accuracy: 91.64, validation accuracy: 90.82, Val-F1-score: 44.83, Test-F1 : 43.97, 
Val_Geo_Mean : 57.10 , test_geo: 56.83

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 46.44 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 18.653249979019165 -----
 time for train set report : 0.0 
eval time for val set : 1.3132500648498535 
epoch loss: 37.710, taining accuracy: 92.03, validation accuracy: 91.11, Val-F1-score: 43.18, Test-F1 : 38.00, 
Val_Geo_Mean : 54.55 , test_geo: 50.52

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 46.44 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 19.468718767166138 -----
 time for train set report : 0.0 
eval time for val set : 1.2858541011810303 
epoch loss: 35.584, taining accuracy: 92.35, validation accuracy: 90.79, Val-F1-score: 40.41, Test-F1 : 42.92, 
Val_Geo_Mean : 52.43 , test_geo: 54.73

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 46.44 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 19.75939655303955 -----
 time for train set report : 0.0 
eval time for val set : 1.295210361480713 
epoch loss: 33.685, taining accuracy: 92.92, validation accuracy: 90.79, Val-F1-score: 45.57, Test-F1 : 46.22, 
Val_Geo_Mean : 58.02 , test_geo: 59.67

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 46.44 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 19.348406076431274 -----
 time for train set report : 0.0 
eval time for val set : 1.3320903778076172 
epoch loss: 31.681, taining accuracy: 93.33, validation accuracy: 90.12, Val-F1-score: 46.18, Test-F1 : 51.25, 
Val_Geo_Mean : 60.46 , test_geo: 64.61

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 46.44 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 19.598106145858765 -----
 time for train set report : 0.0 
eval time for val set : 1.3283817768096924 
epoch loss: 29.051, taining accuracy: 93.88, validation accuracy: 89.93, Val-F1-score: 45.14, Test-F1 : 48.36, 
Val_Geo_Mean : 59.74 , test_geo: 62.57

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 46.44 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 18.843513011932373 -----
 time for train set report : 0.0 
eval time for val set : 1.3186705112457275 
epoch loss: 26.385, taining accuracy: 94.57, validation accuracy: 89.77, Val-F1-score: 45.13, Test-F1 : 51.12, 
Val_Geo_Mean : 60.12 , test_geo: 65.42

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 46.44 from EPOCH: 2,   Test-F1 : 43.14
----- time spent for training  : 19.732564210891724 -----
 time for train set report : 0.0 
eval time for val set : 1.32869553565979 
epoch loss: 23.020, taining accuracy: 95.39, validation accuracy: 89.45, Val-F1-score: 48.68, Test-F1 : 48.70, 
Val_Geo_Mean : 65.13 , test_geo: 65.90
New Best F1 Score at epoch 10 : 48.68

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.619346380233765 -----
 time for train set report : 0.0 
eval time for val set : 1.3131659030914307 
epoch loss: 20.383, taining accuracy: 95.88, validation accuracy: 89.17, Val-F1-score: 44.63, Test-F1 : 46.89, 
Val_Geo_Mean : 60.97 , test_geo: 63.02

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.65819478034973 -----
 time for train set report : 0.0 
eval time for val set : 1.3451197147369385 
epoch loss: 17.097, taining accuracy: 96.52, validation accuracy: 89.64, Val-F1-score: 44.44, Test-F1 : 44.96, 
Val_Geo_Mean : 59.64 , test_geo: 60.19

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.95606803894043 -----
 time for train set report : 0.0 
eval time for val set : 1.3012337684631348 
epoch loss: 14.884, taining accuracy: 96.96, validation accuracy: 89.36, Val-F1-score: 41.40, Test-F1 : 44.88, 
Val_Geo_Mean : 56.85 , test_geo: 59.73

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.776379585266113 -----
 time for train set report : 0.0 
eval time for val set : 1.3108994960784912 
epoch loss: 12.023, taining accuracy: 97.73, validation accuracy: 88.75, Val-F1-score: 43.88, Test-F1 : 45.24, 
Val_Geo_Mean : 61.03 , test_geo: 62.37

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.473072290420532 -----
 time for train set report : 0.0 
eval time for val set : 1.3413012027740479 
epoch loss: 9.969, taining accuracy: 98.14, validation accuracy: 89.39, Val-F1-score: 46.03, Test-F1 : 45.03, 
Val_Geo_Mean : 62.10 , test_geo: 61.07

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.171425342559814 -----
 time for train set report : 0.0 
eval time for val set : 1.2959885597229004 
epoch loss: 8.106, taining accuracy: 98.50, validation accuracy: 89.58, Val-F1-score: 44.48, Test-F1 : 45.86, 
Val_Geo_Mean : 59.83 , test_geo: 61.61

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.76794672012329 -----
 time for train set report : 0.0 
eval time for val set : 1.2811577320098877 
epoch loss: 6.016, taining accuracy: 98.98, validation accuracy: 89.17, Val-F1-score: 45.34, Test-F1 : 46.79, 
Val_Geo_Mean : 61.81 , test_geo: 63.62

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.97902011871338 -----
 time for train set report : 0.0 
eval time for val set : 1.2857201099395752 
epoch loss: 5.656, taining accuracy: 98.98, validation accuracy: 88.91, Val-F1-score: 43.51, Test-F1 : 44.53, 
Val_Geo_Mean : 60.24 , test_geo: 61.01

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.676936149597168 -----
 time for train set report : 0.0 
eval time for val set : 1.3401226997375488 
epoch loss: 5.436, taining accuracy: 98.94, validation accuracy: 89.13, Val-F1-score: 45.44, Test-F1 : 46.18, 
Val_Geo_Mean : 62.00 , test_geo: 62.71

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.56449294090271 -----
 time for train set report : 0.0 
eval time for val set : 1.2918264865875244 
epoch loss: 2.868, taining accuracy: 99.58, validation accuracy: 89.58, Val-F1-score: 44.29, Test-F1 : 43.02, 
Val_Geo_Mean : 59.62 , test_geo: 59.49

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 19.482131242752075 -----
 time for train set report : 0.0 
eval time for val set : 1.325993299484253 
epoch loss: 2.774, taining accuracy: 99.58, validation accuracy: 89.36, Val-F1-score: 46.65, Test-F1 : 47.81, 
Val_Geo_Mean : 62.91 , test_geo: 63.76

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.333710193634033 -----
 time for train set report : 0.0 
eval time for val set : 1.2635900974273682 
epoch loss: 3.194, taining accuracy: 99.51, validation accuracy: 89.01, Val-F1-score: 46.18, Test-F1 : 48.79, 
Val_Geo_Mean : 63.18 , test_geo: 65.91

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.900547742843628 -----
 time for train set report : 0.0 
eval time for val set : 1.2949423789978027 
epoch loss: 2.578, taining accuracy: 99.53, validation accuracy: 89.32, Val-F1-score: 41.94, Test-F1 : 45.57, 
Val_Geo_Mean : 57.53 , test_geo: 61.36

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 21.100324392318726 -----
 time for train set report : 0.0 
eval time for val set : 1.3109238147735596 
epoch loss: 1.763, taining accuracy: 99.75, validation accuracy: 88.46, Val-F1-score: 44.14, Test-F1 : 46.28, 
Val_Geo_Mean : 61.96 , test_geo: 64.75

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.736348628997803 -----
 time for train set report : 0.0 
eval time for val set : 1.3267886638641357 
epoch loss: 2.034, taining accuracy: 99.71, validation accuracy: 89.32, Val-F1-score: 40.50, Test-F1 : 45.21, 
Val_Geo_Mean : 55.91 , test_geo: 60.66

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 21.206605911254883 -----
 time for train set report : 0.0 
eval time for val set : 1.2868890762329102 
epoch loss: 2.369, taining accuracy: 99.62, validation accuracy: 88.72, Val-F1-score: 45.37, Test-F1 : 46.66, 
Val_Geo_Mean : 62.87 , test_geo: 64.61

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.94666838645935 -----
 time for train set report : 0.0 
eval time for val set : 1.3189144134521484 
epoch loss: 2.981, taining accuracy: 99.49, validation accuracy: 88.75, Val-F1-score: 47.86, Test-F1 : 48.99, 
Val_Geo_Mean : 65.83 , test_geo: 69.12

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.655267000198364 -----
 time for train set report : 0.0 
eval time for val set : 1.2753305435180664 
epoch loss: 1.188, taining accuracy: 99.86, validation accuracy: 89.04, Val-F1-score: 46.08, Test-F1 : 47.97, 
Val_Geo_Mean : 62.99 , test_geo: 64.80

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 21.17942714691162 -----
 time for train set report : 0.0 
eval time for val set : 1.3141400814056396 
epoch loss: 0.509, taining accuracy: 99.95, validation accuracy: 89.01, Val-F1-score: 46.18, Test-F1 : 48.42, 
Val_Geo_Mean : 63.18 , test_geo: 65.27

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.588756322860718 -----
 time for train set report : 0.0 
eval time for val set : 1.3597254753112793 
epoch loss: 1.081, taining accuracy: 99.88, validation accuracy: 89.77, Val-F1-score: 47.63, Test-F1 : 47.02, 
Val_Geo_Mean : 63.06 , test_geo: 63.45

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.975263595581055 -----
 time for train set report : 0.0 
eval time for val set : 1.328904628753662 
epoch loss: 1.145, taining accuracy: 99.80, validation accuracy: 89.29, Val-F1-score: 47.83, Test-F1 : 45.42, 
Val_Geo_Mean : 64.48 , test_geo: 64.03

******************** GRUD_GRU *************************************
--- EPOCH: 33 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 21.14850354194641 -----
 time for train set report : 0.0 
eval time for val set : 1.2940127849578857 
epoch loss: 1.872, taining accuracy: 99.66, validation accuracy: 89.36, Val-F1-score: 47.48, Test-F1 : 46.37, 
Val_Geo_Mean : 63.91 , test_geo: 64.17

******************** GRUD_GRU *************************************
--- EPOCH: 34 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 21.000019788742065 -----
 time for train set report : 0.0 
eval time for val set : 1.312645435333252 
epoch loss: 3.099, taining accuracy: 99.39, validation accuracy: 89.32, Val-F1-score: 42.14, Test-F1 : 47.06, 
Val_Geo_Mean : 57.75 , test_geo: 63.04

******************** GRUD_GRU *************************************
--- EPOCH: 35 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.511679887771606 -----
 time for train set report : 0.0 
eval time for val set : 1.2873561382293701 
epoch loss: 1.447, taining accuracy: 99.78, validation accuracy: 89.77, Val-F1-score: 45.87, Test-F1 : 46.42, 
Val_Geo_Mean : 60.98 , test_geo: 61.90

******************** GRUD_GRU *************************************
--- EPOCH: 36 --------------------------------- B-F1: 48.68 from EPOCH: 11,   Test-F1 : 48.70
----- time spent for training  : 20.670020580291748 -----
 time for train set report : 0.0 
eval time for val set : 1.2903516292572021 
epoch loss: 1.077, taining accuracy: 99.88, validation accuracy: 89.67, Val-F1-score: 44.52, Test-F1 : 44.94, 
Val_Geo_Mean : 59.65 , test_geo: 61.06
Early Stopping @ EPOCH:[35]
saving the models state...
Loaded model arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
 Model is  GRUD
{'epochs': 100, 'batch_size': 64, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 5, 'lr': 0.0005909682582801707, 'rnn_cell': 'GRU', 'input_key_size': 64, 'input_value_size': 64, 'input_query_size': 64, 'num_input_heads': 1, 'input_dropout': 0.3162257966154954, 'comm_key_size': 128, 'comm_value_size': 104, 'comm_query_size': 128, 'num_comm_heads': 1, 'comm_dropout': 0.1497434747638965, 'active_rims': 3, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 25.21232509613037 -----
 time for train set report : 0.0 
eval time for val set : 1.547499656677246 
epoch loss: 66.143, taining accuracy: 89.39, validation accuracy: 90.06, Val-F1-score: 36.59, Test-F1 : 38.89, 
Val_Geo_Mean : 50.88 , test_geo: 53.54
New Best F1 Score at epoch 0 : 36.59

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 36.59 from EPOCH: 1,   Test-F1 : 38.89
----- time spent for training  : 25.306497812271118 -----
 time for train set report : 0.0 
eval time for val set : 1.5565953254699707 
epoch loss: 53.510, taining accuracy: 91.09, validation accuracy: 90.82, Val-F1-score: 35.43, Test-F1 : 37.00, 
Val_Geo_Mean : 47.97 , test_geo: 49.89

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 36.59 from EPOCH: 1,   Test-F1 : 38.89
----- time spent for training  : 24.795896291732788 -----
 time for train set report : 0.0 
eval time for val set : 1.565248966217041 
epoch loss: 50.780, taining accuracy: 91.53, validation accuracy: 90.89, Val-F1-score: 42.11, Test-F1 : 41.75, 
Val_Geo_Mean : 54.81 , test_geo: 55.50
New Best F1 Score at epoch 2 : 42.11

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 42.11 from EPOCH: 3,   Test-F1 : 41.75
----- time spent for training  : 25.407941818237305 -----
 time for train set report : 0.0 
eval time for val set : 1.553391933441162 
epoch loss: 49.056, taining accuracy: 91.75, validation accuracy: 90.89, Val-F1-score: 41.87, Test-F1 : 42.69, 
Val_Geo_Mean : 54.56 , test_geo: 56.29

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 42.11 from EPOCH: 3,   Test-F1 : 41.75
----- time spent for training  : 25.71630835533142 -----
 time for train set report : 0.0 
eval time for val set : 1.543623447418213 
epoch loss: 47.110, taining accuracy: 92.09, validation accuracy: 90.82, Val-F1-score: 44.19, Test-F1 : 46.53, 
Val_Geo_Mean : 57.26 , test_geo: 60.19
New Best F1 Score at epoch 4 : 44.19

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 44.19 from EPOCH: 5,   Test-F1 : 46.53
----- time spent for training  : 25.830458879470825 -----
 time for train set report : 0.0 
eval time for val set : 1.5499355792999268 
epoch loss: 45.801, taining accuracy: 92.36, validation accuracy: 90.38, Val-F1-score: 44.49, Test-F1 : 44.40, 
Val_Geo_Mean : 58.76 , test_geo: 59.70
New Best F1 Score at epoch 5 : 44.49

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 44.49 from EPOCH: 6,   Test-F1 : 44.40
----- time spent for training  : 24.65411067008972 -----
 time for train set report : 0.0 
eval time for val set : 1.5514330863952637 
epoch loss: 43.898, taining accuracy: 92.59, validation accuracy: 90.41, Val-F1-score: 46.35, Test-F1 : 46.37, 
Val_Geo_Mean : 60.82 , test_geo: 61.58
New Best F1 Score at epoch 6 : 46.35

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 24.90875768661499 -----
 time for train set report : 0.0 
eval time for val set : 1.5474872589111328 
epoch loss: 42.226, taining accuracy: 92.93, validation accuracy: 90.09, Val-F1-score: 44.17, Test-F1 : 47.36, 
Val_Geo_Mean : 59.13 , test_geo: 61.52

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 26.019487380981445 -----
 time for train set report : 0.0 
eval time for val set : 1.547753095626831 
epoch loss: 40.075, taining accuracy: 93.24, validation accuracy: 90.79, Val-F1-score: 43.66, Test-F1 : 46.53, 
Val_Geo_Mean : 56.77 , test_geo: 60.19

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.563911199569702 -----
 time for train set report : 0.0 
eval time for val set : 1.5430915355682373 
epoch loss: 37.987, taining accuracy: 93.63, validation accuracy: 90.41, Val-F1-score: 45.96, Test-F1 : 47.29, 
Val_Geo_Mean : 60.37 , test_geo: 62.49

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.646814107894897 -----
 time for train set report : 0.0 
eval time for val set : 1.5505132675170898 
epoch loss: 35.839, taining accuracy: 94.10, validation accuracy: 90.54, Val-F1-score: 42.77, Test-F1 : 44.57, 
Val_Geo_Mean : 56.44 , test_geo: 58.90

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.838953018188477 -----
 time for train set report : 0.0 
eval time for val set : 1.5389060974121094 
epoch loss: 32.908, taining accuracy: 94.62, validation accuracy: 89.61, Val-F1-score: 45.48, Test-F1 : 48.61, 
Val_Geo_Mean : 61.85 , test_geo: 65.31

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.530060052871704 -----
 time for train set report : 0.0 
eval time for val set : 1.5797944068908691 
epoch loss: 30.431, taining accuracy: 94.98, validation accuracy: 90.15, Val-F1-score: 42.03, Test-F1 : 43.87, 
Val_Geo_Mean : 56.56 , test_geo: 58.60

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.482393264770508 -----
 time for train set report : 0.0 
eval time for val set : 1.5784969329833984 
epoch loss: 27.507, taining accuracy: 95.73, validation accuracy: 89.42, Val-F1-score: 43.92, Test-F1 : 45.36, 
Val_Geo_Mean : 60.47 , test_geo: 61.63

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.801238775253296 -----
 time for train set report : 0.0 
eval time for val set : 1.5503168106079102 
epoch loss: 25.028, taining accuracy: 95.96, validation accuracy: 89.45, Val-F1-score: 42.83, Test-F1 : 45.26, 
Val_Geo_Mean : 59.14 , test_geo: 61.03

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.145724296569824 -----
 time for train set report : 0.0 
eval time for val set : 1.5403268337249756 
epoch loss: 22.210, taining accuracy: 96.57, validation accuracy: 88.85, Val-F1-score: 44.97, Test-F1 : 46.01, 
Val_Geo_Mean : 63.05 , test_geo: 64.53

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.388707399368286 -----
 time for train set report : 0.0 
eval time for val set : 1.575411081314087 
epoch loss: 19.181, taining accuracy: 96.97, validation accuracy: 88.53, Val-F1-score: 41.75, Test-F1 : 44.59, 
Val_Geo_Mean : 59.93 , test_geo: 62.65

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.744404077529907 -----
 time for train set report : 0.0 
eval time for val set : 1.6060514450073242 
epoch loss: 16.745, taining accuracy: 97.45, validation accuracy: 88.18, Val-F1-score: 42.66, Test-F1 : 46.30, 
Val_Geo_Mean : 61.75 , test_geo: 65.11

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.44031071662903 -----
 time for train set report : 0.0 
eval time for val set : 1.5604727268218994 
epoch loss: 14.938, taining accuracy: 97.76, validation accuracy: 88.62, Val-F1-score: 42.70, Test-F1 : 45.83, 
Val_Geo_Mean : 60.84 , test_geo: 63.78

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.29790234565735 -----
 time for train set report : 0.0 
eval time for val set : 1.5598630905151367 
epoch loss: 12.955, taining accuracy: 97.90, validation accuracy: 88.08, Val-F1-score: 44.67, Test-F1 : 47.13, 
Val_Geo_Mean : 64.40 , test_geo: 66.98

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.75228524208069 -----
 time for train set report : 0.0 
eval time for val set : 1.564734697341919 
epoch loss: 10.970, taining accuracy: 98.36, validation accuracy: 88.34, Val-F1-score: 44.38, Test-F1 : 47.78, 
Val_Geo_Mean : 63.48 , test_geo: 66.41

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.297852516174316 -----
 time for train set report : 0.0 
eval time for val set : 1.5498836040496826 
epoch loss: 9.474, taining accuracy: 98.71, validation accuracy: 88.78, Val-F1-score: 42.30, Test-F1 : 46.43, 
Val_Geo_Mean : 60.02 , test_geo: 63.32

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.526559352874756 -----
 time for train set report : 0.0 
eval time for val set : 1.5352351665496826 
epoch loss: 7.795, taining accuracy: 98.93, validation accuracy: 88.72, Val-F1-score: 43.27, Test-F1 : 45.74, 
Val_Geo_Mean : 61.31 , test_geo: 64.13

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.695388793945312 -----
 time for train set report : 0.0 
eval time for val set : 1.5654234886169434 
epoch loss: 5.996, taining accuracy: 99.13, validation accuracy: 88.43, Val-F1-score: 41.55, Test-F1 : 45.41, 
Val_Geo_Mean : 59.90 , test_geo: 63.34

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 26.035551071166992 -----
 time for train set report : 0.0 
eval time for val set : 1.5258140563964844 
epoch loss: 5.277, taining accuracy: 99.37, validation accuracy: 88.97, Val-F1-score: 42.90, Test-F1 : 45.51, 
Val_Geo_Mean : 60.31 , test_geo: 62.61

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 26.10461401939392 -----
 time for train set report : 0.0 
eval time for val set : 1.5419838428497314 
epoch loss: 6.063, taining accuracy: 99.11, validation accuracy: 88.94, Val-F1-score: 43.02, Test-F1 : 47.19, 
Val_Geo_Mean : 60.52 , test_geo: 63.99

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.991265535354614 -----
 time for train set report : 0.0 
eval time for val set : 1.5693366527557373 
epoch loss: 3.936, taining accuracy: 99.49, validation accuracy: 88.05, Val-F1-score: 42.22, Test-F1 : 45.60, 
Val_Geo_Mean : 61.50 , test_geo: 64.10

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.546138763427734 -----
 time for train set report : 0.0 
eval time for val set : 1.5514843463897705 
epoch loss: 2.950, taining accuracy: 99.68, validation accuracy: 88.40, Val-F1-score: 42.59, Test-F1 : 45.82, 
Val_Geo_Mean : 61.20 , test_geo: 64.68

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 24.85450053215027 -----
 time for train set report : 0.0 
eval time for val set : 1.5437216758728027 
epoch loss: 3.955, taining accuracy: 99.43, validation accuracy: 88.50, Val-F1-score: 43.68, Test-F1 : 44.34, 
Val_Geo_Mean : 62.30 , test_geo: 63.53

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.56659245491028 -----
 time for train set report : 0.0 
eval time for val set : 1.5514326095581055 
epoch loss: 3.655, taining accuracy: 99.54, validation accuracy: 88.97, Val-F1-score: 43.65, Test-F1 : 42.47, 
Val_Geo_Mean : 61.19 , test_geo: 61.55

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 25.538231134414673 -----
 time for train set report : 0.0 
eval time for val set : 1.5684289932250977 
epoch loss: 2.873, taining accuracy: 99.67, validation accuracy: 88.62, Val-F1-score: 44.48, Test-F1 : 46.27, 
Val_Geo_Mean : 62.97 , test_geo: 64.93

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 46.35 from EPOCH: 7,   Test-F1 : 46.37
----- time spent for training  : 426.34183144569397 -----
 time for train set report : 0.0 
eval time for val set : 1.5285303592681885 
epoch loss: 2.257, taining accuracy: 99.73, validation accuracy: 88.21, Val-F1-score: 40.89, Test-F1 : 44.12, 
Val_Geo_Mean : 59.60 , test_geo: 62.02
Early Stopping @ EPOCH:[31]
saving the models state...
Loaded model arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
 Model is  GRUD
{'epochs': 100, 'batch_size': 48, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 2, 'lr': 1.1622274158757721e-05, 'rnn_cell': 'GRU', 'input_key_size': 64, 'input_value_size': 32, 'input_query_size': 64, 'num_input_heads': 1, 'input_dropout': 0.28917895587479503, 'comm_key_size': 32, 'comm_value_size': 104, 'comm_query_size': 32, 'num_comm_heads': 1, 'comm_dropout': 0.13692960189530196, 'active_rims': 2, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
----- time spent for training  : 31.51760220527649 -----
 time for train set report : 0.0 
eval time for val set : 1.9417877197265625 
epoch loss: 204.262, taining accuracy: 62.45, validation accuracy: 85.47, Val-F1-score: 28.08, Test-F1 : 30.59, 
Val_Geo_Mean : 50.66 , test_geo: 52.99
New Best F1 Score at epoch 0 : 28.08

******************** GRUD_GRU *************************************
--- EPOCH: 2 --------------------------------- B-F1: 28.08 from EPOCH: 1,   Test-F1 : 30.59
----- time spent for training  : 33.32267189025879 -----
 time for train set report : 0.0 
eval time for val set : 1.9579837322235107 
epoch loss: 164.163, taining accuracy: 87.96, validation accuracy: 89.48, Val-F1-score: 24.31, Test-F1 : 28.87, 
Val_Geo_Mean : 40.30 , test_geo: 44.55

******************** GRUD_GRU *************************************
--- EPOCH: 3 --------------------------------- B-F1: 28.08 from EPOCH: 1,   Test-F1 : 30.59
----- time spent for training  : 32.85795044898987 -----
 time for train set report : 0.0 
eval time for val set : 1.9699974060058594 
epoch loss: 123.067, taining accuracy: 89.18, validation accuracy: 90.06, Val-F1-score: 22.77, Test-F1 : 26.29, 
Val_Geo_Mean : 37.71 , test_geo: 40.42

******************** GRUD_GRU *************************************
--- EPOCH: 4 --------------------------------- B-F1: 28.08 from EPOCH: 1,   Test-F1 : 30.59
----- time spent for training  : 33.22421383857727 -----
 time for train set report : 0.0 
eval time for val set : 1.9338858127593994 
epoch loss: 95.577, taining accuracy: 89.39, validation accuracy: 90.34, Val-F1-score: 22.90, Test-F1 : 23.24, 
Val_Geo_Mean : 37.37 , test_geo: 37.45

******************** GRUD_GRU *************************************
--- EPOCH: 5 --------------------------------- B-F1: 28.08 from EPOCH: 1,   Test-F1 : 30.59
----- time spent for training  : 31.968756675720215 -----
 time for train set report : 0.0 
eval time for val set : 1.9467990398406982 
epoch loss: 89.228, taining accuracy: 89.62, validation accuracy: 90.47, Val-F1-score: 24.30, Test-F1 : 23.30, 
Val_Geo_Mean : 38.60 , test_geo: 37.46

******************** GRUD_GRU *************************************
--- EPOCH: 6 --------------------------------- B-F1: 28.08 from EPOCH: 1,   Test-F1 : 30.59
----- time spent for training  : 33.374571084976196 -----
 time for train set report : 0.0 
eval time for val set : 1.9641249179840088 
epoch loss: 86.094, taining accuracy: 89.77, validation accuracy: 90.44, Val-F1-score: 25.00, Test-F1 : 25.00, 
Val_Geo_Mean : 39.37 , test_geo: 38.99

******************** GRUD_GRU *************************************
--- EPOCH: 7 --------------------------------- B-F1: 28.08 from EPOCH: 1,   Test-F1 : 30.59
----- time spent for training  : 32.85691523551941 -----
 time for train set report : 0.0 
eval time for val set : 1.9910328388214111 
epoch loss: 83.923, taining accuracy: 89.92, validation accuracy: 90.41, Val-F1-score: 25.68, Test-F1 : 28.64, 
Val_Geo_Mean : 40.13 , test_geo: 42.22

******************** GRUD_GRU *************************************
--- EPOCH: 8 --------------------------------- B-F1: 28.08 from EPOCH: 1,   Test-F1 : 30.59
----- time spent for training  : 32.06467032432556 -----
 time for train set report : 0.0 
eval time for val set : 1.9713830947875977 
epoch loss: 81.884, taining accuracy: 90.00, validation accuracy: 90.47, Val-F1-score: 27.25, Test-F1 : 30.02, 
Val_Geo_Mean : 41.63 , test_geo: 43.56

******************** GRUD_GRU *************************************
--- EPOCH: 9 --------------------------------- B-F1: 28.08 from EPOCH: 1,   Test-F1 : 30.59
----- time spent for training  : 32.833590030670166 -----
 time for train set report : 0.0 
eval time for val set : 1.9801530838012695 
epoch loss: 80.157, taining accuracy: 90.20, validation accuracy: 90.31, Val-F1-score: 28.30, Test-F1 : 32.51, 
Val_Geo_Mean : 43.02 , test_geo: 45.82
New Best F1 Score at epoch 8 : 28.30

******************** GRUD_GRU *************************************
--- EPOCH: 10 --------------------------------- B-F1: 28.30 from EPOCH: 9,   Test-F1 : 32.51
----- time spent for training  : 33.036839723587036 -----
 time for train set report : 0.0 
eval time for val set : 1.945636510848999 
epoch loss: 78.681, taining accuracy: 90.31, validation accuracy: 90.25, Val-F1-score: 28.84, Test-F1 : 34.44, 
Val_Geo_Mean : 43.70 , test_geo: 47.66
New Best F1 Score at epoch 9 : 28.84

******************** GRUD_GRU *************************************
--- EPOCH: 11 --------------------------------- B-F1: 28.84 from EPOCH: 10,   Test-F1 : 34.44
----- time spent for training  : 32.93000102043152 -----
 time for train set report : 0.0 
eval time for val set : 1.9427711963653564 
epoch loss: 77.607, taining accuracy: 90.33, validation accuracy: 90.34, Val-F1-score: 30.66, Test-F1 : 36.21, 
Val_Geo_Mean : 45.41 , test_geo: 49.41
New Best F1 Score at epoch 10 : 30.66

******************** GRUD_GRU *************************************
--- EPOCH: 12 --------------------------------- B-F1: 30.66 from EPOCH: 11,   Test-F1 : 36.21
----- time spent for training  : 32.886775732040405 -----
 time for train set report : 0.0 
eval time for val set : 1.948751449584961 
epoch loss: 76.686, taining accuracy: 90.46, validation accuracy: 90.38, Val-F1-score: 30.73, Test-F1 : 37.34, 
Val_Geo_Mean : 45.42 , test_geo: 50.30
New Best F1 Score at epoch 11 : 30.73

******************** GRUD_GRU *************************************
--- EPOCH: 13 --------------------------------- B-F1: 30.73 from EPOCH: 12,   Test-F1 : 37.34
----- time spent for training  : 33.114811182022095 -----
 time for train set report : 0.0 
eval time for val set : 1.9873907566070557 
epoch loss: 75.920, taining accuracy: 90.53, validation accuracy: 90.28, Val-F1-score: 30.52, Test-F1 : 37.53, 
Val_Geo_Mean : 45.40 , test_geo: 50.57

******************** GRUD_GRU *************************************
--- EPOCH: 14 --------------------------------- B-F1: 30.73 from EPOCH: 12,   Test-F1 : 37.34
----- time spent for training  : 32.766934871673584 -----
 time for train set report : 0.0 
eval time for val set : 1.9431862831115723 
epoch loss: 75.135, taining accuracy: 90.62, validation accuracy: 90.44, Val-F1-score: 32.43, Test-F1 : 37.89, 
Val_Geo_Mean : 47.06 , test_geo: 51.10
New Best F1 Score at epoch 13 : 32.43

******************** GRUD_GRU *************************************
--- EPOCH: 15 --------------------------------- B-F1: 32.43 from EPOCH: 14,   Test-F1 : 37.89
----- time spent for training  : 33.18440318107605 -----
 time for train set report : 0.0 
eval time for val set : 1.9651334285736084 
epoch loss: 75.130, taining accuracy: 90.72, validation accuracy: 90.54, Val-F1-score: 33.85, Test-F1 : 37.74, 
Val_Geo_Mean : 48.34 , test_geo: 51.08
New Best F1 Score at epoch 14 : 33.85

******************** GRUD_GRU *************************************
--- EPOCH: 16 --------------------------------- B-F1: 33.85 from EPOCH: 15,   Test-F1 : 37.74
----- time spent for training  : 32.41944456100464 -----
 time for train set report : 0.0 
eval time for val set : 1.9642910957336426 
epoch loss: 74.108, taining accuracy: 90.78, validation accuracy: 90.60, Val-F1-score: 34.59, Test-F1 : 37.82, 
Val_Geo_Mean : 48.97 , test_geo: 51.09
New Best F1 Score at epoch 15 : 34.59

******************** GRUD_GRU *************************************
--- EPOCH: 17 --------------------------------- B-F1: 34.59 from EPOCH: 16,   Test-F1 : 37.82
----- time spent for training  : 33.20875287055969 -----
 time for train set report : 0.0 
eval time for val set : 1.9815552234649658 
epoch loss: 73.682, taining accuracy: 90.79, validation accuracy: 90.69, Val-F1-score: 35.68, Test-F1 : 38.49, 
Val_Geo_Mean : 49.91 , test_geo: 51.66
New Best F1 Score at epoch 16 : 35.68

******************** GRUD_GRU *************************************
--- EPOCH: 18 --------------------------------- B-F1: 35.68 from EPOCH: 17,   Test-F1 : 38.49
----- time spent for training  : 33.68929076194763 -----
 time for train set report : 0.0 
eval time for val set : 1.9755873680114746 
epoch loss: 73.204, taining accuracy: 90.84, validation accuracy: 90.76, Val-F1-score: 35.56, Test-F1 : 38.41, 
Val_Geo_Mean : 49.62 , test_geo: 51.65

******************** GRUD_GRU *************************************
--- EPOCH: 19 --------------------------------- B-F1: 35.68 from EPOCH: 17,   Test-F1 : 38.49
----- time spent for training  : 33.50526261329651 -----
 time for train set report : 0.0 
eval time for val set : 1.9805331230163574 
epoch loss: 72.897, taining accuracy: 90.82, validation accuracy: 90.89, Val-F1-score: 37.00, Test-F1 : 38.16, 
Val_Geo_Mean : 50.85 , test_geo: 51.37
New Best F1 Score at epoch 18 : 37.00

******************** GRUD_GRU *************************************
--- EPOCH: 20 --------------------------------- B-F1: 37.00 from EPOCH: 19,   Test-F1 : 38.16
----- time spent for training  : 33.232120752334595 -----
 time for train set report : 0.0 
eval time for val set : 1.9992458820343018 
epoch loss: 72.949, taining accuracy: 90.86, validation accuracy: 90.82, Val-F1-score: 36.56, Test-F1 : 38.40, 
Val_Geo_Mean : 50.54 , test_geo: 51.40

******************** GRUD_GRU *************************************
--- EPOCH: 21 --------------------------------- B-F1: 37.00 from EPOCH: 19,   Test-F1 : 38.16
----- time spent for training  : 33.051023721694946 -----
 time for train set report : 0.0 
eval time for val set : 1.950972080230713 
epoch loss: 72.204, taining accuracy: 90.85, validation accuracy: 90.89, Val-F1-score: 37.55, Test-F1 : 39.16, 
Val_Geo_Mean : 51.43 , test_geo: 51.97
New Best F1 Score at epoch 20 : 37.55

******************** GRUD_GRU *************************************
--- EPOCH: 22 --------------------------------- B-F1: 37.55 from EPOCH: 21,   Test-F1 : 39.16
----- time spent for training  : 32.85250949859619 -----
 time for train set report : 0.0 
eval time for val set : 1.9361717700958252 
epoch loss: 72.395, taining accuracy: 90.88, validation accuracy: 90.92, Val-F1-score: 37.36, Test-F1 : 39.33, 
Val_Geo_Mean : 51.15 , test_geo: 52.23

******************** GRUD_GRU *************************************
--- EPOCH: 23 --------------------------------- B-F1: 37.55 from EPOCH: 21,   Test-F1 : 39.16
----- time spent for training  : 33.9874746799469 -----
 time for train set report : 0.0 
eval time for val set : 1.9501848220825195 
epoch loss: 71.609, taining accuracy: 90.84, validation accuracy: 90.85, Val-F1-score: 36.92, Test-F1 : 39.08, 
Val_Geo_Mean : 50.84 , test_geo: 51.96

******************** GRUD_GRU *************************************
--- EPOCH: 24 --------------------------------- B-F1: 37.55 from EPOCH: 21,   Test-F1 : 39.16
----- time spent for training  : 33.67694902420044 -----
 time for train set report : 0.0 
eval time for val set : 1.9606056213378906 
epoch loss: 71.535, taining accuracy: 90.92, validation accuracy: 90.85, Val-F1-score: 36.92, Test-F1 : 38.57, 
Val_Geo_Mean : 50.84 , test_geo: 51.66

******************** GRUD_GRU *************************************
--- EPOCH: 25 --------------------------------- B-F1: 37.55 from EPOCH: 21,   Test-F1 : 39.16
----- time spent for training  : 34.03370666503906 -----
 time for train set report : 0.0 
eval time for val set : 1.9631733894348145 
epoch loss: 71.070, taining accuracy: 90.95, validation accuracy: 90.92, Val-F1-score: 37.09, Test-F1 : 38.66, 
Val_Geo_Mean : 50.86 , test_geo: 51.67

******************** GRUD_GRU *************************************
--- EPOCH: 26 --------------------------------- B-F1: 37.55 from EPOCH: 21,   Test-F1 : 39.16
----- time spent for training  : 33.547884941101074 -----
 time for train set report : 0.0 
eval time for val set : 1.9604501724243164 
epoch loss: 70.816, taining accuracy: 90.99, validation accuracy: 91.01, Val-F1-score: 37.89, Test-F1 : 38.83, 
Val_Geo_Mean : 51.47 , test_geo: 51.94
New Best F1 Score at epoch 25 : 37.89

******************** GRUD_GRU *************************************
--- EPOCH: 27 --------------------------------- B-F1: 37.89 from EPOCH: 26,   Test-F1 : 38.83
----- time spent for training  : 33.86545491218567 -----
 time for train set report : 0.0 
eval time for val set : 1.9854166507720947 
epoch loss: 70.672, taining accuracy: 91.00, validation accuracy: 91.01, Val-F1-score: 37.89, Test-F1 : 38.82, 
Val_Geo_Mean : 51.47 , test_geo: 51.69

******************** GRUD_GRU *************************************
--- EPOCH: 28 --------------------------------- B-F1: 37.89 from EPOCH: 26,   Test-F1 : 38.83
----- time spent for training  : 33.22528123855591 -----
 time for train set report : 0.0 
eval time for val set : 1.9484868049621582 
epoch loss: 70.483, taining accuracy: 91.04, validation accuracy: 91.05, Val-F1-score: 38.24, Test-F1 : 38.40, 
Val_Geo_Mean : 51.77 , test_geo: 51.40
New Best F1 Score at epoch 27 : 38.24

******************** GRUD_GRU *************************************
--- EPOCH: 29 --------------------------------- B-F1: 38.24 from EPOCH: 28,   Test-F1 : 38.40
----- time spent for training  : 33.72384023666382 -----
 time for train set report : 0.0 
eval time for val set : 1.9621875286102295 
epoch loss: 70.237, taining accuracy: 91.05, validation accuracy: 91.05, Val-F1-score: 38.24, Test-F1 : 38.82, 
Val_Geo_Mean : 51.77 , test_geo: 51.69

******************** GRUD_GRU *************************************
--- EPOCH: 30 --------------------------------- B-F1: 38.24 from EPOCH: 28,   Test-F1 : 38.40
----- time spent for training  : 33.24756836891174 -----
 time for train set report : 0.0 
eval time for val set : 1.9237759113311768 
epoch loss: 70.038, taining accuracy: 91.06, validation accuracy: 91.01, Val-F1-score: 38.16, Test-F1 : 38.24, 
Val_Geo_Mean : 51.76 , test_geo: 51.38

******************** GRUD_GRU *************************************
--- EPOCH: 31 --------------------------------- B-F1: 38.24 from EPOCH: 28,   Test-F1 : 38.40
----- time spent for training  : 33.67595314979553 -----
 time for train set report : 0.0 
eval time for val set : 1.958545446395874 
epoch loss: 69.843, taining accuracy: 91.06, validation accuracy: 91.08, Val-F1-score: 38.86, Test-F1 : 38.32, 
Val_Geo_Mean : 52.35 , test_geo: 51.39
New Best F1 Score at epoch 30 : 38.86

******************** GRUD_GRU *************************************
--- EPOCH: 32 --------------------------------- B-F1: 38.86 from EPOCH: 31,   Test-F1 : 38.32
----- time spent for training  : 33.12877893447876 -----
 time for train set report : 0.0 
eval time for val set : 1.948779582977295 
epoch loss: 69.637, taining accuracy: 91.08, validation accuracy: 91.05, Val-F1-score: 38.51, Test-F1 : 38.16, 
Val_Geo_Mean : 52.05 , test_geo: 51.37

******************** GRUD_GRU *************************************
--- EPOCH: 33 --------------------------------- B-F1: 38.86 from EPOCH: 31,   Test-F1 : 38.32
----- time spent for training  : 32.29070067405701 -----
 time for train set report : 0.0 
eval time for val set : 1.9845495223999023 
epoch loss: 69.474, taining accuracy: 91.08, validation accuracy: 91.08, Val-F1-score: 38.86, Test-F1 : 38.24, 
Val_Geo_Mean : 52.35 , test_geo: 51.38

******************** GRUD_GRU *************************************
--- EPOCH: 34 --------------------------------- B-F1: 38.86 from EPOCH: 31,   Test-F1 : 38.32
----- time spent for training  : 33.45528030395508 -----
 time for train set report : 0.0 
eval time for val set : 1.9561078548431396 
epoch loss: 69.242, taining accuracy: 91.12, validation accuracy: 91.11, Val-F1-score: 38.95, Test-F1 : 38.57, 
Val_Geo_Mean : 52.36 , test_geo: 51.66
New Best F1 Score at epoch 33 : 38.95

******************** GRUD_GRU *************************************
--- EPOCH: 35 --------------------------------- B-F1: 38.95 from EPOCH: 34,   Test-F1 : 38.57
----- time spent for training  : 33.15139126777649 -----
 time for train set report : 0.0 
eval time for val set : 1.9263274669647217 
epoch loss: 69.139, taining accuracy: 91.12, validation accuracy: 91.17, Val-F1-score: 39.91, Test-F1 : 37.84, 
Val_Geo_Mean : 53.22 , test_geo: 51.34
New Best F1 Score at epoch 34 : 39.91

******************** GRUD_GRU *************************************
--- EPOCH: 36 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.54871153831482 -----
 time for train set report : 0.0 
eval time for val set : 1.922633171081543 
epoch loss: 69.073, taining accuracy: 91.11, validation accuracy: 91.14, Val-F1-score: 39.04, Test-F1 : 37.82, 
Val_Geo_Mean : 52.37 , test_geo: 51.09

******************** GRUD_GRU *************************************
--- EPOCH: 37 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 34.40494751930237 -----
 time for train set report : 0.0 
eval time for val set : 1.9655225276947021 
epoch loss: 68.824, taining accuracy: 91.15, validation accuracy: 91.11, Val-F1-score: 39.22, Test-F1 : 38.25, 
Val_Geo_Mean : 52.64 , test_geo: 51.63

******************** GRUD_GRU *************************************
--- EPOCH: 38 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 32.75272870063782 -----
 time for train set report : 0.0 
eval time for val set : 1.9477620124816895 
epoch loss: 68.632, taining accuracy: 91.13, validation accuracy: 91.11, Val-F1-score: 39.22, Test-F1 : 38.49, 
Val_Geo_Mean : 52.64 , test_geo: 51.66

******************** GRUD_GRU *************************************
--- EPOCH: 39 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 32.7497444152832 -----
 time for train set report : 0.0 
eval time for val set : 1.9804120063781738 
epoch loss: 68.465, taining accuracy: 91.15, validation accuracy: 91.14, Val-F1-score: 39.57, Test-F1 : 38.25, 
Val_Geo_Mean : 52.93 , test_geo: 51.63

******************** GRUD_GRU *************************************
--- EPOCH: 40 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 32.20593619346619 -----
 time for train set report : 0.0 
eval time for val set : 1.9364428520202637 
epoch loss: 68.276, taining accuracy: 91.19, validation accuracy: 91.14, Val-F1-score: 39.30, Test-F1 : 38.33, 
Val_Geo_Mean : 52.65 , test_geo: 51.64

******************** GRUD_GRU *************************************
--- EPOCH: 41 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.20831656455994 -----
 time for train set report : 0.0 
eval time for val set : 1.9427905082702637 
epoch loss: 68.868, taining accuracy: 91.19, validation accuracy: 91.08, Val-F1-score: 39.13, Test-F1 : 38.08, 
Val_Geo_Mean : 52.63 , test_geo: 51.36

******************** GRUD_GRU *************************************
--- EPOCH: 42 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.71510696411133 -----
 time for train set report : 0.0 
eval time for val set : 1.9776208400726318 
epoch loss: 68.760, taining accuracy: 91.19, validation accuracy: 91.11, Val-F1-score: 38.95, Test-F1 : 38.41, 
Val_Geo_Mean : 52.36 , test_geo: 51.65

******************** GRUD_GRU *************************************
--- EPOCH: 43 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.10938596725464 -----
 time for train set report : 0.0 
eval time for val set : 1.9595181941986084 
epoch loss: 68.008, taining accuracy: 91.20, validation accuracy: 91.11, Val-F1-score: 38.95, Test-F1 : 38.82, 
Val_Geo_Mean : 52.36 , test_geo: 51.69

******************** GRUD_GRU *************************************
--- EPOCH: 44 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.634684562683105 -----
 time for train set report : 0.0 
eval time for val set : 1.9520437717437744 
epoch loss: 67.701, taining accuracy: 91.23, validation accuracy: 91.01, Val-F1-score: 38.70, Test-F1 : 39.26, 
Val_Geo_Mean : 52.33 , test_geo: 52.46

******************** GRUD_GRU *************************************
--- EPOCH: 45 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.38578677177429 -----
 time for train set report : 0.0 
eval time for val set : 1.955725908279419 
epoch loss: 67.688, taining accuracy: 91.26, validation accuracy: 91.01, Val-F1-score: 39.22, Test-F1 : 39.59, 
Val_Geo_Mean : 52.90 , test_geo: 52.74

******************** GRUD_GRU *************************************
--- EPOCH: 46 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.506616830825806 -----
 time for train set report : 0.0 
eval time for val set : 1.9457907676696777 
epoch loss: 67.513, taining accuracy: 91.25, validation accuracy: 91.01, Val-F1-score: 38.96, Test-F1 : 38.92, 
Val_Geo_Mean : 52.61 , test_geo: 52.19

******************** GRUD_GRU *************************************
--- EPOCH: 47 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.71643424034119 -----
 time for train set report : 0.0 
eval time for val set : 1.9561898708343506 
epoch loss: 67.421, taining accuracy: 91.27, validation accuracy: 91.01, Val-F1-score: 39.22, Test-F1 : 39.34, 
Val_Geo_Mean : 52.90 , test_geo: 52.47

******************** GRUD_GRU *************************************
--- EPOCH: 48 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 31.857781410217285 -----
 time for train set report : 0.0 
eval time for val set : 1.9656124114990234 
epoch loss: 67.469, taining accuracy: 91.31, validation accuracy: 91.01, Val-F1-score: 38.70, Test-F1 : 39.17, 
Val_Geo_Mean : 52.33 , test_geo: 52.21

******************** GRUD_GRU *************************************
--- EPOCH: 49 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.71986675262451 -----
 time for train set report : 0.0 
eval time for val set : 1.9625940322875977 
epoch loss: 67.071, taining accuracy: 91.34, validation accuracy: 91.08, Val-F1-score: 39.66, Test-F1 : 38.75, 
Val_Geo_Mean : 53.20 , test_geo: 51.93

******************** GRUD_GRU *************************************
--- EPOCH: 50 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.62253212928772 -----
 time for train set report : 0.0 
eval time for val set : 1.9549782276153564 
epoch loss: 66.939, taining accuracy: 91.31, validation accuracy: 91.08, Val-F1-score: 39.66, Test-F1 : 39.17, 
Val_Geo_Mean : 53.20 , test_geo: 52.21

******************** GRUD_GRU *************************************
--- EPOCH: 51 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.910351514816284 -----
 time for train set report : 0.0 
eval time for val set : 1.9622585773468018 
epoch loss: 66.884, taining accuracy: 91.32, validation accuracy: 91.05, Val-F1-score: 39.83, Test-F1 : 39.83, 
Val_Geo_Mean : 53.46 , test_geo: 52.77

******************** GRUD_GRU *************************************
--- EPOCH: 52 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.21905565261841 -----
 time for train set report : 0.0 
eval time for val set : 1.9725399017333984 
epoch loss: 66.783, taining accuracy: 91.36, validation accuracy: 91.11, Val-F1-score: 39.74, Test-F1 : 39.41, 
Val_Geo_Mean : 53.21 , test_geo: 52.24

******************** GRUD_GRU *************************************
--- EPOCH: 53 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 33.414854764938354 -----
 time for train set report : 0.0 
eval time for val set : 1.9619696140289307 
epoch loss: 66.624, taining accuracy: 91.38, validation accuracy: 91.01, Val-F1-score: 38.96, Test-F1 : 39.67, 
Val_Geo_Mean : 52.61 , test_geo: 52.51

******************** GRUD_GRU *************************************
--- EPOCH: 54 --------------------------------- B-F1: 39.91 from EPOCH: 35,   Test-F1 : 37.84
----- time spent for training  : 32.847480058670044 -----
 time for train set report : 0.0 
eval time for val set : 1.9320182800292969 
epoch loss: 66.617, taining accuracy: 91.38, validation accuracy: 91.17, Val-F1-score: 40.69, Test-F1 : 39.83, 
Val_Geo_Mean : 54.06 , test_geo: 52.77
New Best F1 Score at epoch 53 : 40.69

******************** GRUD_GRU *************************************
--- EPOCH: 55 --------------------------------- B-F1: 40.69 from EPOCH: 54,   Test-F1 : 39.83
----- time spent for training  : 33.909472942352295 -----
 time for train set report : 0.0 
eval time for val set : 1.98305082321167 
epoch loss: 66.455, taining accuracy: 91.41, validation accuracy: 91.14, Val-F1-score: 40.34, Test-F1 : 40.08, 
Val_Geo_Mean : 53.77 , test_geo: 52.80

******************** GRUD_GRU *************************************
--- EPOCH: 56 --------------------------------- B-F1: 40.69 from EPOCH: 54,   Test-F1 : 39.83
----- time spent for training  : 33.480445861816406 -----
 time for train set report : 0.0 
eval time for val set : 1.9352123737335205 
epoch loss: 66.223, taining accuracy: 91.45, validation accuracy: 91.11, Val-F1-score: 40.26, Test-F1 : 39.83, 
Val_Geo_Mean : 53.76 , test_geo: 52.77

******************** GRUD_GRU *************************************
--- EPOCH: 57 --------------------------------- B-F1: 40.69 from EPOCH: 54,   Test-F1 : 39.83
----- time spent for training  : 24282.12725019455 -----
 time for train set report : 0.0 
eval time for val set : 1.9808704853057861 
epoch loss: 66.026, taining accuracy: 91.47, validation accuracy: 91.14, Val-F1-score: 40.60, Test-F1 : 41.07, 
Val_Geo_Mean : 54.05 , test_geo: 53.84

******************** GRUD_GRU *************************************
--- EPOCH: 58 --------------------------------- B-F1: 40.69 from EPOCH: 54,   Test-F1 : 39.83
----- time spent for training  : 30.352240085601807 -----
 time for train set report : 0.0 
eval time for val set : 2.0135087966918945 
epoch loss: 65.992, taining accuracy: 91.49, validation accuracy: 91.17, Val-F1-score: 40.69, Test-F1 : 41.48, 
Val_Geo_Mean : 54.06 , test_geo: 54.12

******************** GRUD_GRU *************************************
--- EPOCH: 59 --------------------------------- B-F1: 40.69 from EPOCH: 54,   Test-F1 : 39.83
----- time spent for training  : 31.963988542556763 -----
 time for train set report : 0.0 
eval time for val set : 1.9572675228118896 
epoch loss: 65.907, taining accuracy: 91.51, validation accuracy: 91.17, Val-F1-score: 40.43, Test-F1 : 40.58, 
Val_Geo_Mean : 53.78 , test_geo: 53.32

******************** GRUD_GRU *************************************
--- EPOCH: 60 --------------------------------- B-F1: 40.69 from EPOCH: 54,   Test-F1 : 39.83
----- time spent for training  : 33.03675866127014 -----
 time for train set report : 0.0 
eval time for val set : 1.9470925331115723 
epoch loss: 65.872, taining accuracy: 91.50, validation accuracy: 91.14, Val-F1-score: 40.85, Test-F1 : 41.48, 
Val_Geo_Mean : 54.32 , test_geo: 54.12
New Best F1 Score at epoch 59 : 40.85

******************** GRUD_GRU *************************************
--- EPOCH: 61 --------------------------------- B-F1: 40.85 from EPOCH: 60,   Test-F1 : 41.48
----- time spent for training  : 32.37075161933899 -----
 time for train set report : 0.0 
eval time for val set : 1.9805629253387451 
epoch loss: 65.634, taining accuracy: 91.53, validation accuracy: 91.20, Val-F1-score: 40.77, Test-F1 : 41.32, 
Val_Geo_Mean : 54.07 , test_geo: 53.87

******************** GRUD_GRU *************************************
--- EPOCH: 62 --------------------------------- B-F1: 40.85 from EPOCH: 60,   Test-F1 : 41.48
----- time spent for training  : 32.61669731140137 -----
 time for train set report : 0.0 
eval time for val set : 1.9672741889953613 
epoch loss: 65.521, taining accuracy: 91.56, validation accuracy: 91.20, Val-F1-score: 40.52, Test-F1 : 40.99, 
Val_Geo_Mean : 53.79 , test_geo: 53.60

******************** GRUD_GRU *************************************
--- EPOCH: 63 --------------------------------- B-F1: 40.85 from EPOCH: 60,   Test-F1 : 41.48
----- time spent for training  : 32.113160848617554 -----
 time for train set report : 0.0 
eval time for val set : 1.9613711833953857 
epoch loss: 65.554, taining accuracy: 91.49, validation accuracy: 91.11, Val-F1-score: 41.26, Test-F1 : 41.96, 
Val_Geo_Mean : 54.85 , test_geo: 54.64
New Best F1 Score at epoch 62 : 41.26

******************** GRUD_GRU *************************************
--- EPOCH: 64 --------------------------------- B-F1: 41.26 from EPOCH: 63,   Test-F1 : 41.96
----- time spent for training  : 32.55617165565491 -----
 time for train set report : 0.0 
eval time for val set : 2.280636787414551 
epoch loss: 65.343, taining accuracy: 91.55, validation accuracy: 91.11, Val-F1-score: 41.26, Test-F1 : 42.45, 
Val_Geo_Mean : 54.85 , test_geo: 54.92

******************** GRUD_GRU *************************************
--- EPOCH: 65 --------------------------------- B-F1: 41.26 from EPOCH: 63,   Test-F1 : 41.96
----- time spent for training  : 31.055310010910034 -----
 time for train set report : 0.0 
eval time for val set : 1.9846651554107666 
epoch loss: 65.253, taining accuracy: 91.56, validation accuracy: 91.14, Val-F1-score: 41.10, Test-F1 : 41.56, 
Val_Geo_Mean : 54.59 , test_geo: 54.13

******************** GRUD_GRU *************************************
--- EPOCH: 66 --------------------------------- B-F1: 41.26 from EPOCH: 63,   Test-F1 : 41.96
----- time spent for training  : 32.19602584838867 -----
 time for train set report : 0.0 
eval time for val set : 1.971480131149292 
epoch loss: 65.008, taining accuracy: 91.56, validation accuracy: 91.14, Val-F1-score: 41.10, Test-F1 : 41.56, 
Val_Geo_Mean : 54.59 , test_geo: 54.13

******************** GRUD_GRU *************************************
--- EPOCH: 67 --------------------------------- B-F1: 41.26 from EPOCH: 63,   Test-F1 : 41.96
----- time spent for training  : 28.17560601234436 -----
 time for train set report : 0.0 
eval time for val set : 2.0207643508911133 
epoch loss: 64.956, taining accuracy: 91.59, validation accuracy: 91.14, Val-F1-score: 41.60, Test-F1 : 41.80, 
Val_Geo_Mean : 55.13 , test_geo: 54.39
New Best F1 Score at epoch 66 : 41.60

******************** GRUD_GRU *************************************
--- EPOCH: 68 --------------------------------- B-F1: 41.60 from EPOCH: 67,   Test-F1 : 41.80
----- time spent for training  : 30.932278156280518 -----
 time for train set report : 0.0 
eval time for val set : 2.000704050064087 
epoch loss: 65.018, taining accuracy: 91.63, validation accuracy: 91.08, Val-F1-score: 41.18, Test-F1 : 42.13, 
Val_Geo_Mean : 54.84 , test_geo: 54.66

******************** GRUD_GRU *************************************
--- EPOCH: 69 --------------------------------- B-F1: 41.60 from EPOCH: 67,   Test-F1 : 41.80
----- time spent for training  : 28.333407402038574 -----
 time for train set report : 0.0 
eval time for val set : 1.955735206604004 
epoch loss: 64.761, taining accuracy: 91.66, validation accuracy: 91.11, Val-F1-score: 41.51, Test-F1 : 42.04, 
Val_Geo_Mean : 55.12 , test_geo: 54.65

******************** GRUD_GRU *************************************
--- EPOCH: 70 --------------------------------- B-F1: 41.60 from EPOCH: 67,   Test-F1 : 41.80
----- time spent for training  : 28.614160299301147 -----
 time for train set report : 0.0 
eval time for val set : 1.9925754070281982 
epoch loss: 64.533, taining accuracy: 91.74, validation accuracy: 91.17, Val-F1-score: 41.44, Test-F1 : 42.45, 
Val_Geo_Mean : 54.87 , test_geo: 54.92

******************** GRUD_GRU *************************************
--- EPOCH: 71 --------------------------------- B-F1: 41.60 from EPOCH: 67,   Test-F1 : 41.80
----- time spent for training  : 29.312339782714844 -----
 time for train set report : 0.0 
eval time for val set : 2.0105204582214355 
epoch loss: 64.580, taining accuracy: 91.72, validation accuracy: 91.27, Val-F1-score: 41.20, Test-F1 : 42.30, 
Val_Geo_Mean : 54.36 , test_geo: 54.68

******************** GRUD_GRU *************************************
--- EPOCH: 72 --------------------------------- B-F1: 41.60 from EPOCH: 67,   Test-F1 : 41.80
----- time spent for training  : 33.043837785720825 -----
 time for train set report : 0.0 
eval time for val set : 2.004016876220703 
epoch loss: 64.637, taining accuracy: 91.69, validation accuracy: 91.17, Val-F1-score: 41.68, Test-F1 : 43.00, 
Val_Geo_Mean : 55.14 , test_geo: 55.44
New Best F1 Score at epoch 71 : 41.68

******************** GRUD_GRU *************************************
--- EPOCH: 73 --------------------------------- B-F1: 41.68 from EPOCH: 72,   Test-F1 : 43.00
----- time spent for training  : 34.369885206222534 -----
 time for train set report : 0.0 
eval time for val set : 1.940277338027954 
epoch loss: 64.469, taining accuracy: 91.72, validation accuracy: 91.14, Val-F1-score: 41.60, Test-F1 : 42.60, 
Val_Geo_Mean : 55.13 , test_geo: 55.16

******************** GRUD_GRU *************************************
--- EPOCH: 74 --------------------------------- B-F1: 41.68 from EPOCH: 72,   Test-F1 : 43.00
----- time spent for training  : 33.97183299064636 -----
 time for train set report : 0.0 
eval time for val set : 1.9572334289550781 
epoch loss: 64.423, taining accuracy: 91.69, validation accuracy: 91.05, Val-F1-score: 41.58, Test-F1 : 42.91, 
Val_Geo_Mean : 55.37 , test_geo: 55.43

******************** GRUD_GRU *************************************
--- EPOCH: 75 --------------------------------- B-F1: 41.68 from EPOCH: 72,   Test-F1 : 43.00
----- time spent for training  : 28.513527154922485 -----
 time for train set report : 0.0 
eval time for val set : 1.963343858718872 
epoch loss: 64.040, taining accuracy: 91.75, validation accuracy: 91.14, Val-F1-score: 41.10, Test-F1 : 43.00, 
Val_Geo_Mean : 54.59 , test_geo: 55.44

******************** GRUD_GRU *************************************
--- EPOCH: 76 --------------------------------- B-F1: 41.68 from EPOCH: 72,   Test-F1 : 43.00
----- time spent for training  : 31.494781017303467 -----
 time for train set report : 0.0 
eval time for val set : 2.025921583175659 
epoch loss: 64.222, taining accuracy: 91.74, validation accuracy: 91.08, Val-F1-score: 41.67, Test-F1 : 42.74, 
Val_Geo_Mean : 55.38 , test_geo: 55.41

******************** GRUD_GRU *************************************
--- EPOCH: 77 --------------------------------- B-F1: 41.68 from EPOCH: 72,   Test-F1 : 43.00
----- time spent for training  : 29.061949491500854 -----
 time for train set report : 0.0 
eval time for val set : 1.9325339794158936 
epoch loss: 63.874, taining accuracy: 91.79, validation accuracy: 91.05, Val-F1-score: 41.34, Test-F1 : 43.15, 
Val_Geo_Mean : 55.10 , test_geo: 55.68

******************** GRUD_GRU *************************************
--- EPOCH: 78 --------------------------------- B-F1: 41.68 from EPOCH: 72,   Test-F1 : 43.00
----- time spent for training  : 27.72372794151306 -----
 time for train set report : 0.0 
eval time for val set : 2.0576229095458984 
epoch loss: 63.861, taining accuracy: 91.75, validation accuracy: 91.17, Val-F1-score: 41.93, Test-F1 : 42.86, 
Val_Geo_Mean : 55.41 , test_geo: 55.19
New Best F1 Score at epoch 77 : 41.93

******************** GRUD_GRU *************************************
--- EPOCH: 79 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 27.442991733551025 -----
 time for train set report : 0.0 
eval time for val set : 1.9710822105407715 
epoch loss: 63.686, taining accuracy: 91.78, validation accuracy: 91.11, Val-F1-score: 40.76, Test-F1 : 42.94, 
Val_Geo_Mean : 54.31 , test_geo: 55.20

******************** GRUD_GRU *************************************
--- EPOCH: 80 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 27.78920817375183 -----
 time for train set report : 0.0 
eval time for val set : 2.003972291946411 
epoch loss: 63.767, taining accuracy: 91.83, validation accuracy: 91.11, Val-F1-score: 40.76, Test-F1 : 42.94, 
Val_Geo_Mean : 54.31 , test_geo: 55.20

******************** GRUD_GRU *************************************
--- EPOCH: 81 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 28.099323511123657 -----
 time for train set report : 0.0 
eval time for val set : 1.968916416168213 
epoch loss: 63.563, taining accuracy: 91.81, validation accuracy: 91.14, Val-F1-score: 40.85, Test-F1 : 43.41, 
Val_Geo_Mean : 54.32 , test_geo: 55.71

******************** GRUD_GRU *************************************
--- EPOCH: 82 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 28.193326234817505 -----
 time for train set report : 0.0 
eval time for val set : 2.013026714324951 
epoch loss: 63.458, taining accuracy: 91.81, validation accuracy: 91.24, Val-F1-score: 41.36, Test-F1 : 43.35, 
Val_Geo_Mean : 54.62 , test_geo: 55.48

******************** GRUD_GRU *************************************
--- EPOCH: 83 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 28.21119999885559 -----
 time for train set report : 0.0 
eval time for val set : 1.9717788696289062 
epoch loss: 63.349, taining accuracy: 91.85, validation accuracy: 91.14, Val-F1-score: 41.60, Test-F1 : 44.04, 
Val_Geo_Mean : 55.13 , test_geo: 56.23

******************** GRUD_GRU *************************************
--- EPOCH: 84 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 30.627646446228027 -----
 time for train set report : 0.0 
eval time for val set : 1.9396371841430664 
epoch loss: 63.295, taining accuracy: 91.83, validation accuracy: 91.11, Val-F1-score: 40.76, Test-F1 : 43.58, 
Val_Geo_Mean : 54.31 , test_geo: 55.73

******************** GRUD_GRU *************************************
--- EPOCH: 85 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 30.190574884414673 -----
 time for train set report : 0.0 
eval time for val set : 1.9261517524719238 
epoch loss: 63.127, taining accuracy: 91.86, validation accuracy: 91.24, Val-F1-score: 41.61, Test-F1 : 43.58, 
Val_Geo_Mean : 54.89 , test_geo: 55.73

******************** GRUD_GRU *************************************
--- EPOCH: 86 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 28.821544647216797 -----
 time for train set report : 0.0 
eval time for val set : 1.9885640144348145 
epoch loss: 63.039, taining accuracy: 91.90, validation accuracy: 91.24, Val-F1-score: 41.86, Test-F1 : 43.81, 
Val_Geo_Mean : 55.16 , test_geo: 55.98

******************** GRUD_GRU *************************************
--- EPOCH: 87 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 30.957306623458862 -----
 time for train set report : 0.0 
eval time for val set : 1.974602222442627 
epoch loss: 62.732, taining accuracy: 91.94, validation accuracy: 91.20, Val-F1-score: 41.53, Test-F1 : 43.90, 
Val_Geo_Mean : 54.88 , test_geo: 55.99

******************** GRUD_GRU *************************************
--- EPOCH: 88 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 32.08874464035034 -----
 time for train set report : 0.0 
eval time for val set : 1.9783966541290283 
epoch loss: 62.837, taining accuracy: 91.92, validation accuracy: 91.14, Val-F1-score: 41.60, Test-F1 : 43.72, 
Val_Geo_Mean : 55.13 , test_geo: 55.97

******************** GRUD_GRU *************************************
--- EPOCH: 89 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 33.02548813819885 -----
 time for train set report : 0.0 
eval time for val set : 1.961958408355713 
epoch loss: 62.959, taining accuracy: 91.92, validation accuracy: 91.17, Val-F1-score: 41.68, Test-F1 : 44.35, 
Val_Geo_Mean : 55.14 , test_geo: 56.48

******************** GRUD_GRU *************************************
--- EPOCH: 90 --------------------------------- B-F1: 41.93 from EPOCH: 78,   Test-F1 : 42.86
----- time spent for training  : 32.02125406265259 -----
 time for train set report : 0.0 
eval time for val set : 1.9530634880065918 
epoch loss: 62.582, taining accuracy: 92.02, validation accuracy: 91.14, Val-F1-score: 42.08, Test-F1 : 44.09, 
Val_Geo_Mean : 55.67 , test_geo: 56.45
New Best F1 Score at epoch 89 : 42.08

******************** GRUD_GRU *************************************
--- EPOCH: 91 --------------------------------- B-F1: 42.08 from EPOCH: 90,   Test-F1 : 44.09
----- time spent for training  : 30.812450647354126 -----
 time for train set report : 0.0 
eval time for val set : 1.9813079833984375 
epoch loss: 62.429, taining accuracy: 92.01, validation accuracy: 91.20, Val-F1-score: 41.53, Test-F1 : 44.08, 
Val_Geo_Mean : 54.88 , test_geo: 56.01

******************** GRUD_GRU *************************************
--- EPOCH: 92 --------------------------------- B-F1: 42.08 from EPOCH: 90,   Test-F1 : 44.09
----- time spent for training  : 32.336557149887085 -----
 time for train set report : 0.0 
eval time for val set : 1.9537773132324219 
epoch loss: 62.676, taining accuracy: 91.95, validation accuracy: 91.17, Val-F1-score: 41.93, Test-F1 : 44.31, 
Val_Geo_Mean : 55.41 , test_geo: 56.70

******************** GRUD_GRU *************************************
--- EPOCH: 93 --------------------------------- B-F1: 42.08 from EPOCH: 90,   Test-F1 : 44.09
----- time spent for training  : 31.699553728103638 -----
 time for train set report : 0.0 
eval time for val set : 1.9863841533660889 
epoch loss: 62.542, taining accuracy: 92.01, validation accuracy: 91.17, Val-F1-score: 41.68, Test-F1 : 44.27, 
Val_Geo_Mean : 55.14 , test_geo: 56.47

******************** GRUD_GRU *************************************
--- EPOCH: 94 --------------------------------- B-F1: 42.08 from EPOCH: 90,   Test-F1 : 44.09
----- time spent for training  : 31.967771768569946 -----
 time for train set report : 0.0 
eval time for val set : 1.9855828285217285 
epoch loss: 62.454, taining accuracy: 91.98, validation accuracy: 91.14, Val-F1-score: 41.60, Test-F1 : 44.14, 
Val_Geo_Mean : 55.13 , test_geo: 56.68

******************** GRUD_GRU *************************************
--- EPOCH: 95 --------------------------------- B-F1: 42.08 from EPOCH: 90,   Test-F1 : 44.09
----- time spent for training  : 32.608827352523804 -----
 time for train set report : 0.0 
eval time for val set : 1.9850611686706543 
epoch loss: 61.915, taining accuracy: 92.00, validation accuracy: 91.17, Val-F1-score: 41.68, Test-F1 : 44.85, 
Val_Geo_Mean : 55.14 , test_geo: 56.76

******************** GRUD_GRU *************************************
--- EPOCH: 96 --------------------------------- B-F1: 42.08 from EPOCH: 90,   Test-F1 : 44.09
 Model is  GRUD
{'epochs': 100, 'batch_size': 48, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 6, 'lr': 8.652440502066458e-05, 'rnn_cell': 'GRU', 'input_key_size': 128, 'input_value_size': 64, 'input_query_size': 128, 'num_input_heads': 2, 'input_dropout': 0.2520170707392178, 'comm_key_size': 128, 'comm_value_size': 104, 'comm_query_size': 128, 'num_comm_heads': 2, 'comm_dropout': 0.13927962254653933, 'active_rims': 4, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
 Model is  GRUD
{'epochs': 100, 'batch_size': 32, 'input_size': 104, 'model_type': 'GRUD', 'hidden_size': 104, 'num_rims': 5, 'lr': 0.0008455472683899129, 'rnn_cell': 'GRU', 'input_key_size': 128, 'input_value_size': 128, 'input_query_size': 128, 'num_input_heads': 2, 'input_dropout': 0.3655253377822759, 'comm_key_size': 128, 'comm_value_size': 104, 'comm_query_size': 128, 'num_comm_heads': 2, 'comm_dropout': 0.11874003296527812, 'active_rims': 3, 'mask': True, 'mask_size': 104, 'delta_size': 104, 'static_features': 17, 'need_data_preprocessing': False, 'raw_data_file_path': 'data/10_percent/all_hourly_data.pkl', 'processed_data_path': 'data/50_percent/', 'input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'decay_input_file_path': 'data/mimic_iii/test_dump/decay_data_20926.npz', 'max_no_improvement': 25, 'improvement_threshold': 0.0001, 'is_tuning': True, 'balance': False, 'is_cbloss': False, 'cb_beta': 0.1}
Model Arch: 
 MIMICGRUDModel(
  (grud): GRUD(
    (gamma_x_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gamma_h_l): CustomLinear(in_features=104, out_features=104, bias=True)
    (gru_cell): CustomGRUCell()
  )
  (linear): Linear(in_features=121, out_features=1, bias=True)
  (loss): BCELoss()
)
Training, Validating, and Testing: GRUD model with GRU cell 

******************** GRUD_GRU *************************************
--- EPOCH: 1 --------------------------------- B-F1: 0.00 from EPOCH: 1,   Test-F1 : 0.00
